(this.webpackJsonpcustom_filter=this.webpackJsonpcustom_filter||[]).push([[11],{682:function(e,t,o){"use strict";o.d(t,"a",(function(){return f}));var r,n=o(10),c=o(3),a=(o(710),o(713),o(714),o(715),o(716),o(718),"en-US"),i=function(e){var t=l(e);return{prefix:"".concat(t.operation," $"),value:Intl.NumberFormat(a,{maximumFractionDigits:2,minimumFractionDigits:2,notation:"compact",compactDisplay:"short"}).format(t.value)}},u=function(e){var t=l(e);return t.operation+Intl.NumberFormat(a,{maximumFractionDigits:1,minimumFractionDigits:0,notation:"compact",compactDisplay:"short"}).format(t.value)},l=function(e){if(!isNaN(e))return{value:e,operation:""};try{var t,o=new RegExp(/([<>]=?)[^$]?(\d+)/gm).exec(e);return o&&(t=o[1],e=Number(o[2])),isNaN(e)?{value:0,operation:""}:{value:e,operation:t}}catch(r){throw new Error("You are using a numberFormatter on a not valid value: ".concat(e))}},s=Object.freeze({CURRENCY:"currency",NUMBER:"number"}),d=(r={},Object(c.a)(r,s.CURRENCY,(function(e){var t=i(e);return"".concat(t.prefix).concat(t.value)})),Object(c.a)(r,s.NUMBER,(function(e){return u(e)})),r),b={type:"",columns:[]};function f(e){var t=e.title,o=e.feature,r=e.formatter,c=void 0===r?b:r,a=e.includeColumns,i=void 0===a?"*":a,u=e.showColumnName,l=void 0===u||u;if(!o)throw new Error('htmlForFeature needs "info.object" information');var f=Object.keys(o.properties);if((null===c||void 0===c||!c.type||null===c||void 0===c||!c.columns||function(e,t){var o=Object.values(s);if(!o.includes(t.type))throw new Error('"'.concat(t.type,'" is not supported as formatter, use one of "').concat(o,'"'));if(!t.columns||0===t.columns.length)return!0;if(!m(t.columns))throw new Error('"formatter.columns" property needs to be an array of strings');var r,c=Object(n.a)(t.columns);try{for(c.s();!(r=c.n()).done;){var a=r.value;if(!e.includes(a)){var i=e.join(", ");throw new Error('"formatted.columns" includes \''.concat(a,"' but it was not found!. Available cols are [").concat(i,"]"))}}}catch(u){c.e(u)}finally{c.f()}return!0}(f,c))&&function(e,t){if("*"===t)return!0;if(!m(t))throw new Error('"includeColumns" property needs to be an array of existing feature columns or "*"');if(m(t)){var o,r=Object(n.a)(t);try{for(r.s();!(o=r.n()).done;){var c=o.value;if(!e.includes(c))throw new Error('colums set in "includeColumns" should exist in picked feature')}}catch(a){r.e(a)}finally{r.f()}}return!0}(f,i)){var j="";t&&(j='<h3 style="margin: 0"><strong>'.concat(t,"</strong></h3>"));for(var v=0,O=f;v<O.length;v++){var y=O[v];if("layerName"!==y&&(i.includes(y)||"*"===i))if(null!==c&&void 0!==c&&c.columns.includes(y))j=p(o,y,l,j,d[c.type]);else j=p(o,y,l,j)}return j}}function p(e,t,o,r){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return e};return r.concat("".concat(o?"<strong>".concat(t,"</strong>: "):"").concat(n(e.properties[t]),"<br/>"))}function m(e){return Array.isArray(e)&&e.length&&e.every(String)}},691:function(e,t,o){"use strict";o.d(t,"a",(function(){return l})),o.d(t,"b",(function(){return s}));var r=o(5),n=o(177),c=o(493),a=o(244),i=o(679),u=o(682),l="popAggLayer";function s(){var e=Object(n.useSelector)((function(e){return e.carto.layers})).popAggLayer,t=Object(n.useSelector)((function(t){return Object(a.selectSourceById)(t,null===e||void 0===e?void 0:e.source)})),o=Object(i.useCartoLayerProps)({source:t});if(e&&t)return new c.a(Object(r.a)(Object(r.a)({},o),{},{id:l,getFillColor:[241,109,122],pointRadiusMinPixels:2,getLineColor:[255,0,0],lineWidthMinPixels:1,pickable:!0,visible:!1,onHover:function(e){null!==e&&void 0!==e&&e.object&&(e.object={html:Object(u.a)({feature:e.object}),style:{}})}}))}},694:function(e,t,o){"use strict";o.d(t,"a",(function(){return s})),o.d(t,"b",(function(){return b}));var r=o(5),n=o(177),c=o(493),a=o(244),i=o(679),u=o(682),l=o(695),s="populationLayer",d={title:"Population",visible:!0,legend:{}};function b(){var e=Object(n.useSelector)((function(e){return e.carto.layers})).populationLayer,t=Object(n.useSelector)((function(t){return Object(a.selectSourceById)(t,null===e||void 0===e?void 0:e.source)})),o=Object(i.useCartoLayerProps)({source:t}),b=Object(n.useDispatch)();if(e&&t)return new c.a(Object(r.a)(Object(r.a)({},o),{},{id:s,getFillColor:[217,219,94],pointRadiusMinPixels:.8,getLineColor:[0,0,0],lineWidthMinPixels:1,pickable:!0,parameters:{blendFunc:[l.default.SRC_ALPHA,l.default.DST_ALPHA],blendEquation:l.default.FUNC_ADD},visible:e.visible,onDataLoad:function(e){b(Object(a.updateLayer)({id:s,layerAttributes:Object(r.a)({},d)})),o.onDataLoad(e)},onHover:function(e){null!==e&&void 0!==e&&e.object&&(e.object={html:Object(u.a)({feature:e.object}),style:{}})}}))}},696:function(e,t,o){"use strict";o.d(t,"a",(function(){return l})),o.d(t,"b",(function(){return d}));var r=o(5),n=o(177),c=o(493),a=o(244),i=o(679),u=o(682),l="countiesLayer",s={title:"Counties",visible:!0,legend:{}};function d(){var e=Object(n.useSelector)((function(e){return e.carto.layers})).countiesLayer,t=Object(n.useSelector)((function(t){return Object(a.selectSourceById)(t,null===e||void 0===e?void 0:e.source)})),o=Object(i.useCartoLayerProps)({source:t}),d=Object(n.useDispatch)();if(e&&t)return new c.a(Object(r.a)(Object(r.a)({},o),{},{id:l,getFillColor:[195,199,198,0],pointRadiusMinPixels:1,getLineColor:[195,199,198],lineWidthMinPixels:.3,pickable:!0,visible:e.visible,onDataLoad:function(e){d(Object(a.updateLayer)({id:l,layerAttributes:Object(r.a)({},s)})),o.onDataLoad(e)},onHover:function(e){null!==e&&void 0!==e&&e.object&&(e.object={html:Object(u.a)({feature:e.object}),style:{}})}}))}},733:function(e,t){},842:function(e,t,o){"use strict";o.r(t),o.d(t,"default",(function(){return w}));var r=o(0),n=o(29),c={id:"popAggSource",type:n.h.TILESET,connection:"tehren",data:"cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_agg_tileset"},a=o(691),i={id:"populationSource",type:n.h.TILESET,connection:"tehren",data:"cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_tileset"},u=o(694),l={id:"countiesSource",type:n.h.TABLE,connection:"tehren",data:"cartodb-gcp-solutions-eng-team.tomas_data.usa_counties"},s=o(696),d=o(177),b=o(244),f=o(497),p=o(646),m=o(305),j=o(5),v=o(12),O=o(19),y=o(376),g=o(685);var h=o(24),S=[];function C(e){var t=e.id,o=e.title,n=e.dataSource,c=e.column,a=e.operationColumn,i=e.operation,u=e.formatter,l=e.labels,s=e.animation,f=e.filterable,p=e.searchable,C=e.onError,L=e.wrapperProps,E=e.noDataAlertProps,w=e.otherSources,F=Object(d.useDispatch)(),N=Object(d.useSelector)((function(e){return[].concat(Object(O.a)(w.map((function(e){return e.id}))),[n]).map((function(t){return Object(b.selectAreFeaturesReadyForSource)(e,t)})).every((function(e){return!0===e}))})),x=Object(r.useState)([]),A=Object(v.a)(x,2),D=A[0],P=A[1],_=Object(r.useState)(!0),T=Object(v.a)(_,2),I=T[0],M=T[1],R=Object(g.useSourceFilters)({dataSource:n,id:t}),U=function(e){var t=e.dataSource,o=e.id,n=e.column,c=e.type,a=Object(d.useSelector)((function(e){return Object(b.selectSourceById)(e,t)||{}})).filters;return Object(r.useMemo)((function(){var e,t=null===a||void 0===a||null===(e=a[n])||void 0===e?void 0:e[c];return t&&t.owner===o?t.values:null}),[a,n,c,o])}({dataSource:n,id:t,column:c,type:m._FilterTypes.IN})||S;Object(r.useEffect)((function(){M(!0),N&&Object(g.getCategories)({column:c,operationColumn:a,operation:i,filters:R,dataSource:n}).then((function(e){e&&(M(!1),P(e))})).catch((function(e){M(!1),C&&C(e)}))}),[t,c,a,i,R,n,M,C,N]);var k=Object(r.useCallback)((function(e){e&&e.length?(F(Object(b.addFilter)({id:n,column:c,type:m._FilterTypes.IN,values:e,owner:t})),w.forEach((function(o){F(Object(b.addFilter)({id:o.id,column:o.column,type:m._FilterTypes.IN,values:e,owner:t}))}))):(F(Object(b.removeFilter)({id:n,column:c})),w.forEach((function(e){F(Object(b.removeFilter)({id:e.id,column:e.column}))})))}),[c,n,t,F]);return Object(h.jsx)(y.WrapperWidgetUI,Object(j.a)(Object(j.a)({title:o,isLoading:I},L),{},{children:D.length||I?Object(h.jsx)(y.CategoryWidgetUI,{data:D,formatter:u,labels:l,selectedCategories:U,onSelectedCategoriesChange:k,animation:s,filterable:f,searchable:p}):Object(h.jsx)(y.NoDataAlert,Object(j.a)({},E))}))}C.defaultProps={labels:{},animation:!0,filterable:!0,searchable:!0,wrapperProps:{},noDataAlertProps:{}};var L=C,E=Object(f.a)((function(){return{filters:{}}}));function w(){var e=Object(d.useDispatch)(),t=E();Object(r.useEffect)((function(){return e(Object(b.addSource)(i)),e(Object(b.addLayer)({id:u.a,source:i.id})),function(){e(Object(b.removeLayer)(u.a)),e(Object(b.removeSource)(i.id))}}),[e]),Object(r.useEffect)((function(){return e(Object(b.addSource)(l)),e(Object(b.addLayer)({id:s.a,source:l.id})),function(){e(Object(b.removeLayer)(s.a)),e(Object(b.removeSource)(l.id))}}),[e]),Object(r.useEffect)((function(){return e(Object(b.addSource)(c)),e(Object(b.addLayer)({id:a.a,source:c.id})),function(){e(Object(b.removeLayer)(a.a)),e(Object(b.removeSource)(c.id))}}),[e]);return Object(h.jsx)(p.a,{container:!0,direction:"column",className:t.filters,children:Object(h.jsxs)(p.a,{item:!0,children:[Object(h.jsx)(g.FormulaWidget,{id:"totPop",title:"Total Population",dataSource:c.id,column:"aggregated_total",operation:m.AggregationTypes.SUM,formatter:function(e){return(t=e)>1e6?"".concat(Math.round(t/1e6,2)," M"):t>1e3?"".concat(Math.round(t/1e3,2)," k"):"".concat(t);var t},onError:console.error}),Object(h.jsx)(L,{id:"stateCategory",title:"State Name",dataSource:l.id,column:"state",operation:m.AggregationTypes.COUNT,onError:console.error,otherSources:[{id:i.id,column:"state"},{id:c.id,column:"state"}]}),Object(h.jsx)(L,{id:"countyCategory",title:"County Name",dataSource:l.id,column:"county",operation:m.AggregationTypes.COUNT,onError:console.error,otherSources:[{id:i.id,column:"county"},{id:c.id,column:"county"}]})]})})}}}]);
//# sourceMappingURL=11.2821c129.chunk.js.map