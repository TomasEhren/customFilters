{"ast":null,"code":"export function unpackIndexedGeometry(geometry) {\n  var indices = geometry.indices,\n      attributes = geometry.attributes;\n\n  if (!indices) {\n    return geometry;\n  }\n\n  var vertexCount = indices.value.length;\n  var unpackedAttributes = {};\n\n  for (var attributeName in attributes) {\n    var attribute = attributes[attributeName];\n    var constant = attribute.constant,\n        value = attribute.value,\n        size = attribute.size;\n\n    if (constant || !size) {\n      continue;\n    }\n\n    var unpackedValue = new value.constructor(vertexCount * size);\n\n    for (var x = 0; x < vertexCount; ++x) {\n      var index = indices.value[x];\n\n      for (var i = 0; i < size; i++) {\n        unpackedValue[x * size + i] = value[index * size + i];\n      }\n    }\n\n    unpackedAttributes[attributeName] = {\n      size: size,\n      value: unpackedValue\n    };\n  }\n\n  return {\n    attributes: Object.assign({}, attributes, unpackedAttributes)\n  };\n}","map":{"version":3,"mappings":"AAAA,OAAO,SAASA,qBAAT,CAA+BC,QAA/B,EAAyC;EAC9C,IAAOC,OAAP,GAA8BD,QAA9B,CAAOC,OAAP;EAAA,IAAgBC,UAAhB,GAA8BF,QAA9B,CAAgBE,UAAhB;;EACA,IAAI,CAACD,OAAL,EAAc;IACZ,OAAOD,QAAP;EACD;;EAED,IAAMG,WAAW,GAAGF,OAAO,CAACG,KAARH,CAAcI,MAAlC;EACA,IAAMC,kBAAkB,GAAG,EAA3B;;EAEA,KAAK,IAAMC,aAAX,IAA4BL,UAA5B,EAAwC;IACtC,IAAMM,SAAS,GAAGN,UAAU,CAACK,aAAD,CAA5B;IACA,IAAOE,QAAP,GAAgCD,SAAhC,CAAOC,QAAP;IAAA,IAAiBL,KAAjB,GAAgCI,SAAhC,CAAiBJ,KAAjB;IAAA,IAAwBM,IAAxB,GAAgCF,SAAhC,CAAwBE,IAAxB;;IACA,IAAID,QAAQ,IAAI,CAACC,IAAjB,EAAuB;MACrB;IACD;;IACD,IAAMC,aAAa,GAAG,IAAIP,KAAK,CAACQ,WAAV,CAAsBT,WAAW,GAAGO,IAApC,CAAtB;;IACA,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGV,WAApB,EAAiC,EAAEU,CAAnC,EAAsC;MACpC,IAAMC,KAAK,GAAGb,OAAO,CAACG,KAARH,CAAcY,CAAdZ,CAAd;;MACA,KAAK,IAAIc,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,IAApB,EAA0BK,CAAC,EAA3B,EAA+B;QAC7BJ,aAAa,CAACE,CAAC,GAAGH,IAAJG,GAAWE,CAAZ,CAAbJ,GAA8BP,KAAK,CAACU,KAAK,GAAGJ,IAARI,GAAeC,CAAhB,CAAnCJ;MACD;IACF;;IACDL,kBAAkB,CAACC,aAAD,CAAlBD,GAAoC;MAACI,IAAD,EAACA,IAAD;MAAON,KAAK,EAAEO;IAAd,CAApCL;EACD;;EAED,OAAO;IACLJ,UAAU,EAAEc,MAAM,CAACC,MAAPD,CAAc,EAAdA,EAAkBd,UAAlBc,EAA8BV,kBAA9BU;EADP,CAAP;AAGD","names":["unpackIndexedGeometry","geometry","indices","attributes","vertexCount","value","length","unpackedAttributes","attributeName","attribute","constant","size","unpackedValue","constructor","x","index","i","Object","assign"],"sources":["../../../src/geometry/geometry-utils.js"],"sourcesContent":["export function unpackIndexedGeometry(geometry) {\n  const {indices, attributes} = geometry;\n  if (!indices) {\n    return geometry;\n  }\n\n  const vertexCount = indices.value.length;\n  const unpackedAttributes = {};\n\n  for (const attributeName in attributes) {\n    const attribute = attributes[attributeName];\n    const {constant, value, size} = attribute;\n    if (constant || !size) {\n      continue; // eslint-disable-line\n    }\n    const unpackedValue = new value.constructor(vertexCount * size);\n    for (let x = 0; x < vertexCount; ++x) {\n      const index = indices.value[x];\n      for (let i = 0; i < size; i++) {\n        unpackedValue[x * size + i] = value[index * size + i];\n      }\n    }\n    unpackedAttributes[attributeName] = {size, value: unpackedValue};\n  }\n\n  return {\n    attributes: Object.assign({}, attributes, unpackedAttributes)\n  };\n}\n"]},"metadata":{},"sourceType":"module"}