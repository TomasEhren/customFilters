{"ast":null,"code":"!function (e, t) {\n  \"object\" == typeof exports && \"object\" == typeof module ? module.exports = t(require(\"@turf/bbox-polygon\"), require(\"@turf/boolean-intersects\"), require(\"@turf/boolean-within\"), require(\"@turf/intersect\")) : \"function\" == typeof define && define.amd ? define([\"@turf/bbox-polygon\", \"@turf/boolean-intersects\", \"@turf/boolean-within\", \"@turf/intersect\"], t) : \"object\" == typeof exports ? exports.cartoReactCore = t(require(\"@turf/bbox-polygon\"), require(\"@turf/boolean-intersects\"), require(\"@turf/boolean-within\"), require(\"@turf/intersect\")) : e.cartoReactCore = t(e[\"@turf/bbox-polygon\"], e[\"@turf/boolean-intersects\"], e[\"@turf/boolean-within\"], e[\"@turf/intersect\"]);\n}(self, function (e, t, r, n) {\n  return (() => {\n    \"use strict\";\n\n    var u = {\n      855: t => {\n        t.exports = e;\n      },\n      97: e => {\n        e.exports = t;\n      },\n      55: e => {\n        e.exports = r;\n      },\n      956: e => {\n        e.exports = n;\n      }\n    },\n        o = {};\n\n    function i(e) {\n      var t = o[e];\n      if (void 0 !== t) return t.exports;\n      var r = o[e] = {\n        exports: {}\n      };\n      return u[e](r, r.exports, i), r.exports;\n    }\n\n    i.n = e => {\n      var t = e && e.__esModule ? () => e.default : () => e;\n      return i.d(t, {\n        a: t\n      }), t;\n    }, i.d = (e, t) => {\n      for (var r in t) i.o(t, r) && !i.o(e, r) && Object.defineProperty(e, r, {\n        enumerable: !0,\n        get: t[r]\n      });\n    }, i.o = (e, t) => Object.prototype.hasOwnProperty.call(e, t), i.r = e => {\n      \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {\n        value: \"Module\"\n      }), Object.defineProperty(e, \"__esModule\", {\n        value: !0\n      });\n    };\n    var a = {};\n    return (() => {\n      function e(e, t, r) {\n        return t in e ? Object.defineProperty(e, t, {\n          value: r,\n          enumerable: !0,\n          configurable: !0,\n          writable: !0\n        }) : e[t] = r, e;\n      }\n\n      function t(e, t) {\n        var r = Object.keys(e);\n\n        if (Object.getOwnPropertySymbols) {\n          var n = Object.getOwnPropertySymbols(e);\n          t && (n = n.filter(function (t) {\n            return Object.getOwnPropertyDescriptor(e, t).enumerable;\n          })), r.push.apply(r, n);\n        }\n\n        return r;\n      }\n\n      function r(r) {\n        for (var n = 1; n < arguments.length; n++) {\n          var u = null != arguments[n] ? arguments[n] : {};\n          n % 2 ? t(Object(u), !0).forEach(function (t) {\n            e(r, t, u[t]);\n          }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(u)) : t(Object(u)).forEach(function (e) {\n            Object.defineProperty(r, e, Object.getOwnPropertyDescriptor(u, e));\n          });\n        }\n\n        return r;\n      }\n\n      i.r(a), i.d(a, {\n        AggregationTypes: () => v,\n        EDIT_MODES: () => Be,\n        FEATURE_SELECTION_MODES: () => Se,\n        GroupDateTypes: () => Oe,\n        MASK_ID: () => Te,\n        REQUEST_GET_MAX_URL_LENGTH: () => n,\n        _FilterTypes: () => w,\n        _applyFilters: () => R,\n        _buildFeatureFilter: () => x,\n        _filtersToSQL: () => _,\n        _getApplicableFilters: () => U,\n        aggregationFunctions: () => g,\n        debounce: () => l,\n        encodeParameter: () => c,\n        geojsonFeatures: () => he,\n        getMonday: () => f,\n        getRequest: () => u,\n        groupValuesByColumn: () => E,\n        groupValuesByDateColumn: () => je,\n        histogram: () => h,\n        makeIntervalComplete: () => p,\n        postRequest: () => o,\n        randomString: () => D,\n        scatterPlot: () => O,\n        throttle: () => s,\n        tileFeatures: () => Ee\n      });\n      var n = 2048;\n\n      function u(e, t) {\n        return new Request(e, r({\n          method: \"GET\",\n          headers: {\n            Accept: \"application/json\"\n          }\n        }, t));\n      }\n\n      function o(e, t, n) {\n        return new Request(e, r({\n          method: \"POST\",\n          headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify(t)\n        }, n));\n      }\n\n      function c(e, t) {\n        return \"\".concat(e, \"=\").concat(encodeURIComponent(t));\n      }\n\n      function f(e) {\n        var t = new Date(e),\n            r = t.getDay(),\n            n = t.getDate() - r + (r ? 1 : -6);\n        return t.setDate(n), Date.UTC(t.getUTCFullYear(), t.getUTCMonth(), t.getUTCDate());\n      }\n\n      function l(e, t) {\n        var r,\n            n = this;\n        return function () {\n          for (var u = arguments.length, o = new Array(u), i = 0; i < u; i++) o[i] = arguments[i];\n\n          return clearTimeout(r), r = setTimeout(function () {\n            r = null, e.apply(n, o);\n          }, t);\n        };\n      }\n\n      function s(e, t) {\n        var r = 0;\n        return function () {\n          var n = new Date();\n          n - r >= t && (e(), r = n);\n        };\n      }\n\n      function D(e) {\n        for (var t = \"\", r = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\", n = 0; n < e; n++) t += r.charAt(Math.floor(Math.random() * r.length));\n\n        return t;\n      }\n\n      function p(e) {\n        return e.map(function (e) {\n          return void 0 === e[0] ? [Number.MIN_SAFE_INTEGER, e[1]] : void 0 === e[1] ? [e[0], Number.MAX_SAFE_INTEGER] : e;\n        });\n      }\n\n      var y,\n          v = Object.freeze({\n        COUNT: \"count\",\n        AVG: \"avg\",\n        MIN: \"min\",\n        MAX: \"max\",\n        SUM: \"sum\"\n      }),\n          m = function (e, t) {\n        var r = t ? function (e, r) {\n          return e + r[t];\n        } : function (e, t) {\n          return e + t;\n        };\n        return e.reduce(r, 0);\n      },\n          g = (e(y = {}, v.COUNT, function (e) {\n        return e.length;\n      }), e(y, v.MIN, function (e, t) {\n        return function (e, t) {\n          var r = t ? function (e, r) {\n            return Math.min(e, r[t]);\n          } : function (e, t) {\n            return Math.min(e, t);\n          };\n          return e.reduce(r, 1 / 0);\n        }(e, t);\n      }), e(y, v.MAX, function (e, t) {\n        return function (e, t) {\n          var r = t ? function (e, r) {\n            return Math.max(e, r[t]);\n          } : function (e, t) {\n            return Math.max(e, t);\n          };\n          return e.reduce(r, -1 / 0);\n        }(e, t);\n      }), e(y, v.SUM, function (e, t) {\n        return m(e, t);\n      }), e(y, v.AVG, function (e, t) {\n        return m(e, t) / (e.length || 1);\n      }), y);\n\n      function F(e, t) {\n        (null == t || t > e.length) && (t = e.length);\n\n        for (var r = 0, n = new Array(t); r < t; r++) n[r] = e[r];\n\n        return n;\n      }\n\n      function b(e, t) {\n        if (e) {\n          if (\"string\" == typeof e) return F(e, t);\n          var r = Object.prototype.toString.call(e).slice(8, -1);\n          return \"Object\" === r && e.constructor && (r = e.constructor.name), \"Map\" === r || \"Set\" === r ? Array.from(e) : \"Arguments\" === r || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? F(e, t) : void 0;\n        }\n      }\n\n      function d(e, t) {\n        return function (e) {\n          if (Array.isArray(e)) return e;\n        }(e) || function (e, t) {\n          var r = null == e ? null : \"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"];\n\n          if (null != r) {\n            var n,\n                u,\n                o = [],\n                i = !0,\n                a = !1;\n\n            try {\n              for (r = r.call(e); !(i = (n = r.next()).done) && (o.push(n.value), !t || o.length !== t); i = !0);\n            } catch (e) {\n              a = !0, u = e;\n            } finally {\n              try {\n                i || null == r.return || r.return();\n              } finally {\n                if (a) throw u;\n              }\n            }\n\n            return o;\n          }\n        }(e, t) || b(e, t) || function () {\n          throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n        }();\n      }\n\n      function E(e, t, r, n) {\n        if (Array.isArray(e) && 0 === e.length) return null;\n        var u = e.reduce(function (e, u) {\n          var o = u[r];\n          return e[o] = e[o] || [], (n === v.COUNT || null !== u[t]) && void 0 !== u[t] && e[o].push(u[t]), e;\n        }, {}),\n            o = g[n];\n        return o ? Object.entries(u).map(function (e) {\n          var t = d(e, 2),\n              r = t[0],\n              n = t[1];\n          return {\n            name: r,\n            value: o(n)\n          };\n        }) : [];\n      }\n\n      function A(e) {\n        return function (e) {\n          if (Array.isArray(e)) return F(e);\n        }(e) || function (e) {\n          if (\"undefined\" != typeof Symbol && null != e[Symbol.iterator] || null != e[\"@@iterator\"]) return Array.from(e);\n        }(e) || b(e) || function () {\n          throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n        }();\n      }\n\n      function h(e, t, r, n) {\n        if (Array.isArray(e) && 0 === e.length) return [];\n        var u = (r = [Number.MIN_SAFE_INTEGER].concat(A(r))).map(function (e, t, r) {\n          return {\n            bin: t,\n            start: e,\n            end: t === r.length - 1 ? Number.MAX_SAFE_INTEGER : r[t + 1],\n            values: []\n          };\n        });\n        e.forEach(function (e) {\n          var r = e[t];\n\n          if (null != r) {\n            var n = u.find(function (e) {\n              return e.start <= r && e.end > r;\n            });\n            n && n.values.push(r);\n          }\n        });\n        var o = g[n];\n        return o ? u.map(function (e) {\n          return e.values;\n        }).map(function (e) {\n          return e.length ? o(e) : 0;\n        }) : [];\n      }\n\n      var C,\n          O = function (e, t, r) {\n        return e.filter(function (e) {\n          var n = null != e[t],\n              u = e[r];\n          return n && null != u;\n        }).map(function (e) {\n          return [e[t], e[r]];\n        });\n      },\n          w = Object.freeze({\n        IN: \"in\",\n        BETWEEN: \"between\",\n        CLOSED_OPEN: \"closed_open\",\n        TIME: \"time\",\n        STRING_SEARCH: \"stringSearch\"\n      }),\n          j = (e(C = {}, w.IN, function (e, t) {\n        return e.includes(t);\n      }), e(C, w.BETWEEN, S), e(C, w.TIME, function (e, t) {\n        var r = new Date(t).getTime();\n        if (isFinite(r)) return S(e, r);\n        throw new Error(\"Column used to filter by time isn't well formatted.\");\n      }), e(C, w.CLOSED_OPEN, function (e, t) {\n        return p(e).some(function (e) {\n          var r = d(e, 2),\n              n = r[0],\n              u = r[1];\n          return t >= n && t < u;\n        });\n      }), e(C, w.STRING_SEARCH, function (e, t) {\n        var r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},\n            n = I(t, r),\n            u = e.map(function (e) {\n          var t = P(I(e, r));\n          return r.mustStart && (t = \"^\".concat(t)), r.mustEnd && (t = \"\".concat(t, \"$\")), t;\n        }).join(\"|\"),\n            o = new RegExp(u, \"g\");\n        return !!n.match(o);\n      }), C);\n\n      function S(e, t) {\n        return p(e).some(function (e) {\n          var r = d(e, 2),\n              n = r[0],\n              u = r[1];\n          return t >= n && t <= u;\n        });\n      }\n\n      var B = /[.*+?^${}()|[\\]\\\\]/g,\n          T = /(?:[\\^`\\xA8\\xAF\\xB4\\xB7\\xB8\\u02B0-\\u034E\\u0350-\\u0357\\u035D-\\u0362\\u0374\\u0375\\u037A\\u0384\\u0385\\u0483-\\u0487\\u0559\\u0591-\\u05A1\\u05A3-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u064B-\\u0652\\u0657\\u0658\\u06DF\\u06E0\\u06E5\\u06E6\\u06EA-\\u06EC\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F5\\u0818\\u0819\\u0898-\\u089F\\u08C9-\\u08D2\\u08E3-\\u08FE\\u093C\\u094D\\u0951-\\u0954\\u0971\\u09BC\\u09CD\\u0A3C\\u0A4D\\u0ABC\\u0ACD\\u0AFD-\\u0AFF\\u0B3C\\u0B4D\\u0B55\\u0BCD\\u0C3C\\u0C4D\\u0CBC\\u0CCD\\u0D3B\\u0D3C\\u0D4D\\u0DCA\\u0E47-\\u0E4C\\u0E4E\\u0EBA\\u0EC8-\\u0ECC\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F82-\\u0F84\\u0F86\\u0F87\\u0FC6\\u1037\\u1039\\u103A\\u1063\\u1064\\u1069-\\u106D\\u1087-\\u108D\\u108F\\u109A\\u109B\\u135D-\\u135F\\u1714\\u1715\\u17C9-\\u17D3\\u17DD\\u1939-\\u193B\\u1A75-\\u1A7C\\u1A7F\\u1AB0-\\u1ABE\\u1AC1-\\u1ACB\\u1B34\\u1B44\\u1B6B-\\u1B73\\u1BAA\\u1BAB\\u1C36\\u1C37\\u1C78-\\u1C7D\\u1CD0-\\u1CE8\\u1CED\\u1CF4\\u1CF7-\\u1CF9\\u1D2C-\\u1D6A\\u1DC4-\\u1DCF\\u1DF5-\\u1DFF\\u1FBD\\u1FBF-\\u1FC1\\u1FCD-\\u1FCF\\u1FDD-\\u1FDF\\u1FED-\\u1FEF\\u1FFD\\u1FFE\\u2CEF-\\u2CF1\\u2E2F\\u302A-\\u302F\\u3099-\\u309C\\u30FC\\uA66F\\uA67C\\uA67D\\uA67F\\uA69C\\uA69D\\uA6F0\\uA6F1\\uA700-\\uA721\\uA788-\\uA78A\\uA7F8\\uA7F9\\uA8C4\\uA8E0-\\uA8F1\\uA92B-\\uA92E\\uA953\\uA9B3\\uA9C0\\uA9E5\\uAA7B-\\uAA7D\\uAABF-\\uAAC2\\uAAF6\\uAB5B-\\uAB5F\\uAB69-\\uAB6B\\uABEC\\uABED\\uFB1E\\uFE20-\\uFE2F\\uFF3E\\uFF40\\uFF70\\uFF9E\\uFF9F\\uFFE3]|\\uD800\\uDEE0|\\uD801[\\uDF80-\\uDF85\\uDF87-\\uDFB0\\uDFB2-\\uDFBA]|\\uD802[\\uDEE5\\uDEE6]|\\uD803[\\uDD22-\\uDD27\\uDF46-\\uDF50\\uDF82-\\uDF85]|\\uD804[\\uDC46\\uDC70\\uDCB9\\uDCBA\\uDD33\\uDD34\\uDD73\\uDDC0\\uDDCA-\\uDDCC\\uDE35\\uDE36\\uDEE9\\uDEEA\\uDF3C\\uDF4D\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC42\\uDC46\\uDCC2\\uDCC3\\uDDBF\\uDDC0\\uDE3F\\uDEB6\\uDEB7\\uDF2B]|\\uD806[\\uDC39\\uDC3A\\uDD3D\\uDD3E\\uDD43\\uDDE0\\uDE34\\uDE47\\uDE99]|\\uD807[\\uDC3F\\uDD42\\uDD44\\uDD45\\uDD97]|\\uD81A[\\uDEF0-\\uDEF4\\uDF30-\\uDF36]|\\uD81B[\\uDF8F-\\uDF9F\\uDFF0\\uDFF1]|\\uD82B[\\uDFF0-\\uDFF3\\uDFF5-\\uDFFB\\uDFFD\\uDFFE]|\\uD833[\\uDF00-\\uDF2D\\uDF30-\\uDF46]|\\uD834[\\uDD67-\\uDD69\\uDD6D-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD]|\\uD838[\\uDD30-\\uDD36\\uDEAE\\uDEEC-\\uDEEF]|\\uD83A[\\uDCD0-\\uDCD6\\uDD44-\\uDD46\\uDD48-\\uDD4A])/g;\n\n      function P(e) {\n        return e.replace(B, \"\\\\$&\");\n      }\n\n      function I(e, t) {\n        var r = \"\" + e;\n        return t.caseSensitive || (r = r.toLocaleLowerCase()), t.keepSpecialCharacters || (r = r.normalize(\"NFD\").replace(T, \"\")), r;\n      }\n\n      function M(e, t) {\n        var r = Object.keys(e);\n\n        if (Object.getOwnPropertySymbols) {\n          var n = Object.getOwnPropertySymbols(e);\n          t && (n = n.filter(function (t) {\n            return Object.getOwnPropertyDescriptor(e, t).enumerable;\n          })), r.push.apply(r, n);\n        }\n\n        return r;\n      }\n\n      function N(t) {\n        for (var r = 1; r < arguments.length; r++) {\n          var n = null != arguments[r] ? arguments[r] : {};\n          r % 2 ? M(Object(n), !0).forEach(function (r) {\n            e(t, r, n[r]);\n          }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(n)) : M(Object(n)).forEach(function (e) {\n            Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(n, e));\n          });\n        }\n\n        return t;\n      }\n\n      var U = function () {\n        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},\n            t = arguments.length > 1 ? arguments[1] : void 0,\n            r = {};\n        return Object.entries(e).forEach(function (e) {\n          var n = d(e, 2),\n              u = n[0],\n              o = n[1],\n              i = {};\n          Object.keys(o).filter(function (e) {\n            return o[e].owner !== t;\n          }).forEach(function (e) {\n            return i[e] = N({}, o[e]);\n          }), Object.keys(i).length && (r[u] = i);\n        }), r;\n      },\n          _ = function () {\n        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},\n            t = [];\n        return Object.entries(e).forEach(function (e) {\n          var r = d(e, 2),\n              n = r[0],\n              u = r[1];\n          Object.entries(u).forEach(function (e) {\n            var r = d(e, 2),\n                u = r[0],\n                o = r[1];\n\n            switch (u) {\n              case w.IN:\n                t.push(\"\".concat(n, \" \").concat(u, \"(\").concat(o.values.map(function (e) {\n                  return isFinite(e) ? e : \"'\".concat(e, \"'\");\n                }).join(\",\"), \")\"));\n                break;\n\n              case w.BETWEEN:\n                t.push(\"(\".concat(o.values.map(function (e) {\n                  var t = d(e, 2),\n                      r = t[0],\n                      u = t[1];\n                  return \"\".concat(r ? \"\".concat(n, \" >= \").concat(r) : \"\", \" \").concat(r && u ? \" and \" : \"\", \" \").concat(u ? \"\".concat(n, \" < \").concat(u) : \"\");\n                }).join(\") OR (\"), \")\"));\n                break;\n\n              default:\n                throw new Error(\"Not valid operator has provided: \".concat(u));\n            }\n          });\n        }), t.length ? \"WHERE (\".concat(t.join(\") AND (\"), \")\") : \"\";\n      };\n\n      function x(e) {\n        var t = e.filters,\n            r = void 0 === t ? {} : t,\n            n = e.type,\n            u = void 0 === n ? \"boolean\" : n,\n            o = Object.keys(r);\n        return o.length ? function (e) {\n          var t = e.properties || e,\n              n = function (e, t, r) {\n            return e.every(function (e) {\n              var n = t[e],\n                  u = Object.keys(n);\n              return !(!r || null === r[e] || void 0 === r[e]) && u.every(function (t) {\n                var u = j[t];\n                if (!u) throw new Error('\"'.concat(t, '\" filter is not implemented.'));\n                return u(n[t].values, r[e], n[t].params);\n              });\n            });\n          }(o, r, t);\n\n          return \"number\" === u ? Number(n) : n;\n        } : function () {\n          return \"number\" !== u || 1;\n        };\n      }\n\n      function R(e, t) {\n        return Object.keys(t).length ? e.filter(x({\n          filters: t\n        })) : e;\n      }\n\n      const q = \"{user}\",\n            L = (\"https://\".concat(q, \".carto.com/api/v1/map\"), \"https://maps-api-v2.\".concat(\"{region}\", \".carto.com/user/\").concat(q), \"mvt\");\n      let k;\n      !function (e) {\n        e.Number = \"number\", e.Bigint = \"bigint\", e.String = \"string\", e.Geometry = \"geometry\", e.Timestamp = \"timestamp\", e.Object = \"object\", e.Boolean = \"boolean\", e.Variant = \"variant\", e.Unknown = \"unknown\";\n      }(k || (k = {}));\n      var G = i(855),\n          z = i.n(G),\n          Y = i(97),\n          H = i.n(Y),\n          V = i(55),\n          W = i.n(V),\n          X = i(956),\n          $ = i.n(X);\n\n      function K(e, t) {\n        if (!e) throw new Error(t || \"@math.gl/web-mercator: assertion failed.\");\n      }\n\n      Math.log2;\n      const Q = Math.PI,\n            J = Q / 4,\n            Z = Q / 180;\n\n      function ee(e, t) {\n        var r = Object.keys(e);\n\n        if (Object.getOwnPropertySymbols) {\n          var n = Object.getOwnPropertySymbols(e);\n          t && (n = n.filter(function (t) {\n            return Object.getOwnPropertyDescriptor(e, t).enumerable;\n          })), r.push.apply(r, n);\n        }\n\n        return r;\n      }\n\n      function te(t) {\n        for (var r = 1; r < arguments.length; r++) {\n          var n = null != arguments[r] ? arguments[r] : {};\n          r % 2 ? ee(Object(n), !0).forEach(function (r) {\n            e(t, r, n[r]);\n          }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(n)) : ee(Object(n)).forEach(function (e) {\n            Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(n, e));\n          });\n        }\n\n        return t;\n      }\n\n      function re(e, t) {\n        var r = [ce([t.west, t.north]), ce([t.east, t.south])],\n            n = ne[e.type];\n        if (!n) throw new Error(\"Unrecognized geometry type \".concat(e.type));\n        return te(te({}, e), {}, {\n          coordinates: n(e.coordinates, r)\n        });\n      }\n\n      Math.PI;\n      var ne = {\n        Point: ue,\n        MultiPoint: function (e, t) {\n          return oe(e, t);\n        },\n        LineString: ie,\n        MultiLineString: function (e, t) {\n          return e.map(function (e) {\n            return ie(e, t);\n          });\n        },\n        Polygon: ae,\n        MultiPolygon: function (e, t) {\n          return e.map(function (e) {\n            return ae(e, t);\n          });\n        }\n      };\n\n      function ue(e, t) {\n        var r = d(e, 2),\n            n = r[0],\n            u = r[1],\n            o = d(t, 2),\n            i = o[0],\n            a = o[1];\n        return [fe(i[0], a[0], n), fe(i[1], a[1], u)];\n      }\n\n      function oe(e, t) {\n        return e.map(function (e) {\n          return ue(ce(e), t);\n        });\n      }\n\n      function ie(e, t) {\n        return oe(e, t);\n      }\n\n      function ae(e, t) {\n        return e.map(function (e) {\n          return oe(e, t);\n        });\n      }\n\n      function ce(e) {\n        return function (_ref) {\n          let [e, t] = _ref;\n          K(Number.isFinite(e)), K(Number.isFinite(t) && t >= -90 && t <= 90, \"invalid latitude\");\n          const r = t * Z;\n          return [512 * (e * Z + Q) / (2 * Q), 512 * (Q + Math.log(Math.tan(J + .5 * r))) / (2 * Q)];\n        }(e);\n      }\n\n      function fe(e, t, r) {\n        return (r - e) / (t - e);\n      }\n\n      function le(e, t) {\n        (null == t || t > e.length) && (t = e.length);\n\n        for (var r = 0, n = new Array(t); r < t; r++) n[r] = e[r];\n\n        return n;\n      }\n\n      var se = Object.freeze({\n        Point: 0,\n        LineString: 1,\n        Polygon: 2\n      });\n\n      function De(e) {\n        return (e.primitivePolygonIndices || e.pathIndices || e.pointIndices).value;\n      }\n\n      function pe(e, t) {\n        var r = function (e, t) {\n          return e.featureIds.value[t];\n        }(e, t),\n            n = e.properties,\n            u = e.numericProps,\n            o = {\n          properties: n[r],\n          numericProps: {}\n        };\n\n        for (var i in u) o.numericProps[i] = u[i].value[t];\n\n        return o;\n      }\n\n      function ye(e) {\n        var t = e.properties,\n            r = e.numericProps;\n        return Object.assign({}, t, r);\n      }\n\n      function ve(e, t, r) {\n        if (t) return me(e, t);\n        var n = r.size + 1;\n        return me(e, \"cartodb_id\") || me(e, \"geoid\") || n;\n      }\n\n      function me(e, t) {\n        var r = e.properties;\n        return e.numericProps[t] || r[t];\n      }\n\n      function ge(e, t) {\n        switch (t) {\n          case se.Polygon:\n            return {\n              type: \"Polygon\",\n              coordinates: [e]\n            };\n\n          case se.LineString:\n            return {\n              type: \"LineString\",\n              coordinates: e\n            };\n\n          case se.Point:\n            return {\n              type: \"Point\",\n              coordinates: e[0]\n            };\n\n          default:\n            throw new Error(\"Invalid geometry type\");\n        }\n      }\n\n      function Fe(e, t, r) {\n        for (var n = [], u = e; u < t; u++) n.push(Array.from(r.value.subarray(u * r.size, (u + 1) * r.size)));\n\n        return n;\n      }\n\n      function be(e) {\n        var t = e.map,\n            r = e.tileIsFullyVisible,\n            n = e.geometryIntersection,\n            u = e.data,\n            o = e.type,\n            i = e.uniqueIdProperty;\n        null != u && u.properties.length && (r ? function (e) {\n          for (var t = e.map, r = e.data, n = e.uniqueIdProperty, u = De(r), o = 0; o < u.length - 1; o++) {\n            var i = pe(r, u[o]),\n                a = ve(i, n, t);\n            a && !t.has(a) && t.set(a, ye(i));\n          }\n        }({\n          map: t,\n          data: u,\n          uniqueIdProperty: i\n        }) : function (e) {\n          for (var t = e.map, r = e.data, n = e.geometryIntersection, u = e.type, o = e.uniqueIdProperty, i = De(r), a = r.positions, c = 0; c < i.length - 1; c++) {\n            var f = i[c],\n                l = i[c + 1],\n                s = pe(r, f),\n                D = ve(s, o, t);\n\n            if (D && !t.has(D)) {\n              var p = Fe(f, l, a);\n              H()(ge(p, u), n) && t.set(D, ye(s));\n            }\n          }\n        }({\n          map: t,\n          data: u,\n          geometryIntersection: n,\n          type: o,\n          uniqueIdProperty: i\n        }));\n      }\n\n      function de(e, t) {\n        return t ? $()(z()(e), t) : z()(e);\n      }\n\n      function Ee(e) {\n        var t = e.tiles,\n            r = e.viewport,\n            n = e.geometry,\n            u = e.uniqueIdProperty,\n            o = e.tileFormat,\n            i = new Map(),\n            a = de(r, n);\n        if (!a) return [];\n\n        var c,\n            f,\n            l,\n            s,\n            D = function (e, t) {\n          var r = \"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"];\n\n          if (!r) {\n            if (Array.isArray(e) || (r = function (e, t) {\n              if (e) {\n                if (\"string\" == typeof e) return le(e, t);\n                var r = Object.prototype.toString.call(e).slice(8, -1);\n                return \"Object\" === r && e.constructor && (r = e.constructor.name), \"Map\" === r || \"Set\" === r ? Array.from(e) : \"Arguments\" === r || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? le(e, t) : void 0;\n              }\n            }(e)) || t && e && \"number\" == typeof e.length) {\n              r && (e = r);\n\n              var n = 0,\n                  u = function () {};\n\n              return {\n                s: u,\n                n: function () {\n                  return n >= e.length ? {\n                    done: !0\n                  } : {\n                    done: !1,\n                    value: e[n++]\n                  };\n                },\n                e: function (e) {\n                  throw e;\n                },\n                f: u\n              };\n            }\n\n            throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n          }\n\n          var o,\n              i = !0,\n              a = !1;\n          return {\n            s: function () {\n              r = r.call(e);\n            },\n            n: function () {\n              var e = r.next();\n              return i = e.done, e;\n            },\n            e: function (e) {\n              a = !0, o = e;\n            },\n            f: function () {\n              try {\n                i || null == r.return || r.return();\n              } finally {\n                if (a) throw o;\n              }\n            }\n          };\n        }(t);\n\n        try {\n          for (D.s(); !(c = D.n()).done;) {\n            var p = c.value;\n\n            if (!1 !== p.isVisible && p.data) {\n              var y = p.bbox,\n                  v = z()([y.west, y.south, y.east, y.north]),\n                  m = W()(v, a),\n                  g = $()(v, a);\n\n              if (g) {\n                var F = {\n                  type: \"Feature\",\n                  geometry: o === L ? re(g.geometry, y) : g.geometry\n                };\n                f = p.data.points, l = void 0, void 0, s = (l = f.featureIds.value)[l.length - 1], f.pointIndices = {\n                  value: new l.constructor(l.length + 1),\n                  size: 1\n                }, f.pointIndices.value.set(l), f.pointIndices.value.set([s + 1], l.length), be({\n                  map: i,\n                  tileIsFullyVisible: m,\n                  geometryIntersection: F,\n                  data: p.data.points,\n                  type: se.Point,\n                  uniqueIdProperty: u\n                }), be({\n                  map: i,\n                  tileIsFullyVisible: m,\n                  geometryIntersection: F,\n                  data: p.data.lines,\n                  type: se.LineString,\n                  uniqueIdProperty: u\n                }), be({\n                  map: i,\n                  tileIsFullyVisible: m,\n                  geometryIntersection: F,\n                  data: p.data.polygons,\n                  type: se.Polygon,\n                  uniqueIdProperty: u\n                });\n              }\n            }\n          }\n        } catch (e) {\n          D.e(e);\n        } finally {\n          D.f();\n        }\n\n        return Array.from(i.values());\n      }\n\n      function Ae(e, t) {\n        (null == t || t > e.length) && (t = e.length);\n\n        for (var r = 0, n = new Array(t); r < t; r++) n[r] = e[r];\n\n        return n;\n      }\n\n      function he(e) {\n        var t = e.geojson,\n            r = e.viewport,\n            n = e.geometry,\n            u = e.uniqueIdProperty,\n            o = 0,\n            i = new Map(),\n            a = de(r, n);\n        if (!a) return [];\n\n        var c,\n            f = function (e, t) {\n          var r = \"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"];\n\n          if (!r) {\n            if (Array.isArray(e) || (r = function (e, t) {\n              if (e) {\n                if (\"string\" == typeof e) return Ae(e, t);\n                var r = Object.prototype.toString.call(e).slice(8, -1);\n                return \"Object\" === r && e.constructor && (r = e.constructor.name), \"Map\" === r || \"Set\" === r ? Array.from(e) : \"Arguments\" === r || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? Ae(e, t) : void 0;\n              }\n            }(e)) || t && e && \"number\" == typeof e.length) {\n              r && (e = r);\n\n              var n = 0,\n                  u = function () {};\n\n              return {\n                s: u,\n                n: function () {\n                  return n >= e.length ? {\n                    done: !0\n                  } : {\n                    done: !1,\n                    value: e[n++]\n                  };\n                },\n                e: function (e) {\n                  throw e;\n                },\n                f: u\n              };\n            }\n\n            throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n          }\n\n          var o,\n              i = !0,\n              a = !1;\n          return {\n            s: function () {\n              r = r.call(e);\n            },\n            n: function () {\n              var e = r.next();\n              return i = e.done, e;\n            },\n            e: function (e) {\n              a = !0, o = e;\n            },\n            f: function () {\n              try {\n                i || null == r.return || r.return();\n              } finally {\n                if (a) throw o;\n              }\n            }\n          };\n        }(t.features);\n\n        try {\n          for (f.s(); !(c = f.n()).done;) {\n            var l = c.value,\n                s = u ? l.properties[u] : ++o;\n            !i.has(s) && H()(a, l) && i.set(s, l.properties);\n          }\n        } catch (e) {\n          f.e(e);\n        } finally {\n          f.f();\n        }\n\n        return Array.from(i.values());\n      }\n\n      var Ce,\n          Oe = Object.freeze({\n        YEARS: \"years\",\n        MONTHS: \"months\",\n        WEEKS: \"weeks\",\n        DAYS: \"days\",\n        HOURS: \"hours\",\n        MINUTES: \"minutes\"\n      }),\n          we = (e(Ce = {}, Oe.YEARS, function (e) {\n        return Date.UTC(e.getUTCFullYear());\n      }), e(Ce, Oe.MONTHS, function (e) {\n        return Date.UTC(e.getUTCFullYear(), e.getUTCMonth());\n      }), e(Ce, Oe.WEEKS, function (e) {\n        return f(e);\n      }), e(Ce, Oe.DAYS, function (e) {\n        return Date.UTC(e.getUTCFullYear(), e.getUTCMonth(), e.getUTCDate());\n      }), e(Ce, Oe.HOURS, function (e) {\n        return Date.UTC(e.getUTCFullYear(), e.getUTCMonth(), e.getUTCDate(), e.getUTCHours());\n      }), e(Ce, Oe.MINUTES, function (e) {\n        return Date.UTC(e.getUTCFullYear(), e.getUTCMonth(), e.getUTCDate(), e.getUTCHours(), e.getUTCMinutes());\n      }), Ce);\n\n      function je(e, t, r, n, u) {\n        if (Array.isArray(e) && 0 === e.length) return null;\n        var o = we[n];\n        if (!o) return null;\n        var i = e.reduce(function (e, n) {\n          var u = n[r],\n              i = new Date(u),\n              a = o(i);\n\n          if (!isNaN(a)) {\n            var c = e.get(a);\n            c || (c = [], e.set(a, c)), null !== n[t] && void 0 !== n[t] && (c.push(n[t]), e.set(a, c));\n          }\n\n          return e;\n        }, new Map()),\n            a = g[u];\n        return a ? A(i.entries()).map(function (e) {\n          var t = d(e, 2),\n              r = t[0],\n              n = t[1];\n          return {\n            name: r,\n            value: a(n)\n          };\n        }).sort(function (e, t) {\n          return e.name - t.name;\n        }) : [];\n      }\n\n      var Se = Object.freeze({\n        POLYGON: \"DrawPolygonMode\",\n        RECTANGLE: \"DrawRectangleMode\",\n        CIRCLE: \"DrawCircleFromCenterMode\",\n        LASSO_TOOL: \"DrawPolygonByDraggingMode\"\n      }),\n          Be = Object.freeze({\n        EDIT: \"edit\"\n      }),\n          Te = \"feature_selection_mask\";\n    })(), a;\n  })();\n});","map":{"version":3,"mappings":"CAAA,UAA2CA,CAA3C,EAAiDC,CAAjD,EAAiDA;EAC1B,mBAAZC,OAAY,IAA8B,mBAAXC,MAAnB,GACrBA,OAAOD,OAAPC,GAAiBF,EAAQG,QAAQ,oBAARA,CAARH,EAAuCG,QAAQ,0BAARA,CAAvCH,EAA4EG,QAAQ,sBAARA,CAA5EH,EAA6GG,QAAQ,iBAARA,CAA7GH,CADI,GAEI,qBAAXI,MAAW,IAAcA,OAAOC,GAArB,GACzBD,OAAO,CAAC,oBAAD,EAAuB,0BAAvB,EAAmD,sBAAnD,EAA2E,iBAA3E,CAAPA,EAAsGJ,CAAtGI,CADyB,GAEC,mBAAZH,OAAY,GAC1BA,QAAwBK,cAAxBL,GAA4BD,EAAQG,QAAQ,oBAARA,CAARH,EAAuCG,QAAQ,0BAARA,CAAvCH,EAA4EG,QAAQ,sBAARA,CAA5EH,EAA6GG,QAAQ,iBAARA,CAA7GH,CADF,GAG1BD,EAAqBO,cAArBP,GAAyBC,EAAQD,EAAK,oBAALA,CAARC,EAAoCD,EAAK,0BAALA,CAApCC,EAAsED,EAAK,sBAALA,CAAtEC,EAAoGD,EAAK,iBAALA,CAApGC,CAPJ;AADvB,EASGO,IATH,EASS,UAASC,CAAT,EAA2CC,CAA3C,EAA4EC,CAA5E,EAA6GC,CAA7G,EAA6GA;EACtH,O;;;;;QCVAT,EAAOD,OAAPC,GAAiBM,CAAjBN;MAAiBM,C;;QCAjBN,EAAOD,OAAPC,GAAiBO,CAAjBP;MAAiBO,C;;QCAjBP,EAAOD,OAAPC,GAAiBQ,CAAjBR;MAAiBQ,C;;QCAjBR,EAAOD,OAAPC,GAAiBS,CAAjBT;MAAiBS;;QCCbC,IAA2B,E;;IAG/B,SAASC,CAAT,CAA6BC,CAA7B,EAA6BA;MAE5B,IAAIC,IAAeH,EAAyBE,CAAzBF,CAAnB;MACA,SAAqBI,CAArB,KAAID,CAAJ,EACC,OAAOA,EAAad,OAApB;MAGD,IAAIC,IAASU,EAAyBE,CAAzBF,IAAqC;QAGjDX,SAAS;MAHwC,CAAlD;MAUA,OAHAgB,EAAoBH,CAApBG,EAA8Bf,CAA9Be,EAAsCf,EAAOD,OAA7CgB,EAAsDJ,CAAtDI,GAGOf,EAAOD,OAAd;ICpBDY;;IAAAA,EAAoBK,CAApBL,GAAyBX;MACxB,IAAIiB,IAASjB,KAAUA,EAAOkB,UAAjBlB,GACZ,MAAOA,EAAiBmB,OADZnB,GAEZ,MAAMoB,CAFP;MAIA,OADAT,EAAoBU,CAApBV,CAAsBM,CAAtBN,EAA8B;QAAEW,GAAGL;MAAL,CAA9BN,GACOM,CAAP;IAAOA,CALRN,ECAAA,EAAoBU,CAApBV,GAAwB,CAACZ,CAAD,EAAUwB,CAAV,KAAUA;MACjC,KAAI,IAAIC,CAAR,IAAeD,CAAf,EACIZ,EAAoBc,CAApBd,CAAsBY,CAAtBZ,EAAkCa,CAAlCb,KAAkCa,CAASb,EAAoBc,CAApBd,CAAsBZ,CAAtBY,EAA+Ba,CAA/Bb,CAA3CA,IACFe,OAAOC,cAAPD,CAAsB3B,CAAtB2B,EAA+BF,CAA/BE,EAAoC;QAAEE,aAAY,CAAd;QAAoBC,KAAKN,EAAWC,CAAXD;MAAzB,CAApCG,CADEf;IACsEa,CDH3Eb,EEDAA,EAAoBc,CAApBd,GAAwB,CAACmB,CAAD,EAAMC,CAAN,KAAgBL,OAAOM,SAAPN,CAAiBO,cAAjBP,CAAgCQ,IAAhCR,CAAqCI,CAArCJ,EAA0CK,CAA1CL,CFCxCf,EGAAA,EAAoBwB,CAApBxB,GAAyBZ;MACH,sBAAXqC,MAAW,IAAeA,OAAOC,WAAtB,IACpBX,OAAOC,cAAPD,CAAsB3B,CAAtB2B,EAA+BU,OAAOC,WAAtCX,EAAmD;QAAEY,OAAO;MAAT,CAAnDZ,CADoB,EAGrBA,OAAOC,cAAPD,CAAsB3B,CAAtB2B,EAA+B,YAA/BA,EAA6C;QAAEY,QAAO;MAAT,CAA7CZ,CAHqB;IAGiC,CHJvDf;;;MIDe,SAAS4B,CAAT,CAAyBT,CAAzB,EAA8BN,CAA9B,EAAmCc,CAAnC,EAAmCA;QAYhD,OAXId,KAAOM,CAAPN,GACFE,OAAOC,cAAPD,CAAsBI,CAAtBJ,EAA2BF,CAA3BE,EAAgC;UAC9BY,OAAOA,CADuB;UAE9BV,aAAY,CAFkB;UAG9BY,eAAc,CAHgB;UAI9BC,WAAU;QAJoB,CAAhCf,CADEF,GAQFM,EAAIN,CAAJM,IAAWQ,CARTd,EAWGM,CAAP;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCTK,IAAMY,IAA6B,IAAnC;;MAKA,SAASC,CAAT,CAAoBC,CAApB,EAAyBC,CAAzB,EAAyBA;QAC9B,OAAO,IAAIC,OAAJ,CAAYF,CAAZ;UACLG,QAAQ,KADH;UAELC,SAAS;YACPC,QAAQ;UADD;QAFJ,GAKFJ,CALE,EAAP;MAYK;;MAAA,SAASK,CAAT,CAAqBN,CAArB,EAA0BO,CAA1B,EAAmCN,CAAnC,EAAmCA;QACxC,OAAO,IAAIC,OAAJ,CAAYF,CAAZ;UACLG,QAAQ,MADH;UAELC,SAAS;YACPC,QAAQ,kBADD;YAEP,gBAAgB;UAFT,CAFJ;UAMLG,MAAMC,KAAKC,SAALD,CAAeF,CAAfE;QAND,GAOFR,CAPE,EAAP;MAcK;;MAAA,SAASU,CAAT,CAAyBC,CAAzB,EAA+BlB,CAA/B,EAA+BA;QACpC,iBAAUkB,CAAV,cAAkBC,mBAAmBnB,CAAnBmB,CAAlB;MCrCK;;MAAA,SAASC,CAAT,CAAmBC,CAAnB,EAAmBA;QACxB,IAAMC,IAAS,IAAIC,IAAJ,CAASF,CAAT,CAAf;QAAA,IACMG,IAAMF,EAAOG,MAAPH,EADZ;QAAA,IAEMI,IAAOJ,EAAOK,OAAPL,KAAmBE,CAAnBF,IAA0BE,IAAM,CAANA,GAAM,CAAK,CAArCF,CAFb;QAIA,OADAA,EAAOM,OAAPN,CAAeI,CAAfJ,GACOC,KAAKM,GAALN,CAASD,EAAOQ,cAAPR,EAATC,EAAkCD,EAAOS,WAAPT,EAAlCC,EAAwDD,EAAOU,UAAPV,EAAxDC,CAAP;MCLK;;MAAA,SAASU,CAAT,CAAkBC,CAAlB,EAAsBC,CAAtB,EAAsBA;QAAI,IAC3BC,CAD2B;QAAA;QAE/B,OAAO;UAAa,+BAATC,IAAS,iCAATA,EAASC,CAATD,IAASE,YAATF;;UAMT,OALAG,aAAaJ,CAAbI,GACAJ,IAAQK,WAAW;YACjBL,IAAQ,IAARA,EACAF,EAAGQ,KAAHR,CAASxD,CAATwD,EAAeG,CAAfH,CADAE;UACeC,CAFTI,EAGLN,CAHKM,CAIR;QADGN,CALL;MCFK;;MAAA,SAASQ,CAAT,CAAkBT,CAAlB,EAAsBC,CAAtB,EAAsBA;QAC3B,IAAIS,IAAW,CAAf;QACA,OAAO;UACL,IAAIC,IAAM,IAAItB,IAAJ,EAAV;UACIsB,IAAMD,CAANC,IAAkBV,CAAlBU,KACFX,KACAU,IAAWC,CAFTA;QAESA,CAJf;MCFK;;MAAA,SAASC,CAAT,CAAsBC,CAAtB,EAAsBA;QAG3B,KAFA,IAAIC,IAAO,EAAX,EACMC,IAAW,gEADjB,EAESX,IAAI,CAAb,EAAgBA,IAAIS,CAApB,EAA4BT,GAA5B,EACEU,KAAQC,EAASC,MAATD,CAAgBE,KAAKC,KAALD,CAAWA,KAAKE,MAALF,KAAgBF,EAASF,MAApCI,CAAhBF,CAARD;;QAEF,OAAOA,CAAP;MCNK;;MAAA,SAASM,CAAT,CAA8BC,CAA9B,EAA8BA;QACnC,OAAOA,EAAOC,GAAPD,CAAW,UAACE,CAAD,EAACA;UACjB,YAAejF,CAAf,KAAIiF,EAAI,CAAJA,CAAJ,GACS,CAACC,OAAOC,gBAAR,EAA0BF,EAAI,CAAJA,CAA1B,CADT,GACuC,KAGxBjF,CAHwB,KAGnCiF,EAAI,CAAJA,CAHmC,GAI9B,CAACA,EAAI,CAAJA,CAAD,EAASC,OAAOE,gBAAhB,CAJ8B,GAOhCH,CARP;QAQOA,CATFF,CAAP;MCIK;;MAAA,I,CAAA;MAAA,IAAMM,IAAmBzE,OAAO0E,MAAP1E,CAAc;QAE5C2E,OAAO,OAFqC;QAK5CC,KAAK,KALuC;QAQ5CC,KAAK,KARuC;QAW5CC,KAAK,KAXuC;QAc5CC,KAAK;MAduC,CAAd/E,CAAzB;MAAA,ICHDgF,IAAM,UAACb,CAAD,EAASrE,CAAT,EAASA;QACnB,IAAMgD,IAAKhD,IAAM,UAACF,CAAD,EAAIqF,CAAJ,EAAIA;UAAJ,OAAUrF,IAAIqF,EAAEnF,CAAFmF,CAAd;QAAgBnF,CAAtBA,GAA6B,UAACF,CAAD,EAAIqF,CAAJ,EAAIA;UAAJ,OAAUrF,IAAIqF,CAAd;QAAcA,CAAtD;QACA,OAAOd,EAAOe,MAAPf,CAAcrB,CAAdqB,EAAkB,CAAlBA,CAAP;MAAyB,CDCpB;MAAA,ICYMgB,KAAoBzF,UAC9B+E,EAAiBE,KADa,EACL,UAACR,CAAD,EAACA;QAAD,OAAYA,EAAOR,MAAnB;MAAmBA,CADd,QAE9Bc,EAAiBI,GAFa,EAEP,UAACV,CAAD,EAASrE,CAAT,EAASA;QAAT,OAZd,UAACqE,CAAD,EAASrE,CAAT,EAASA;UACnB,IAAMgD,IAAKhD,IAAM,UAACF,CAAD,EAAIqF,CAAJ,EAAIA;YAAJ,OAAUlB,KAAKqB,GAALrB,CAASnE,CAATmE,EAAYkB,EAAEnF,CAAFmF,CAAZlB,CAAV;UAAwBjE,CAA9BA,GAAsC,UAACF,CAAD,EAAIqF,CAAJ,EAAIA;YAAJ,OAAUlB,KAAKqB,GAALrB,CAASnE,CAATmE,EAAYkB,CAAZlB,CAAV;UAAsBkB,CAAvE;UACA,OAAOd,EAAOe,MAAPf,CAAcrB,CAAdqB,EAAkBkB,KAAlBlB,CAAP;QAUyCiB,CAZ/B,CAYmCjB,CAZnC,EAY2CrE,CAZ3C,CAYc;MAA6BA,CAFtB,QAG9B2E,EAAiBK,GAHa,EAGP,UAACX,CAAD,EAASrE,CAAT,EAASA;QAAT,OARd,UAACqE,CAAD,EAASrE,CAAT,EAASA;UACnB,IAAMgD,IAAKhD,IAAM,UAACF,CAAD,EAAIqF,CAAJ,EAAIA;YAAJ,OAAUlB,KAAKuB,GAALvB,CAASnE,CAATmE,EAAYkB,EAAEnF,CAAFmF,CAAZlB,CAAV;UAAwBjE,CAA9BA,GAAsC,UAACF,CAAD,EAAIqF,CAAJ,EAAIA;YAAJ,OAAUlB,KAAKuB,GAALvB,CAASnE,CAATmE,EAAYkB,CAAZlB,CAAV;UAAsBkB,CAAvE;UACA,OAAOd,EAAOe,MAAPf,CAAcrB,CAAdqB,EAAcrB,CAAI,CAAJA,GAAI,CAAlBqB,CAAP;QAMyCmB,CAR/B,CAQmCnB,CARnC,EAQ2CrE,CAR3C,CAQc;MAA6BA,CAHtB,QAI9B2E,EAAiBM,GAJa,EAIP,UAACZ,CAAD,EAASrE,CAAT,EAASA;QAAT,OAAiBkF,EAAIb,CAAJa,EAAYlF,CAAZkF,CAAjB;MAA6BlF,CAJtB,QAK9B2E,EAAiBG,GALa,EAKP,UAACT,CAAD,EAASrE,CAAT,EAASA;QAAT,OAAiBkF,EAAIb,CAAJa,EAAYlF,CAAZkF,KAAoBb,EAAOR,MAAPQ,IAAiB,CAArCa,CAAjB;MAAsD,CAL/C,IAApBG,CDZN;;MELQ,SAASI,CAAT,CAA2BC,CAA3B,EAAgCC,CAAhC,EAAgCA;QAAAA,CAClC,QAAPA,CAAO,IAAQA,IAAMD,EAAI7B,MADgB8B,MACRA,IAAMD,EAAI7B,MADF8B;;QAG7C,KAAK,IAAIvC,IAAI,CAAR,EAAWwC,IAAO,IAAIC,KAAJ,CAAUF,CAAV,CAAvB,EAAuCvC,IAAIuC,CAA3C,EAAgDvC,GAAhD,EACEwC,EAAKxC,CAALwC,IAAUF,EAAItC,CAAJsC,CAAVE;;QAGF,OAAOA,CAAP;MCNa;;MAAA,SAASE,CAAT,CAAqC7F,CAArC,EAAwC8F,CAAxC,EAAwCA;QACrD,IAAK9F,CAAL;UACA,IAAiB,mBAANA,CAAX,EAA2B,OAAO+F,EAAiB/F,CAAjB,EAAoB8F,CAApB,CAAP;UAC3B,IAAIvG,IAAIU,OAAOM,SAAPN,CAAiB+F,QAAjB/F,CAA0BQ,IAA1BR,CAA+BD,CAA/BC,EAAkCgG,KAAlChG,CAAwC,CAAxCA,EAAwC,CAAI,CAA5CA,CAAR;UAEA,OADU,aAANV,CAAM,IAAYS,EAAEkG,WAAd,KAA2B3G,IAAIS,EAAEkG,WAAFlG,CAAc+B,IAA7C,GACA,UAANxC,CAAM,IAAe,UAANA,CAAT,GAA6BqG,MAAMO,IAANP,CAAW5F,CAAX4F,CAA7B,GACA,gBAANrG,CAAM,IAAe,2CAA2C6G,IAA3C,CAAgD7G,CAAhD,CAAf,GAA0EwG,EAAiB/F,CAAjB,EAAoB8F,CAApB,CAA1E,GAA8FA,KAAxG,CADA;QACA;MCHa;;MAAA,SAASlG,CAAT,CAAwB6F,CAAxB,EAA6BtC,CAA7B,EAA6BA;QAC1C,OCLa,UAAyBsC,CAAzB,EAAyBA;UACtC,IAAIG,MAAMS,OAANT,CAAcH,CAAdG,CAAJ,EAAwB,OAAOH,CAAP;QDIjB,CCLM,CDKSA,CCLT,KCAA,UAA+BA,CAA/B,EAAoCtC,CAApC,EAAoCA;UACjD,IAAImD,IAAY,QAAPb,CAAO,GAAO,IAAP,GAAgC,sBAAX9E,MAAW,IAAe8E,EAAI9E,OAAO4F,QAAXd,CAAf,IAAuCA,EAAI,YAAJA,CAAvF;;UAEA,IAAU,QAANa,CAAJ;YACA,IAIIE,CAJJ;YAAA,IAIQC,CAJR;YAAA,IAAIC,IAAO,EAAX;YAAA,IACIC,KAAK,CADT;YAAA,IAEIC,KAAK,CAFT;;YAMA;cACE,KAAKN,IAAKA,EAAG7F,IAAH6F,CAAQb,CAARa,CAAV,EAAkBb,EAAQkB,KAAMH,IAAKF,EAAGO,IAAHP,EAAXK,EAAsBG,IAA9BrB,MAChBiB,EAAKK,IAALL,CAAUF,EAAG3F,KAAb6F,GAAa7F,CAETsC,CAFStC,IAEJ6F,EAAK9C,MAAL8C,KAAgBvD,CAHTsC,CAAlB,EAAuDkB,KAAK,CAA5D,CAA4D;YAK5D,CANF,CAME,OAAOK,CAAP,EAAOA;cACPJ,KAAK,CAALA,EACAH,IAAKO,CADLJ;YAEA,CATF,SASE;cACA;gBACOD,KAAsB,QAAhBL,EAAWW,MAAjBN,IAA4BL,EAAWW,MAAXX,EAA5BK;cACL,CAFF,SAEE;gBACA,IAAIC,CAAJ,EAAQ,MAAMH,CAAN;cAAMA;YAIlB;;YAAA,OAAOC,CAAP;UAAOA;QFtBuB,CELjB,CFKsCjB,CELtC,EFK2CtC,CEL3C,CDAA,IDKiD+B,EAA2BO,CAA3B,EAAgCtC,CAAhC,CCLjD,IEAA;UACb,MAAM,IAAI+D,SAAJ,CAAc,2IAAd,CAAN;QHIoG,CGLvF,EHKb;MIFK;;MAAA,SAASC,CAAT,CAA6BC,CAA7B,EAAmCC,CAAnC,EAAiDC,CAAjD,EAA6DC,CAA7D,EAA6DA;QAClE,IAAI3B,MAAMS,OAANT,CAAcwB,CAAdxB,KAAuC,MAAhBwB,EAAKxD,MAAhC,EACE,OAAO,IAAP;QAGF,IAAM4D,IAASJ,EAAKjC,MAALiC,CAAY,UAACK,CAAD,EAAcC,CAAd,EAAcA;UACvC,IAAMC,IAAQD,EAAKJ,CAALI,CAAd;UAYA,OAVAD,EAAYE,CAAZF,IAAqBA,EAAYE,CAAZF,KAAsB,EAA3CA,EAA2C,CAGxCF,MAAc7C,EAAiBE,KAA/B2C,IAAqE,SAAvBG,EAAKL,CAALK,CAHN,KAGWL,KAC7BhI,CAD6BgI,KACpDK,EAAKL,CAALK,CAJyC,IAOzCD,EAAYE,CAAZF,EAAmBV,IAAnBU,CAAwBC,EAAKL,CAALK,CAAxBD,CAPFA,EAUOA,CAAP;QAAOA,CAbML,EAcZ,EAdYA,CAAf;QAAA,IAgBMQ,IAAkBxC,EAAqBmC,CAArBnC,CAhBxB;QAkBA,OAAIwC,IACK3H,OAAO4H,OAAP5H,CAAeuH,CAAfvH,EAAuBoE,GAAvBpE,CAA2B;UAAA;UAAA,IAAE8B,IAAF+F;UAAA,IAAQjH,IAARiH;UAAA,OAAoB;YACpD/F,OADoD;YAEpDlB,OAAO+G,EAAgB/G,CAAhB+G;UAF6C,CAApB;QAET/G,CAFlBZ,CADL2H,GAOG,EAPP;MCtBa;;MAAA,SAASG,CAAT,CAA4BtC,CAA5B,EAA4BA;QACzC,OCJa,UAA4BA,CAA5B,EAA4BA;UACzC,IAAIG,MAAMS,OAANT,CAAcH,CAAdG,CAAJ,EAAwB,OAAOG,EAAiBN,CAAjB,CAAP;QDGjB,CCJM,CDIYA,CCJZ,KCDA,UAA0BuC,CAA1B,EAA0BA;UACvC,IAAsB,sBAAXrH,MAAW,IAAwC,QAAzBqH,EAAKrH,OAAO4F,QAAZyB,CAAf,IAAsE,QAAtBA,EAAK,YAALA,CAAtE,EAAkG,OAAOpC,MAAMO,IAANP,CAAWoC,CAAXpC,CAAP;QFIjE,CELpB,CFKoCH,CELpC,CDCA,IDI4CP,EAA2BO,CAA3B,CCJ5C,IEDA;UACb,MAAM,IAAIyB,SAAJ,CAAc,sIAAd,CAAN;QHI4F,CGL/E,EHKb;MIHK;;MAAA,SAASe,CAAT,CAAmBC,CAAnB,EAA6BC,CAA7B,EAAyCC,CAAzC,EAAgDb,CAAhD,EAAgDA;QACrD,IAAI3B,MAAMS,OAANT,CAAcsC,CAAdtC,KAA+C,MAApBsC,EAAStE,MAAxC,EACE,OAAO,EAAP;QAKF,IAAMyE,KAFND,IAAQ,CAAC7D,OAAOC,gBAAR,EAAH8D,MAAG,CAAHC,EAAgCH,CAAhC,CAAG,CAEFC,EAAsBhE,GAAtBgE,CAA0B,UAACG,CAAD,EAAOC,CAAP,EAAchD,CAAd,EAAcA;UAAd,OAAuB;YACrDiD,KAAKD,CADgD;YAErDE,OAAOH,CAF8C;YAGrDI,KAAKH,MAAUhD,EAAI7B,MAAJ6B,GAAa,CAAvBgD,GAA2BlE,OAAOE,gBAAlCgE,GAAqDhD,EAAIgD,IAAQ,CAAZhD,CAHL;YAIrDrB,QAAQ;UAJ6C,CAAvB;QAItB,CAJJiE,CAAN;QAOAH,EAASW,OAATX,CAAiB,UAACY,CAAD,EAACA;UAChB,IAAMC,IAAeD,EAAQX,CAARW,CAArB;;UAIA,IAFgBC,SAEhB;YAIA,IAAMC,IAAeX,EAAcY,IAAdZ,CACnB,UAACK,CAAD,EAACA;cAAD,OAASA,EAAIC,KAAJD,IAAaK,CAAbL,IAA6BA,EAAIE,GAAJF,GAAUK,CAAhD;YAAgDA,CAD7BV,CAArB;YAIKW,KAILA,EAAa5E,MAAb4E,CAAoBjC,IAApBiC,CAAyBD,CAAzBC,CAJKA;UAIoBD;QAAAA,CAjB3Bb;QAoBA,IAAMN,IAAkBxC,EAAqBmC,CAArBnC,CAAxB;QAEA,OAAIwC,IACsBS,EAAchE,GAAdgE,CAAkB,UAACW,CAAD,EAACA;UAAD,OAAkBA,EAAa5E,MAA/B;QAA+BA,CAAjDiE,EACDhE,GADCgE,CACG,UAACjE,CAAD,EAACA;UAAD,OAAaA,EAAOR,MAAPQ,GAAgBwD,EAAgBxD,CAAhBwD,CAAhBxD,GAA0C,CAAvD;QAAuD,CAD1DiE,CADtBT,GAKG,EALP;MCnCK;;MAAA,I,CAAA;MAAA,IAAMsB,IAAc,UAAChB,CAAD,EAAWiB,CAAX,EAAwBC,CAAxB,EAAwBA;QAAxB,OACzBlB,EACGmB,MADHnB,CACU,UAACY,CAAD,EAACA;UACP,IACMQ,IAAWC,QADFT,EAAQK,CAARL,CAAf;UAAA,IAEMU,IAASV,EAAQM,CAARN,CAFf;UAIA,OAAOQ,KADUE,SACjB;QADiBA,CALrBtB,EAQG7D,GARH6D,CAQO,UAACY,CAAD,EAACA;UAAD,OAAa,CAACA,EAAQK,CAARL,CAAD,EAAuBA,EAAQM,CAARN,CAAvB,CAAb;QAA4CM,CARnDlB,CADyB;MAS0BkB,CAT9C;MAAA,ICDMK,IAAcxJ,OAAO0E,MAAP1E,CAAc;QACvCyJ,IAAI,IADmC;QAEvCC,SAAS,SAF8B;QAGvCC,aAAa,aAH0B;QAIvCC,MAAM,MAJiC;QAKvCC,eAAe;MALwB,CAAd7J,CDCpB;MAAA,ICOM8J,KAAepK,UACzB8J,EAAYC,EADa,YACTM,CADS,EACKjB,CADL,EACKA;QAC7B,OAAOiB,EAAaC,QAAbD,CAAsBjB,CAAtBiB,CAAP;MAA6BjB,CAFL,QAIzBU,EAAYE,OAJa,EAIHO,CAJG,QAKzBT,EAAYI,IALa,YAKPG,CALO,EAKOjB,CALP,EAKOA;QAC/B,IAAMoB,IAA0B,IAAI/H,IAAJ,CAAS2G,CAAT,EAAuBqB,OAAvB,EAAhC;QACA,IAAIC,SAASF,CAATE,CAAJ,EACE,OAAOH,EAAQF,CAARE,EAAsBC,CAAtBD,CAAP;QAEA,MAAM,IAAII,KAAJ,uDAAN;MAAM,CAVgB,QAazBb,EAAYG,WAba,EA4B5B,UAAoBI,CAApB,EAAkCjB,CAAlC,EAAkCA;QAMhC,OAAO5E,EAAqB6F,CAArB7F,EAAmCoG,IAAnCpG,CALY,UAACqG,CAAD,EAACA;UAClB,UAAiCA,CAAjC;UAAA,IAAOC,IAAP/J;UAAA,IAAmBgK,IAAnBhK;UACA,OAAOqI,KAAgB0B,CAAhB1B,IAA8BA,IAAe2B,CAApD;QAAoDA,CAG/CvG,CAAP;MAHsDuG,CA/B5B,QAczBjB,EAAYK,aAda,EAsC5B,UAAsBE,CAAtB,EAAoCjB,CAApC,EAAoCA;QAA2B,IAAb4B,IAAavH,iEAAJ,EAAI;QAAA,IACvDwH,IAAyBC,EAAU9B,CAAV8B,EAAwBF,CAAxBE,CAD8B;QAAA,IAEvDC,IAAed,EAClB3F,GADkB2F,CACd,UAACe,CAAD,EAACA;UACJ,IAAID,IAAeE,EAAaH,EAAUE,CAAVF,EAAuBF,CAAvBE,CAAbG,CAAnB;UAKA,OAHIL,EAAOM,SAAPN,KAAkBG,IAAe,IAAHxC,MAAG,CAAIwC,CAAJ,CAAjCH,GACAA,EAAOO,OAAPP,KAAgBG,IAAe,GAAHxC,MAAG,CAAGwC,CAAH,EAAH,GAAG,CAA/BH,CADAA,EAGGG,CAAP;QAAOA,CAPUd,EASlBmB,IATkBnB,CASb,GATaA,CAFwC;QAAA,IAavDoB,IAAQ,IAAIC,MAAJ,CAAWP,CAAX,EAAyB,GAAzB,CAb+C;QAc7D,SAASF,EAAuBU,KAAvBV,CAA6BQ,CAA7BR,CAAT;MAAsCQ,CApDZ,IAAfrB,CDPN;;MCyBP,SAASG,CAAT,CAAiBF,CAAjB,EAA+BjB,CAA/B,EAA+BA;QAM7B,OAAO5E,EAAqB6F,CAArB7F,EAAmCoG,IAAnCpG,CALY,UAACqG,CAAD,EAACA;UAClB,UAAiCA,CAAjC;UAAA,IAAOC,IAAP/J;UAAA,IAAmBgK,IAAnBhK;UACA,OAAOqI,KAAgB0B,CAAhB1B,IAA8BA,KAAgB2B,CAArD;QAAqDA,CAGhDvG,CAAP;MAgCF;;MAAA,IAAMoH,IAAoB,qBAA1B;MAAA,IACMC,IAAkB,m/DADxB;;MAGA,SAASR,CAAT,CAAsBnK,CAAtB,EAAsBA;QACpB,OAAOA,EAAM4K,OAAN5K,CAAc0K,CAAd1K,EAAiC,MAAjCA,CAAP;MAGF;;MAAA,SAASgK,CAAT,CAAmBzD,CAAnB,EAAyBuD,CAAzB,EAAyBA;QACvB,IAAIe,IAAiB,KAAKtE,CAA1B;QAMA,OAJKuD,EAAOgB,aAAPhB,KAAsBe,IAAiBA,EAAeE,iBAAfF,EAAvCf,GACAA,EAAOkB,qBAAPlB,KACHe,IAAiBA,EAAeb,SAAfa,CAAyB,KAAzBA,EAAgCD,OAAhCC,CAAwCF,CAAxCE,EAAyD,EAAzDA,CADdf,CADAA,EAIEe,CAAP;;;;;;;;;;;;;;;;;;;;;;;;;;;MC9EK;;MAAA,IAAMI,IAAuB;QAAyB,IAAxBC,IAAwB3I,iEAAd,EAAc;QAAA,IAAV4I,IAAU5I;QAAA,IACrD6I,IAAc,EADuC;QAa3D,OAXAhM,OAAO4H,OAAP5H,CAAe8L,CAAf9L,EAAwB4I,OAAxB5I,CAAgC;UAAsB;UAAA,IAApBiM,IAAoB3M;UAAA,IAAZ8J,IAAY9J;UAAA,IAC9C4M,IAAa,EADiC;UAEpDlM,OAAOmM,IAAPnM,CAAYoJ,CAAZpJ,EACGoJ,MADHpJ,CACU,UAACoM,CAAD,EAACA;YAAD,OAAchD,EAAOgD,CAAPhD,EAAiB2C,KAAjB3C,KAA2B2C,CAAzC;UAAyCA,CADnD/L,EAEG4I,OAFH5I,CAEW,UAACoM,CAAD,EAACA;YAAD,OAAeF,EAAWE,CAAXF,UAA4B9C,EAAOgD,CAAPhD,CAA5B,CAAf;UAAkDgD,CAF7DpM,GAIIA,OAAOmM,IAAPnM,CAAYkM,CAAZlM,EAAwB2D,MAAxB3D,KACFgM,EAAYC,CAAZD,IAAsBE,CADpBlM,CAJJA;QAKwBkM,CAP1BlM,GAWOgM,CAAP;MAAOA,CAbF;MAAA,IAgBMK,IAAe;QAAkB,IAAjBP,IAAiB3I,iEAAP,EAAO;QAAA,IACtCmJ,IAAS,EAD6B;QA+B5C,OA5BAtM,OAAO4H,OAAP5H,CAAe8L,CAAf9L,EAAwB4I,OAAxB5I,CAAgC;UAAsB;UAAA,IAApBiM,IAAoBxL;UAAA,IAAZ2I,IAAY3I;UACpDT,OAAO4H,OAAP5H,CAAeoJ,CAAfpJ,EAAuB4I,OAAvB5I,CAA+B;YAAwB;YAAA,IAAtBoM,IAAsB3L;YAAA,IAAZiK,IAAYjK;;YACrD,QAAQ2L,CAAR;cACE,KAAK5C,EAAYC,EAAjB;gBACE6C,EAAOxF,IAAPwF,WACKL,CADL,cACeG,CADf,cAC2B1B,EAAOvG,MAAPuG,CACtBtG,GADsBsG,CAClB,UAAC6B,CAAD,EAACA;kBAAD,OAAQnC,SAASmC,CAATnC,IAAcmC,CAAdnC,cAAsBmC,CAAtB,MAAR;gBAAQ,CADU7B,EAEtBQ,IAFsBR,CAEjB,GAFiBA,CAD3B;gBAKA;;cACF,KAAKlB,EAAYE,OAAjB;gBACE4C,EAAOxF,IAAPwF,YACM5B,EAAOvG,MAAPuG,CACDtG,GADCsG,CAEA;kBAAA;kBAAA,IAAE8B,IAAF3E;kBAAA,IAAQ4E,IAAR5E;kBAAA,iBACK2E,IAAO,GAAHnE,MAAG,CAAG4D,CAAH,EAAH,MAAG,EAAH5D,MAAG,CAAgBmE,CAAhB,CAAPA,GAAI,EADT,cAEIA,KAAQC,CAARD,GAAgB,OAAhBA,GAA0B,EAF9B,cAGMC,IAAQ,GAAHpE,MAAG,CAAG4D,CAAH,EAAH,KAAG,EAAH5D,MAAG,CAAeoE,CAAf,CAARA,GAAK,EAHX;gBAGW,CALX/B,EAODQ,IAPCR,CAOI,QAPJA,CADN;gBAUA;;cACF;gBACE,MAAM,IAAIL,KAAJ,4CAA8C+B,CAA9C,EAAN;YArBJ;UAqBwDA,CAtB1DpM;QAsB0DoM,CAvB5DpM,GA4BOsM,EAAO3I,MAAP2I,oBAA0BA,EAAOpB,IAAPoB,CAAY,SAAZA,CAA1B,SAAsD,EAA7D;MAA6D,CA/CxD;;MCyBA,SAASI,CAAT;QAAgE,UAAlCZ,OAAkC;QAAA,IAAlCA,SAAkC,CAAlCA,KAAkCjE,CAAlCiE,GAAU,EAAVA,GAAkCjE;QAAA,UAApB8E,IAAoB;QAAA,IAApBA,SAAoB,CAApBA,KAAoBrN,CAApBqN,GAAO,SAAPA,GAAoBrN;QAAA,IAC/DsN,IAAU5M,OAAOmM,IAAPnM,CAAY8L,CAAZ9L,CADqD;QAGrE,OAAK4M,EAAQjJ,MAARiJ,GAIE,UAAC/D,CAAD,EAACA;UACN,IAAMgE,IAAIhE,EAAQiE,UAARjE,IAAsBA,CAAhC;UAAA,IACMkE,IAlCV,UAAsBH,CAAtB,EAA+Bd,CAA/B,EAAwCjD,CAAxC,EAAwCA;YACtC,OAAO+D,EAAQI,KAARJ,CAAc,UAACX,CAAD,EAACA;cACpB,IAAMgB,IAAgBnB,EAAQG,CAARH,CAAtB;cAAA,IACMoB,IAAoBlN,OAAOmM,IAAPnM,CAAYiN,CAAZjN,CAD1B;cAGA,UAAK6I,CAAL,IAAoC,SAApBA,EAAQoD,CAARpD,CAAhB,IAAwBoD,KAAwC7M,CAAxC6M,KAAoBpD,EAAQoD,CAARpD,CAA5C,KAIOqE,EAAkBF,KAAlBE,CAAwB,UAAC9D,CAAD,EAACA;gBAC9B,IAAM+D,IAAiBrD,EAAgBV,CAAhBU,CAAvB;gBAEA,KAAKqD,CAAL,EACE,MAAM,IAAI9C,KAAJ,YAAcjB,CAAd,kCAAN;gBAGF,OAAO+D,EACLF,EAAc7D,CAAd6D,EAAsB9I,MADjBgJ,EAELtE,EAAQoD,CAARpD,CAFKsE,EAGLF,EAAc7D,CAAd6D,EAAsBvC,MAHjByC,CAAP;cAGwBzC,CAVnBwC,CAJP;YAc0BxC,CAlBrBkC,CAAP;UAiC8BQ,CAlChC,CAkC6CR,CAlC7C,EAkCsDd,CAlCtD,EAkC+De,CAlC/D,CAiCI;;UAGA,OAAgB,aAATF,CAAS,GAAWrI,OAAOyI,CAAPzI,CAAX,GAAyCyI,CAAzD;QAAyDA,CARtDH,GACI;UAAA,OAAgB,aAATD,CAAS,IAAW,CAA3B;QAA2B,CADpC;MAaK;;MAAA,SAASU,CAAT,CAAsBpF,CAAtB,EAAgC6D,CAAhC,EAAgCA;QACrC,OAAO9L,OAAOmM,IAAPnM,CAAY8L,CAAZ9L,EAAqB2D,MAArB3D,GACHiI,EAASmB,MAATnB,CAAgByE,EAAmB;UAAEZ;QAAF,CAAnBY,CAAhBzE,CADGjI,GAEHiI,CAFJ;MC5CK;;MAAA,MAAMqF,IAAgC,QAAtC;MAAA,MAsBMC,KAdQ,WAAWlF,MAAX,CAAkBiF,CAAlB,EAAiD,uBAAjD,GACA,uBAAuBjF,MAAvB,CAR0B,UAQ1B,EAA+D,kBAA/D,EAAmFA,MAAnF,CAA0FiF,CAA1F,CADA,EAed,KADMC,CAtBN;MA2BA,IAAIC,CAAJ;MAAIA,CAEX,UAAWA,CAAX,EAAWA;QACTA,EAAwBlJ,MAAxBkJ,GAA4B,QAA5BA,EACAA,EAAwBC,MAAxBD,GAA4B,QAD5BA,EAEAA,EAAwBE,MAAxBF,GAA4B,QAF5BA,EAGAA,EAA0BG,QAA1BH,GAA8B,UAH9BA,EAIAA,EAA2BI,SAA3BJ,GAA+B,WAJ/BA,EAKAA,EAAwBxN,MAAxBwN,GAA4B,QAL5BA,EAMAA,EAAyBK,OAAzBL,GAA6B,SAN7BA,EAOAA,EAAyBM,OAAzBN,GAA6B,SAP7BA,EAQAA,EAAyBO,OAAzBP,GAA6B,SAR7BA;MADF,EAUGA,MAAoBA,IAAkB,EAAtCA,CAVH,CAFWA;;;;;;;;;;MC3BI,SAASQ,CAAT,CAAgBC,CAAhB,EAA2BC,CAA3B,EAA2BA;QACxC,KAAKD,CAAL,EACE,MAAM,IAAI5D,KAAJ,CAAU6D,KAAW,0CAArB,CAAN;MCsBgBnK;;MAAAA,KAAKoK,IAALpK;MCnBpB,MAAMqK,IAAKrK,KAAKqK,EAAhB;MAAA,MACMC,IAAOD,IAAK,CADlB;MAAA,MAEME,IAAqBF,IAAK,GAFhC;;;;;;;;;;;;;;;;;;;;;;;;;;MCKe;;MAAA,SAASG,EAAT,CAA+BC,CAA/B,EAAyCC,CAAzC,EAAyCA;QACtD,IAEMC,IAAgB,CAFXC,GAAY,CAACF,EAAKG,IAAN,EAAYH,EAAKI,KAAjB,CAAZF,CAEW,EADXA,GAAY,CAACF,EAAKK,IAAN,EAAYL,EAAKM,KAAjB,CAAZJ,CACW,CAFtB;QAAA,IAIMK,IAAcC,GAAyBT,EAAS7B,IAAlCsC,CAJpB;QAKA,KAAKD,CAAL,EACE,MAAM,IAAI3E,KAAJ,sCAAwCmE,EAAS7B,IAAjD,EAAN;QAGF,iBACK6B,CADL;UAEEU,aAAaF,EAAYR,EAASU,WAArBF,EAAkCN,CAAlCM;QAFf;MCjByBjL;;MAAAA,KAAKqK,EAALrK;MDuB3B,IAAMkL,KAA2B;QAC/BE,SAD+B;QAE/BC,YAkBF,UAAoBC,CAApB,EAAgCZ,CAAhC,EAAgCA;UAC9B,OAAOa,GAAUD,CAAVC,EAAsBb,CAAtBa,CAAP;QAA6Bb,CArBE;QAG/Bc,cAH+B;QAI/BC,iBAwBF,UAAyBC,CAAzB,EAA0ChB,CAA1C,EAA0CA;UACxC,OAAOgB,EAAgBrL,GAAhBqL,CAAoB,UAACC,CAAD,EAACA;YAAD,OAAgBH,GAAWG,CAAXH,EAAuBd,CAAvBc,CAAhB;UAAuCd,CAA3DgB,CAAP;QAAkEhB,CA7BnC;QAK/BkB,WAL+B;QAM/BC,cA8BF,UAAsBC,CAAtB,EAAoCpB,CAApC,EAAoCA;UAClC,OAAOoB,EAAazL,GAAbyL,CAAiB,UAACC,CAAD,EAACA;YAAD,OAAaH,GAAQG,CAARH,EAAiBlB,CAAjBkB,CAAb;UAA8BlB,CAA/CoB,CAAP;QAAsDpB;MArCvB,CAAjC;;MASA,SAASU,EAAT;QAA2C;QAAA,IAA3BY,IAA2BtP;QAAA,IAAnBuP,IAAmBvP;QAAA;QAAA,IAATwP,IAASlQ;QAAA,IAALmQ,IAAKnQ;QAIzC,OAAO,CAHGoQ,GAAYF,EAAG,CAAHA,CAAZE,EAAmBD,EAAG,CAAHA,CAAnBC,EAA0BJ,CAA1BI,CAGH,EAFGA,GAAYF,EAAG,CAAHA,CAAZE,EAAmBD,EAAG,CAAHA,CAAnBC,EAA0BH,CAA1BG,CAEH,CAAP;MAGF;;MAAA,SAASb,EAAT,CAAmBd,CAAnB,EAA6BC,CAA7B,EAA6BA;QAC3B,OAAOD,EAASpK,GAAToK,CAAa,UAAC4B,CAAD,EAACA;UAAD,OAAOjB,GAAMR,GAAYyB,CAAZzB,CAANQ,EAAsBV,CAAtBU,CAAP;QAA6BV,CAA1CD,CAAP;MAOF;;MAAA,SAASe,EAAT,CAAoBc,CAApB,EAA0B5B,CAA1B,EAA0BA;QACxB,OAAOa,GAAUe,CAAVf,EAAgBb,CAAhBa,CAAP;MAOF;;MAAA,SAASK,EAAT,CAAiBG,CAAjB,EAA0BrB,CAA1B,EAA0BA;QACxB,OAAOqB,EAAQ1L,GAAR0L,CAAY,UAACQ,CAAD,EAACA;UAAD,OAAiBhB,GAAUgB,CAAVhB,EAAuBb,CAAvBa,CAAjB;QAAwCb,CAApDqB,CAAP;MAOF;;MAAA,SAASnB,EAAT,CAAqB4B,CAArB,EAAqBA;QACnB,ODhDK,gBAA6BC;UAAAA,IAA7B,CAAwBC,CAAxB,EAA6BD,CAA7B,CAA6BA;UAClCxC,EAAO1J,OAAO8F,QAAP9F,CAAgBmM,CAAhBnM,CAAP,GACA0J,EAAO1J,OAAO8F,QAAP9F,CAAgBkM,CAAhBlM,KAAwBkM,MAAQ,EAAhClM,IAAsCkM,KAAO,EAApD,EAAwD,kBAAxD,CADA;UAEA,MACME,IAAOF,IAAMlC,CADnB;UAIA,OAAO,CAjBS,OAaAmC,IAAMnC,CAANmC,GAEiBrC,CAfjB,KAewB,IAAIA,CAf5B,CAiBT,EAjBS,OAgBOA,IAAKrK,KAAK4M,GAAL5M,CAASA,KAAK6M,GAAL7M,CAASsK,IAAc,KAAPqC,CAAhB3M,CAATA,CAhBZ,KAgBsD,IAAIqK,CAhB1D,CAiBT,CAAP;QCyCOyC,CDhDF,CCgDgBN,CDhDhB,CCgDL;MAGF;;MAAA,SAASJ,EAAT,CAAqBvQ,CAArB,EAAwBqF,CAAxB,EAA2B6L,CAA3B,EAA2BA;QACzB,QAAQA,IAAIlR,CAAZ,KAAkBqF,IAAIrF,CAAtB;;;;;;;;;MEhEF;;MAAA,IAAMmR,KAAiB/Q,OAAO0E,MAAP1E,CAAc;QACnCmP,OAAO,CAD4B;QAEnCI,YAAY,CAFuB;QAGnCI,SAAS;MAH0B,CAAd3P,CAAvB;;MAgCA,SAASgR,EAAT,CAAoB7J,CAApB,EAAoBA;QAElB,QADgBA,EAAK8J,uBAAL9J,IAAgCA,EAAK+J,WAArC/J,IAAoDA,EAAKgK,YACzE,EAAevQ,KAAf;MAOF;;MAAA,SAASwQ,EAAT,CAA+BjK,CAA/B,EAAqCkK,CAArC,EAAqCA;QACnC,IAAMC,IALR,UAAsBnK,CAAtB,EAA4BkK,CAA5B,EAA4BA;UAC1B,OAAOlK,EAAKoK,UAALpK,CAAgBvG,KAAhBuG,CAAsBkK,CAAtBlK,CAAP;QAIkBqK,CALpB,CAKiCrK,CALjC,EAKuCkK,CALvC,CAKE;QAAA,IACQvE,IAA6B3F,EAA7B2F,UADR;QAAA,IACoB2E,IAAiBtK,EAAjBsK,YADpB;QAAA,IAEMnF,IAAS;UACbQ,YAAYA,EAAWwE,CAAXxE,CADC;UAEb2E,cAAc;QAFD,CAFf;;QAOA,KAAK,IAAM3R,CAAX,IAAkB2R,CAAlB,EACEnF,EAAOmF,YAAPnF,CAAoBxM,CAApBwM,IAA2BmF,EAAa3R,CAAb2R,EAAkB7Q,KAAlB6Q,CAAwBJ,CAAxBI,CAA3BnF;;QAGF,OAAOA,CAAP;MAGF;;MAAA,SAASoF,EAAT,CAAyBC,CAAzB,EAAyBA;QACvB,IAAQ7E,IAA6B6E,EAA7B7E,UAAR;QAAA,IAAoB2E,IAAiBE,EAAjBF,YAApB;QACA,OAAOzR,OAAO4R,MAAP5R,CAAc,EAAdA,EAAkB8M,CAAlB9M,EAA8ByR,CAA9BzR,CAAP;MAGF;;MAAA,SAAS6R,EAAT,CAAgCF,CAAhC,EAA2CG,CAA3C,EAA6D1N,CAA7D,EAA6DA;QAC3D,IAAI0N,CAAJ,EACE,OAAOC,GAAsBJ,CAAtBI,EAAiCD,CAAjCC,CAAP;QAGF,IAAMC,IAAe5N,EAAI6N,IAAJ7N,GAAW,CAAhC;QACA,OACE2N,GAAsBJ,CAAtBI,EAAiC,YAAjCA,KACAA,GAAsBJ,CAAtBI,EAAiC,OAAjCA,CADAA,IAEAC,CAHF;MAOF;;MAAA,SAASD,EAAT,CAA+BJ,CAA/B,EAA0CO,CAA1C,EAA0CA;QACxC,IAAQpF,IAA6B6E,EAA7B7E,UAAR;QACA,OADqC6E,EAAjBF,YAAiBE,CACjBO,CADiBP,KACA7E,EAAWoF,CAAXpF,CAArC;MAGF;;MAAA,SAASqF,EAAT,CAA0BjD,CAA1B,EAAuCvC,CAAvC,EAAuCA;QACrC,QAAQA,CAAR;UACE,KAAKoE,GAAcpB,OAAnB;YACE,OAAO;cAAEhD,MAAM,SAAR;cAAmBuC,aAAa,CAACA,CAAD;YAAhC,CAAP;;UACF,KAAK6B,GAAcxB,UAAnB;YACE,OAAO;cAAE5C,MAAM,YAAR;cAAsBuC;YAAtB,CAAP;;UACF,KAAK6B,GAAc5B,KAAnB;YACE,OAAO;cAAExC,MAAM,OAAR;cAAiBuC,aAAaA,EAAY,CAAZA;YAA9B,CAAP;;UACF;YACE,MAAM,IAAI7E,KAAJ,CAAU,uBAAV,CAAN;QARJ;MAYF;;MAAA,SAAS+H,EAAT,CAA+Bf,CAA/B,EAA2CgB,CAA3C,EAAqDC,CAArD,EAAqDA;QAGnD,KAFA,IAAMC,IAAkB,EAAxB,EAESC,IAAInB,CAAb,EAAyBmB,IAAIH,CAA7B,EAAuCG,GAAvC,EACED,EAAgBzL,IAAhByL,CACE5M,MAAMO,IAANP,CAAW2M,EAAU1R,KAAV0R,CAAgBG,QAAhBH,CAAyBE,IAAIF,EAAUL,IAAvCK,EAAuCL,CAAOO,IAAI,CAAXP,IAAgBK,EAAUL,IAAjEK,CAAX3M,CADF4M;;QAKF,OAAOA,CAAP;MAGF;;MAAA,SAASG,EAAT;QAOG,IANDtO,IAMC1E,EAND0E,GAMC;QAAA,IALDuO,IAKCjT,EALDiT,kBAKC;QAAA,IAJDC,IAIClT,EAJDkT,oBAIC;QAAA,IAHDzL,IAGCzH,EAHDyH,IAGC;QAAA,IAFDwF,IAECjN,EAFDiN,IAEC;QAAA,IADDmF,IACCpS,EADDoS,gBACC;QACI3K,eAAM2F,UAAN3F,CAAiBxD,MAAjBwD,KAIDwL,IAaN;UAGE,KAH6D,IAA/BvO,IAA+B1E,EAA/B0E,GAA+B,EAA1B+C,IAA0BzH,EAA1ByH,IAA0B,EAApB2K,IAAoBpS,EAApBoS,gBAAoB,EACvDe,IAAU7B,GAAW7J,CAAX6J,CAD6C,EAGpD9N,IAAI,CAAb,EAAgBA,IAAI2P,EAAQlP,MAARkP,GAAiB,CAArC,EAAwC3P,GAAxC,EAA6C;YAC3C,IAEMyO,IAAYP,GAAsBjK,CAAtBiK,EAFCyB,EAAQ3P,CAAR2P,CAEDzB,CAFlB;YAAA,IAGM0B,IAAsBjB,GAAuBF,CAAvBE,EAAkCC,CAAlCD,EAAoDzN,CAApDyN,CAH5B;YAKIiB,MAAwB1O,EAAI2O,GAAJ3O,CAAQ0O,CAAR1O,CAAxB0O,IACF1O,EAAI4O,GAAJ5O,CAAQ0O,CAAR1O,EAA6BsN,GAAgBC,CAAhBD,CAA7BtN,CADE0O;UAC2CnB;QAtB/CsB,CAYJ,CAZyB;UAAE7O,MAAF;UAAO+C,OAAP;UAAa2K;QAAb,CAYzB,CAbMa,GA9GN;UAUE,KAJC,IALDvO,IAKC1E,EALD0E,GAKC,EAJD+C,IAICzH,EAJDyH,IAIC,EAHDyL,IAGClT,EAHDkT,oBAGC,EAFDjG,IAECjN,EAFDiN,IAEC,EADDmF,IACCpS,EADDoS,gBACC,EACKe,IAAU7B,GAAW7J,CAAX6J,CADf,EAEOsB,IAAcnL,EAAdmL,SAFP,EAIQpP,IAAI,CAAb,EAAgBA,IAAI2P,EAAQlP,MAARkP,GAAiB,CAArC,EAAwC3P,GAAxC,EAA6C;YAC3C,IAAMmO,IAAawB,EAAQ3P,CAAR2P,CAAnB;YAAA,IACMR,IAAWQ,EAAQ3P,IAAI,CAAZ2P,CADjB;YAAA,IAGMlB,IAAYP,GAAsBjK,CAAtBiK,EAA4BC,CAA5BD,CAHlB;YAAA,IAIM0B,IAAsBjB,GAAuBF,CAAvBE,EAAkCC,CAAlCD,EAAoDzN,CAApDyN,CAJ5B;;YAMA,IAAIiB,MAAwB1O,EAAI2O,GAAJ3O,CAAQ0O,CAAR1O,CAA5B,EAA0D;cACxD,IAAMmO,IAAkBH,GAAsBf,CAAtBe,EAAkCC,CAAlCD,EAA4CE,CAA5CF,CAAxB;cACIc,IAAWf,GAAiBI,CAAjBJ,EAAkCxF,CAAlCwF,CAAXe,EAAoDN,CAApDM,KACF9O,EAAI4O,GAAJ5O,CAAQ0O,CAAR1O,EAA6BsN,GAAgBC,CAAhBD,CAA7BtN,CADE8O;YAC2CvB;UAAAA;QA6FjDwB,CAjHJ,CAiHiC;UAC3B/O,MAD2B;UAE3B+C,OAF2B;UAG3ByL,uBAH2B;UAI3BjG,OAJ2B;UAK3BmF;QAL2B,CAjHjC,CA0GO3K;MA4CA;;MAAA,SAASiM,EAAT,CAAgCC,CAAhC,EAA0C7E,CAA1C,EAA0CA;QAC/C,OAAOA,IAAW8E,IAAUC,IAAYF,CAAZE,CAAVD,EAAiC9E,CAAjC8E,CAAX9E,GAAwD+E,IAAYF,CAAZE,CAA/D;MAGK;;MAAA,SAASC,EAAT;QAMJ,IALDC,IAKC/T,EALD+T,KAKC;QAAA,IAJDJ,IAIC3T,EAJD2T,QAIC;QAAA,IAHD7E,IAGC9O,EAHD8O,QAGC;QAAA,IAFDsD,IAECpS,EAFDoS,gBAEC;QAAA,IADD4B,IACChU,EADDgU,UACC;QAAA,IACKtP,IAAM,IAAIuP,GAAJ,EADX;QAAA,IAEKC,IAAsBR,GAAuBC,CAAvBD,EAAiC5E,CAAjC4E,CAF3B;QAID,KAAKQ,CAAL,EACE,OAAO,EAAP;;QALD;QAAA,IAtB6BzM,CAsB7B;QAAA,IArBKoK,CAqBL;QAAA,IApBKsC,CAoBL;QAAA,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAAA,C,CAQkBJ,C,CARlB;;QAAA;UAQD,gCAA0B;YAAA,IAAfK,IAAeC;;YAGxB,KAAuB,CAAvB,KAAID,EAAKE,SAAT,IAAiCF,EAAK3M,IAAtC;cAIA,IAAQsH,IAASqF,EAATrF,IAAR;cAAA,IACMwF,IAAaV,IAAY,CAAC9E,EAAKG,IAAN,EAAYH,EAAKM,KAAjB,EAAwBN,EAAKK,IAA7B,EAAmCL,EAAKI,KAAxC,CAAZ0E,CADnB;cAAA,IAEMZ,IAAqBuB,IAAcD,CAAdC,EAA0BN,CAA1BM,CAF3B;cAAA,IAIMC,IAA6Bb,IAAUW,CAAVX,EAAsBM,CAAtBN,CAJnC;;cAMA,IAAKa,CAAL;gBAKA,IAAMC,IAAgC;kBACpCzH,MAAM,SAD8B;kBAEpC6B,UACEkF,MAAenG,CAAfmG,GACInF,GAAsB4F,EAA2B3F,QAAjDD,EAA2DE,CAA3DF,CADJmF,GAEIS,EAA2B3F;gBALG,CAAtC;gBAhD4BrH,IAwDL2M,EAAK3M,IAAL2M,CAAUO,MAxDLlN,EACxBoK,UADwBpK,EACxBoK,KACAsC,CAFwB1M,EAExB0M,KADAtC,IAAapK,EAAKoK,UAALpK,CAAgBvG,KAC7BiT,EAA2BtC,EAAW5N,MAAX4N,GAAoB,CAA/CsC,CAFwB1M,EAI9BA,EAAKgK,YAALhK,GAAoB;kBAClBvG,OAAO,IAAI2Q,EAAWtL,WAAf,CAA2BsL,EAAW5N,MAAX4N,GAAoB,CAA/C,CADW;kBAElBU,MAAM;gBAFY,CAJU9K,EAQ9BA,EAAKgK,YAALhK,CAAkBvG,KAAlBuG,CAAwB6L,GAAxB7L,CAA4BoK,CAA5BpK,CAR8BA,EAS9BA,EAAKgK,YAALhK,CAAkBvG,KAAlBuG,CAAwB6L,GAAxB7L,CAA4B,CAAC0M,IAAgB,CAAjB,CAA5B1M,EAAiDoK,EAAW5N,MAA5DwD,CAT8BA,EA0D5BuL,GAAkB;kBAChBtO,MADgB;kBAEhBuO,qBAFgB;kBAGhBC,sBAAsBwB,CAHN;kBAIhBjN,MAAM2M,EAAK3M,IAAL2M,CAAUO,MAJA;kBAKhB1H,MAAMoE,GAAc5B,KALJ;kBAMhB2C;gBANgB,CAAlBY,CA1D4BvL,EAkE5BuL,GAAkB;kBAChBtO,MADgB;kBAEhBuO,qBAFgB;kBAGhBC,sBAAsBwB,CAHN;kBAIhBjN,MAAM2M,EAAK3M,IAAL2M,CAAUQ,KAJA;kBAKhB3H,MAAMoE,GAAcxB,UALJ;kBAMhBuC;gBANgB,CAAlBY,CAlE4BvL,EA0E5BuL,GAAkB;kBAChBtO,MADgB;kBAEhBuO,qBAFgB;kBAGhBC,sBAAsBwB,CAHN;kBAIhBjN,MAAM2M,EAAK3M,IAAL2M,CAAUS,QAJA;kBAKhB5H,MAAMoE,GAAcpB,OALJ;kBAMhBmC;gBANgB,CAAlBY,CA1E4BvL;cAgF1B2K;YAAAA;UAAAA;QA1DH;UAAA0C;QAAA;UAAAA;QA6DD;;QAAA,OAAO7O,MAAMO,IAANP,CAAWvB,EAAID,MAAJC,EAAXuB,CAAP;;;;;;;;;MCvOK;;MAAA,SAAS8O,EAAT;QAA4E,IAAjDC,IAAiDhV,EAAjDgV,OAAiD;QAAA,IAAxCrB,IAAwC3T,EAAxC2T,QAAwC;QAAA,IAA9B7E,IAA8B9O,EAA9B8O,QAA8B;QAAA,IAApBsD,IAAoBpS,EAApBoS,gBAAoB;QAAA,IAC7E6C,IAAY,CADiE;QAAA,IAG3EvQ,IAAM,IAAIuP,GAAJ,EAHqE;QAAA,IAI3EC,IAAsBR,GAAuBC,CAAvBD,EAAiC5E,CAAjC4E,CAJqD;QAMjF,KAAKQ,CAAL,EACE,OAAO,EAAP;;QAP+E;QAAA,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAAA,C,CAU3Dc,EAAQzM,Q,CAVmD;;QAAA;UAUjF,gCAAwC;YAAA,IAA7BY,IAA6BkL;YAAA,IAChCa,IAAW9C,IACbjJ,EAAQiE,UAARjE,CAAmBiJ,CAAnBjJ,CADaiJ,GACMA,EACjB6C,CAHgC;YAGhCA,CACDvQ,EAAI2O,GAAJ3O,CAAQwQ,CAARxQ,CADCuQ,IACoBzB,IAAWU,CAAXV,EAAgCrK,CAAhCqK,CADpByB,IAEJvQ,EAAI4O,GAAJ5O,CAAQwQ,CAARxQ,EAAkByE,EAAQiE,UAA1B1I,CAFIuQ;UAEsB7H;QAfmD;UAAAD;QAAA;UAAAA;QAmBjF;;QAAA,OAAOlH,MAAMO,IAANP,CAAWvB,EAAID,MAAJC,EAAXuB,CAAP;MCjBK;;MAAA,I,EAAA;MAAA,IAAMkP,KAAiB7U,OAAO0E,MAAP1E,CAAc;QAE1C8U,OAAO,OAFmC;QAK1CC,QAAQ,QALkC;QAQ1CC,OAAO,OARmC;QAW1CC,MAAM,MAXoC;QAc1CC,OAAO,OAdmC;QAiB1CC,SAAS;MAjBiC,CAAdnV,CAAvB;MAAA,ICDDoV,MAAoB1V,WAEvBmV,GAAeC,KAFQ,EAEA,UAAC7S,CAAD,EAACA;QAAD,OAAUE,KAAKM,GAALN,CAASF,EAAKS,cAALT,EAATE,CAAV;MAAwBO,CAFxB,SAGvBmS,GAAeE,MAHQ,EAGC,UAAC9S,CAAD,EAACA;QAAD,OAAUE,KAAKM,GAALN,CAASF,EAAKS,cAALT,EAATE,EAAgCF,EAAKU,WAALV,EAAhCE,CAAV;MAA+CQ,CAHhD,SAIvBkS,GAAeG,KAJQ,EAIA,UAAC/S,CAAD,EAACA;QAAD,OAAUD,EAAUC,CAAVD,CAAV;MAAoBC,CAJpB,SAKvB4S,GAAeI,IALQ,EAKD,UAAChT,CAAD,EAACA;QAAD,OACrBE,KAAKM,GAALN,CAASF,EAAKS,cAALT,EAATE,EAAgCF,EAAKU,WAALV,EAAhCE,EAAoDF,EAAKW,UAALX,EAApDE,CADqB;MACoCS,CANnC,SAOvBiS,GAAeK,KAPQ,EAOA,UAACjT,CAAD,EAACA;QAAD,OACtBE,KAAKM,GAALN,CACEF,EAAKS,cAALT,EADFE,EAEEF,EAAKU,WAALV,EAFFE,EAGEF,EAAKW,UAALX,EAHFE,EAIEF,EAAKoT,WAALpT,EAJFE,CADsB;MAKfkT,CAZe,SAcvBR,GAAeM,OAdQ,EAcE,UAAClT,CAAD,EAACA;QAAD,OACxBE,KAAKM,GAALN,CACEF,EAAKS,cAALT,EADFE,EAEEF,EAAKU,WAALV,EAFFE,EAGEF,EAAKW,UAALX,EAHFE,EAIEF,EAAKoT,WAALpT,EAJFE,EAKEF,EAAKqT,aAALrT,EALFE,CADwB;MAMjBmT,CApBe,KAApBF,CDCC;;MCuBA,SAASG,EAAT,CACLpO,CADK,EAELC,CAFK,EAGLC,CAHK,EAILmO,CAJK,EAKLlO,CALK,EAKLA;QAEA,IAAI3B,MAAMS,OAANT,CAAcwB,CAAdxB,KAAuC,MAAhBwB,EAAKxD,MAAhC,EACE,OAAO,IAAP;QAGF,IAAM8R,IAAaL,GAAqBI,CAArBJ,CAAnB;QAEA,KAAKK,CAAL,EACE,OAAO,IAAP;QAGF,IAAMlO,IAASJ,EAAKjC,MAALiC,CAAY,UAACuO,CAAD,EAAMjO,CAAN,EAAMA;UAC/B,IAAM7G,IAAQ6G,EAAKJ,CAALI,CAAd;UAAA,IACMkO,IAAiB,IAAIxT,IAAJ,CAASvB,CAAT,CADvB;UAAA,IAEMgV,IAAWH,EAAWE,CAAXF,CAFjB;;UAIA,KAAKI,MAAMD,CAANC,CAAL,EAAsB;YACpB,IAAIC,IAAgBJ,EAAIvV,GAAJuV,CAAQE,CAARF,CAApB;YACKI,MACHA,IAAgB,EAAhBA,EACAJ,EAAI1C,GAAJ0C,CAAQE,CAARF,EAAkBI,CAAlBJ,CAFGI,GAKkC,SAAvBrO,EAAKL,CAALK,CAAuB,IAAlBL,KAAiDhI,CAAjDgI,KAA0BK,EAAKL,CAALK,CAAR,KAGrCqO,EAAchP,IAAdgP,CAAmBrO,EAAKL,CAALK,CAAnBqO,GACAJ,EAAI1C,GAAJ0C,CAAQE,CAARF,EAAkBI,CAAlBJ,CAJqC,CALlCI;UAaP;;UAAA,OAAOJ,CAAP;QAAOA,CApBMvO,EAqBZ,IAAIwM,GAAJ,EArBYxM,CAAf;QAAA,IAuBMQ,IAAkBxC,EAAqBmC,CAArBnC,CAvBxB;QAyBA,OAAIwC,IACKW,EAAIf,EAAOK,OAAPL,EAAJ,EACJnD,GADI,CACA;UAAA;UAAA,IAAEtC,IAAF+F;UAAA,IAAQjH,IAARiH;UAAA,OAAoB;YACvB/F,OADuB;YAEvBlB,OAAO+G,EAAgB/G,CAAhB+G;UAFgB,CAApB;QAEoB/G,CAHpB,EAKJmV,IALI,CAKC,UAACnW,CAAD,EAAIqF,CAAJ,EAAIA;UAAJ,OAAUrF,EAAEkC,IAAFlC,GAASqF,EAAEnD,IAArB;QAAqBA,CALtB,CADL6F,GASG,EATP;MCrEK;;MAAA,IAAMqO,KAA0BhW,OAAO0E,MAAP1E,CAAc;QACnDiW,SAAS,iBAD0C;QAEnDC,WAAW,mBAFwC;QAGnDC,QAAQ,0BAH2C;QAInDC,YAAY;MAJuC,CAAdpW,CAAhC;MAAA,IAOMqW,KAAarW,OAAO0E,MAAP1E,CAAc;QACtCsW,MAAM;MADgC,CAAdtW,CAPnB;MAAA,IAWMuW,KAAU,wBAXhB;IAWgB,C;M7CFvB;CAVA","names":["root","factory","exports","module","require","define","amd","cartoReactCore","self","__WEBPACK_EXTERNAL_MODULE__855__","__WEBPACK_EXTERNAL_MODULE__97__","__WEBPACK_EXTERNAL_MODULE__55__","__WEBPACK_EXTERNAL_MODULE__956__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","default","e","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","_defineProperty","configurable","writable","REQUEST_GET_MAX_URL_LENGTH","getRequest","url","opts","Request","method","headers","Accept","postRequest","payload","body","JSON","stringify","encodeParameter","name","encodeURIComponent","getMonday","date","dateCp","Date","day","getDay","diff","getDate","setDate","UTC","getUTCFullYear","getUTCMonth","getUTCDate","debounce","fn","ms","timer","args","i","arguments","clearTimeout","setTimeout","apply","throttle","lastTime","now","randomString","length","text","possible","charAt","Math","floor","random","makeIntervalComplete","values","map","val","Number","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","AggregationTypes","freeze","COUNT","AVG","MIN","MAX","SUM","sum","b","reduce","aggregationFunctions","min","Infinity","max","_arrayLikeToArray","arr","len","arr2","Array","_unsupportedIterableToArray","minLen","F","toString","slice","constructor","from","test","isArray","_i","iterator","_s","_e","_arr","_n","_d","next","done","push","err","return","TypeError","groupValuesByColumn","data","valuesColumn","keysColumn","operation","groups","accumulator","item","group","targetOperation","entries","t","_toConsumableArray","iter","histogram","features","columnName","ticks","binsContainer","concat","A","tick","index","bin","start","end","forEach","feature","featureValue","binContainer","find","scatterPlot","xAxisColumn","yAxisColumn","filter","xIsValid","xValue","yValue","FilterTypes","IN","BETWEEN","CLOSED_OPEN","TIME","STRING_SEARCH","filterFunctions","filterValues","includes","between","featureValueAsTimestamp","getTime","isFinite","Error","some","range","lowerBound","upperBound","params","normalizedFeatureValue","normalize","stringRegExp","filterValue","escapeRegExp","mustStart","mustEnd","join","regex","RegExp","match","specialCharRegExp","normalizeRegExp","replace","normalizedData","caseSensitive","toLocaleLowerCase","keepSpecialCharacters","getApplicableFilters","filters","owner","filtersCopy","column","filterCopy","keys","operator","filtersToSQL","result","v","left","right","buildFeatureFilter","type","columns","f","properties","featurePassesFilter","every","columnFilters","columnFilterTypes","filterFunction","passesFilter","applyFilters","DEFAULT_USER_COMPONENT_IN_URL","TILE_FORMATS","SchemaFieldType","Bigint","String","Geometry","Timestamp","Boolean","Variant","Unknown","K","condition","message","log2","PI","PI_4","DEGREES_TO_RADIANS","transformToTileCoords","geometry","bbox","projectedBbox","projectFlat","west","north","east","south","transformFn","availableTransformations","coordinates","Point","MultiPoint","multiPoint","getPoints","LineString","MultiLineString","multiLineString","lineString","Polygon","MultiPolygon","multiPolygon","polygon","pointX","pointY","nw","se","inverseLerp","g","line","polygonRing","xyz","lat","lng","phi2","log","tan","lngLatToWorld","x","GEOMETRY_TYPES","getIndices","primitivePolygonIndices","pathIndices","pointIndices","getPropertiesFromTile","startIndex","featureId","featureIds","getFeatureId","numericProps","parseProperties","tileProps","assign","getUniquePropertyValue","uniqueIdProperty","getValueFromTileProps","artificialId","size","propertyName","getFeatureByType","getRingCoordinatesFor","endIndex","positions","ringCoordinates","j","subarray","calculateFeatures","tileIsFullyVisible","geometryIntersection","indices","uniquePropertyValue","has","set","addAllFeaturesInTile","intersects","addIntersectedFeaturesInTile","getGeometryToIntersect","viewport","intersect","bboxPolygon","tileFeatures","tiles","tileFormat","Map","geometryToIntersect","lastFeatureId","tile","c","isVisible","bboxToGeom","booleanWithin","clippedGeometryToIntersect","transformedGeomtryToIntersect","points","lines","polygons","D","geojsonFeatures","geojson","uniqueIdx","uniqueId","GroupDateTypes","YEARS","MONTHS","WEEKS","DAYS","HOURS","MINUTES","GROUP_KEY_FN_MAPPING","getUTCHours","getUTCMinutes","groupValuesByDateColumn","groupType","groupKeyFn","acc","formattedValue","groupKey","isNaN","groupedValues","sort","FEATURE_SELECTION_MODES","POLYGON","RECTANGLE","CIRCLE","LASSO_TOOL","EDIT_MODES","EDIT","MASK_ID"],"sourceRoot":"","sources":["webpack://cartoReactCore/webpack/universalModuleDefinition","webpack://cartoReactCore/external umd \"@turf/bbox-polygon\"","webpack://cartoReactCore/external umd \"@turf/boolean-intersects\"","webpack://cartoReactCore/external umd \"@turf/boolean-within\"","webpack://cartoReactCore/external umd \"@turf/intersect\"","webpack://cartoReactCore/webpack/bootstrap","webpack://cartoReactCore/webpack/runtime/compat get default export","webpack://cartoReactCore/webpack/runtime/define property getters","webpack://cartoReactCore/webpack/runtime/hasOwnProperty shorthand","webpack://cartoReactCore/webpack/runtime/make namespace object","webpack://cartoReactCore/../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://cartoReactCore/./src/utils/requestsUtils.js","webpack://cartoReactCore/./src/utils/dateUtils.js","webpack://cartoReactCore/./src/utils/debounce.js","webpack://cartoReactCore/./src/utils/throttle.js","webpack://cartoReactCore/./src/utils/randomString.js","webpack://cartoReactCore/./src/utils/makeIntervalComplete.js","webpack://cartoReactCore/./src/operations/aggregation/AggregationTypes.js","webpack://cartoReactCore/./src/operations/aggregation/values.js","webpack://cartoReactCore/../../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://cartoReactCore/../../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://cartoReactCore/../../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://cartoReactCore/../../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://cartoReactCore/../../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://cartoReactCore/../../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://cartoReactCore/./src/operations/groupby.js","webpack://cartoReactCore/../../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack://cartoReactCore/../../node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack://cartoReactCore/../../node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack://cartoReactCore/../../node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack://cartoReactCore/./src/operations/histogram.js","webpack://cartoReactCore/./src/operations/scatterPlot.js","webpack://cartoReactCore/./src/filters/FilterTypes.js","webpack://cartoReactCore/./src/filters/FilterQueryBuilder.js","webpack://cartoReactCore/./src/filters/Filter.js","webpack://cartoReactCore/../../node_modules/@deck.gl/carto/dist/esm/api/maps-api-common.js","webpack://cartoReactCore/../../node_modules/@math.gl/web-mercator/dist/esm/assert.js","webpack://cartoReactCore/../../node_modules/@math.gl/web-mercator/dist/esm/math-utils.js","webpack://cartoReactCore/../../node_modules/@math.gl/web-mercator/dist/esm/web-mercator-utils.js","webpack://cartoReactCore/./src/utils/transformToTileCoords.js","webpack://cartoReactCore/../../node_modules/@math.gl/web-mercator/dist/esm/get-bounds.js","webpack://cartoReactCore/./src/filters/tileFeatures.js","webpack://cartoReactCore/./src/filters/geojsonFeatures.js","webpack://cartoReactCore/./src/operations/GroupDateTypes.js","webpack://cartoReactCore/./src/operations/groupByDate.js","webpack://cartoReactCore/./src/utils/featureSelectionConstants.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@turf/bbox-polygon\"), require(\"@turf/boolean-intersects\"), require(\"@turf/boolean-within\"), require(\"@turf/intersect\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"@turf/bbox-polygon\", \"@turf/boolean-intersects\", \"@turf/boolean-within\", \"@turf/intersect\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cartoReactCore\"] = factory(require(\"@turf/bbox-polygon\"), require(\"@turf/boolean-intersects\"), require(\"@turf/boolean-within\"), require(\"@turf/intersect\"));\n\telse\n\t\troot[\"cartoReactCore\"] = factory(root[\"@turf/bbox-polygon\"], root[\"@turf/boolean-intersects\"], root[\"@turf/boolean-within\"], root[\"@turf/intersect\"]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE__855__, __WEBPACK_EXTERNAL_MODULE__97__, __WEBPACK_EXTERNAL_MODULE__55__, __WEBPACK_EXTERNAL_MODULE__956__) {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__855__;","module.exports = __WEBPACK_EXTERNAL_MODULE__97__;","module.exports = __WEBPACK_EXTERNAL_MODULE__55__;","module.exports = __WEBPACK_EXTERNAL_MODULE__956__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","/**\n * Threshold to use GET requests, vs POST\n */\nexport const REQUEST_GET_MAX_URL_LENGTH = 2048;\n\n/**\n * Simple GET request\n */\nexport function getRequest(url, opts) {\n  return new Request(url, {\n    method: 'GET',\n    headers: {\n      Accept: 'application/json'\n    },\n    ...opts\n  });\n}\n\n/**\n * Simple POST request\n */\nexport function postRequest(url, payload, opts) {\n  return new Request(url, {\n    method: 'POST',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(payload),\n    ...opts\n  });\n}\n\n/**\n * Simple encode parameter\n */\nexport function encodeParameter(name, value) {\n  return `${name}=${encodeURIComponent(value)}`;\n}\n","export function getMonday(date) {\n  const dateCp = new Date(date);\n  const day = dateCp.getDay();\n  const diff = dateCp.getDate() - day + (day ? 1 : -6); // adjust when day is sunday\n  dateCp.setDate(diff);\n  return Date.UTC(dateCp.getUTCFullYear(), dateCp.getUTCMonth(), dateCp.getUTCDate());\n}\n","export function debounce(fn, ms) {\n  let timer;\n  return (...args) => {\n    clearTimeout(timer);\n    timer = setTimeout(() => {\n      timer = null;\n      fn.apply(this, args);\n    }, ms);\n    return timer;\n  };\n}\n","export function throttle(fn, ms) {\n  var lastTime = 0;\n  return function () {\n    var now = new Date();\n    if (now - lastTime >= ms) {\n      fn();\n      lastTime = now;\n    }\n  };\n}\n","export function randomString(length) {\n  let text = '';\n  const possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  for (let i = 0; i < length; i++) {\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n  return text;\n}\n","export function makeIntervalComplete(values) {\n  return values.map((val) => {\n    if (val[0] === undefined) {\n      return [Number.MIN_SAFE_INTEGER, val[1]];\n    }\n\n    if (val[1] === undefined) {\n      return [val[0], Number.MAX_SAFE_INTEGER];\n    }\n\n    return val;\n  });\n}\n","/**\n * Enum for the different types of aggregations available for widgets\n * @enum {string}\n * @readonly\n */\nexport const AggregationTypes = Object.freeze({\n  /** Count */\n  COUNT: 'count',\n\n  /** Average */\n  AVG: 'avg',\n\n  /** Minimum */\n  MIN: 'min',\n\n  /** Maximum */\n  MAX: 'max',\n\n  /** Sum */\n  SUM: 'sum'\n});\n","import { AggregationTypes } from './AggregationTypes';\n\nconst sum = (values, key) => {\n  const fn = key ? (a, b) => a + b[key] : (a, b) => a + b;\n  return values.reduce(fn, 0);\n};\n\nconst min = (values, key) => {\n  const fn = key ? (a, b) => Math.min(a, b[key]) : (a, b) => Math.min(a, b);\n  return values.reduce(fn, Infinity);\n};\n\nconst max = (values, key) => {\n  const fn = key ? (a, b) => Math.max(a, b[key]) : (a, b) => Math.max(a, b);\n  return values.reduce(fn, -Infinity);\n};\n\nexport const aggregationFunctions = {\n  [AggregationTypes.COUNT]: (values) => values.length,\n  [AggregationTypes.MIN]: (values, key) => min(values, key),\n  [AggregationTypes.MAX]: (values, key) => max(values, key),\n  [AggregationTypes.SUM]: (values, key) => sum(values, key),\n  [AggregationTypes.AVG]: (values, key) => sum(values, key) / (values.length || 1)\n};\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import { AggregationTypes } from './aggregation/AggregationTypes';\nimport { aggregationFunctions } from './aggregation/values';\n\nexport function groupValuesByColumn(data, valuesColumn, keysColumn, operation) {\n  if (Array.isArray(data) && data.length === 0) {\n    return null;\n  }\n\n  const groups = data.reduce((accumulator, item) => {\n    const group = item[keysColumn];\n\n    accumulator[group] = accumulator[group] || [];\n\n    const isValid =\n      (operation === AggregationTypes.COUNT ? true : item[valuesColumn] !== null) &&\n      item[valuesColumn] !== undefined;\n\n    if (isValid) {\n      accumulator[group].push(item[valuesColumn]);\n    }\n\n    return accumulator;\n  }, {});\n\n  const targetOperation = aggregationFunctions[operation];\n\n  if (targetOperation) {\n    return Object.entries(groups).map(([name, value]) => ({\n      name,\n      value: targetOperation(value)\n    }));\n  }\n\n  return [];\n}\n","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import { aggregationFunctions } from './aggregation/values';\n\nexport function histogram(features, columnName, ticks, operation) {\n  if (Array.isArray(features) && features.length === 0) {\n    return [];\n  }\n\n  ticks = [Number.MIN_SAFE_INTEGER, ...ticks];\n\n  const binsContainer = ticks.map((tick, index, arr) => ({\n    bin: index,\n    start: tick,\n    end: index === arr.length - 1 ? Number.MAX_SAFE_INTEGER : arr[index + 1],\n    values: []\n  }));\n\n  features.forEach((feature) => {\n    const featureValue = feature[columnName];\n\n    const isValid = featureValue !== null && featureValue !== undefined;\n\n    if (!isValid) {\n      return;\n    }\n\n    const binContainer = binsContainer.find(\n      (bin) => bin.start <= featureValue && bin.end > featureValue\n    );\n\n    if (!binContainer) {\n      return;\n    }\n\n    binContainer.values.push(featureValue);\n  });\n\n  const targetOperation = aggregationFunctions[operation];\n\n  if (targetOperation) {\n    const transformedBins = binsContainer.map((binContainer) => binContainer.values);\n    return transformedBins.map((values) => (values.length ? targetOperation(values) : 0));\n  }\n\n  return [];\n}\n","/**\n * Filters invalid features and formats  data\n */\nexport const scatterPlot = (features, xAxisColumn, yAxisColumn) =>\n  features\n    .filter((feature) => {\n      const xValue = feature[xAxisColumn];\n      const xIsValid = xValue !== null && xValue !== undefined;\n      const yValue = feature[yAxisColumn];\n      const yIsValid = yValue !== null && yValue !== undefined;\n      return xIsValid && yIsValid;\n    })\n    .map((feature) => [feature[xAxisColumn], feature[yAxisColumn]]);\n","import { makeIntervalComplete } from '../utils/makeIntervalComplete';\n\nexport const FilterTypes = Object.freeze({\n  IN: 'in',\n  BETWEEN: 'between', // [a, b] both are included\n  CLOSED_OPEN: 'closed_open', // [a, b) a is included, b is not\n  TIME: 'time',\n  STRING_SEARCH: 'stringSearch'\n});\n\nexport const filterFunctions = {\n  [FilterTypes.IN](filterValues, featureValue) {\n    return filterValues.includes(featureValue);\n  },\n  [FilterTypes.BETWEEN]: between,\n  [FilterTypes.TIME](filterValues, featureValue) {\n    const featureValueAsTimestamp = new Date(featureValue).getTime();\n    if (isFinite(featureValueAsTimestamp)) {\n      return between(filterValues, featureValueAsTimestamp);\n    } else {\n      throw new Error(`Column used to filter by time isn't well formatted.`);\n    }\n  },\n  [FilterTypes.CLOSED_OPEN]: closedOpen,\n  [FilterTypes.STRING_SEARCH]: stringSearch\n};\n\n// FilterTypes.BETWEEN\nfunction between(filterValues, featureValue) {\n  const checkRange = (range) => {\n    const [lowerBound, upperBound] = range;\n    return featureValue >= lowerBound && featureValue <= upperBound;\n  };\n\n  return makeIntervalComplete(filterValues).some(checkRange);\n}\n\n// FilterTypes.CLOSED_OPEN\nfunction closedOpen(filterValues, featureValue) {\n  const checkRange = (range) => {\n    const [lowerBound, upperBound] = range;\n    return featureValue >= lowerBound && featureValue < upperBound;\n  };\n\n  return makeIntervalComplete(filterValues).some(checkRange);\n}\n\n// FilterTypes.STRING_SEARCH\nfunction stringSearch(filterValues, featureValue, params = {}) {\n  const normalizedFeatureValue = normalize(featureValue, params);\n  const stringRegExp = filterValues\n    .map((filterValue) => {\n      let stringRegExp = escapeRegExp(normalize(filterValue, params));\n\n      if (params.mustStart) stringRegExp = `^${stringRegExp}`;\n      if (params.mustEnd) stringRegExp = `${stringRegExp}$`;\n\n      return stringRegExp;\n    })\n    .join('|');\n\n  const regex = new RegExp(stringRegExp, 'g');\n  return !!normalizedFeatureValue.match(regex);\n}\n\n// Aux\nconst specialCharRegExp = /[.*+?^${}()|[\\]\\\\]/g;\nconst normalizeRegExp = /\\p{Diacritic}/gu;\n\nfunction escapeRegExp(value) {\n  return value.replace(specialCharRegExp, '\\\\$&');\n}\n\nfunction normalize(data, params) {\n  let normalizedData = '' + data;\n\n  if (!params.caseSensitive) normalizedData = normalizedData.toLocaleLowerCase();\n  if (!params.keepSpecialCharacters)\n    normalizedData = normalizedData.normalize('NFD').replace(normalizeRegExp, '');\n\n  return normalizedData;\n}\n","import { FilterTypes } from './FilterTypes';\n\nexport const getApplicableFilters = (filters = {}, owner) => {\n  const filtersCopy = {};\n  Object.entries(filters).forEach(([column, filter]) => {\n    const filterCopy = {};\n    Object.keys(filter)\n      .filter((operator) => filter[operator].owner !== owner)\n      .forEach((operator) => (filterCopy[operator] = { ...filter[operator] }));\n\n    if (Object.keys(filterCopy).length) {\n      filtersCopy[column] = filterCopy;\n    }\n  });\n\n  return filtersCopy;\n};\n\nexport const filtersToSQL = (filters = {}) => {\n  const result = [];\n\n  Object.entries(filters).forEach(([column, filter]) => {\n    Object.entries(filter).forEach(([operator, params]) => {\n      switch (operator) {\n        case FilterTypes.IN:\n          result.push(\n            `${column} ${operator}(${params.values\n              .map((v) => (isFinite(v) ? v : `'${v}'`))\n              .join(',')})`\n          );\n          break;\n        case FilterTypes.BETWEEN:\n          result.push(\n            `(${params.values\n              .map(\n                ([left, right]) =>\n                  `${left ? `${column} >= ${left}` : ``} ${\n                    left && right ? ' and ' : ''\n                  } ${right ? `${column} < ${right}` : ``}`\n              )\n              .join(') OR (')})`\n          );\n          break;\n        default:\n          throw new Error(`Not valid operator has provided: ${operator}`);\n      }\n    });\n  });\n\n  return result.length ? `WHERE (${result.join(') AND (')})` : '';\n};\n","import { filterFunctions } from './FilterTypes';\n\nfunction passesFilter(columns, filters, feature) {\n  return columns.every((column) => {\n    const columnFilters = filters[column];\n    const columnFilterTypes = Object.keys(columnFilters);\n\n    if (!feature || feature[column] === null || feature[column] === undefined) {\n      return false;\n    }\n\n    return columnFilterTypes.every((filter) => {\n      const filterFunction = filterFunctions[filter];\n\n      if (!filterFunction) {\n        throw new Error(`\"${filter}\" filter is not implemented.`);\n      }\n\n      return filterFunction(\n        columnFilters[filter].values,\n        feature[column],\n        columnFilters[filter].params\n      );\n    });\n  });\n}\n\nexport function buildFeatureFilter({ filters = {}, type = 'boolean' }) {\n  const columns = Object.keys(filters);\n\n  if (!columns.length) {\n    return () => (type === 'number' ? 1 : true);\n  }\n\n  return (feature) => {\n    const f = feature.properties || feature;\n    const featurePassesFilter = passesFilter(columns, filters, f);\n\n    return type === 'number' ? Number(featurePassesFilter) : featurePassesFilter;\n  };\n}\n\n// Apply certain filters to a collection of features\nexport function applyFilters(features, filters) {\n  return Object.keys(filters).length\n    ? features.filter(buildFeatureFilter({ filters }))\n    : features;\n}\n\n// Binary\nexport function buildBinaryFeatureFilter({ filters = {} }) {\n  const columns = Object.keys(filters);\n\n  if (!columns.length) {\n    return () => 1;\n  }\n\n  return (featureIdIdx, binaryData) =>\n    passesFilterUsingBinary(columns, filters, featureIdIdx, binaryData);\n}\n\nfunction getValueFromNumericProps(featureIdIdx, binaryData, { column }) {\n  return binaryData.numericProps[column]?.value[featureIdIdx];\n}\n\nfunction getValueFromProperties(featureIdIdx, binaryData, { column }) {\n  const propertyIdx = binaryData.featureIds.value[featureIdIdx];\n  return binaryData.properties[propertyIdx]?.[column];\n}\n\nconst GET_VALUE_BY_BINARY_PROP = {\n  properties: getValueFromProperties,\n  numericProps: getValueFromNumericProps\n};\n\nfunction getBinaryPropertyByFilterValues(filterValues) {\n  return typeof filterValues.flat()[0] === 'string' ? 'properties' : 'numericProps';\n}\n\nfunction getFeatureValue(featureIdIdx, binaryData, filter) {\n  const { column, values } = filter;\n  const binaryProp = getBinaryPropertyByFilterValues(values);\n  const getFeatureValueFn = GET_VALUE_BY_BINARY_PROP[binaryProp];\n  return getFeatureValueFn(featureIdIdx, binaryData, { column });\n}\n\nfunction passesFilterUsingBinary(columns, filters, featureIdIdx, binaryData) {\n  return columns.every((column) => {\n    const columnFilters = filters[column];\n\n    return Object.entries(columnFilters).every(([type, { values }]) => {\n      const filterFn = filterFunctions[type];\n      if (!filterFn) {\n        throw new Error(`\"${type}\" filter is not implemented.`);\n      }\n\n      if (!values) return 0;\n\n      const featureValue = getFeatureValue(featureIdIdx, binaryData, {\n        column,\n        type,\n        values\n      });\n\n      if (featureValue === undefined || featureValue === null) return 0;\n\n      return filterFn(values, featureValue);\n    });\n  });\n}\n","export const DEFAULT_USER_COMPONENT_IN_URL = '{user}';\nexport const DEFAULT_REGION_COMPONENT_IN_URL = '{region}';\nexport const API_VERSIONS = {\n  V1: 'v1',\n  V2: 'v2',\n  V3: 'v3'\n};\nexport const DEFAULT_MAPS_URL_FORMAT = {\n  [API_VERSIONS.V1]: \"https://\".concat(DEFAULT_USER_COMPONENT_IN_URL, \".carto.com/api/v1/map\"),\n  [API_VERSIONS.V2]: \"https://maps-api-v2.\".concat(DEFAULT_REGION_COMPONENT_IN_URL, \".carto.com/user/\").concat(DEFAULT_USER_COMPONENT_IN_URL)\n};\nexport const MAP_TYPES = {\n  QUERY: 'query',\n  TABLE: 'table',\n  TILESET: 'tileset'\n};\nexport const FORMATS = {\n  GEOJSON: 'geojson',\n  NDJSON: 'ndjson',\n  TILEJSON: 'tilejson',\n  JSON: 'json'\n};\nexport const TILE_FORMATS = {\n  MVT: 'mvt',\n  GEOJSON: 'geojson',\n  BINARY: 'binary'\n};\nexport let SchemaFieldType;\n\n(function (SchemaFieldType) {\n  SchemaFieldType[\"Number\"] = \"number\";\n  SchemaFieldType[\"Bigint\"] = \"bigint\";\n  SchemaFieldType[\"String\"] = \"string\";\n  SchemaFieldType[\"Geometry\"] = \"geometry\";\n  SchemaFieldType[\"Timestamp\"] = \"timestamp\";\n  SchemaFieldType[\"Object\"] = \"object\";\n  SchemaFieldType[\"Boolean\"] = \"boolean\";\n  SchemaFieldType[\"Variant\"] = \"variant\";\n  SchemaFieldType[\"Unknown\"] = \"unknown\";\n})(SchemaFieldType || (SchemaFieldType = {}));\n\nexport function encodeParameter(name, value) {\n  return \"\".concat(name, \"=\").concat(encodeURIComponent(value));\n}\n//# sourceMappingURL=maps-api-common.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || '@math.gl/web-mercator: assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","import * as vec4 from 'gl-matrix/vec4';\nexport function createMat4() {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n}\nexport function transformVector(matrix, vector) {\n  const result = vec4.transformMat4([], vector, matrix);\n  vec4.scale(result, result, 1 / result[3]);\n  return result;\n}\nexport function mod(value, divisor) {\n  const modulus = value % divisor;\n  return modulus < 0 ? divisor + modulus : modulus;\n}\nexport function lerp(start, end, step) {\n  return step * end + (1 - step) * start;\n}\nexport function clamp(x, min, max) {\n  return x < min ? min : x > max ? max : x;\n}\n\nfunction ieLog2(x) {\n  return Math.log(x) * Math.LOG2E;\n}\n\nexport const log2 = Math.log2 || ieLog2;\n//# sourceMappingURL=math-utils.js.map","import { createMat4, transformVector, log2 } from './math-utils';\nimport * as mat4 from 'gl-matrix/mat4';\nimport * as vec2 from 'gl-matrix/vec2';\nimport * as vec3 from 'gl-matrix/vec3';\nimport assert from './assert';\nconst PI = Math.PI;\nconst PI_4 = PI / 4;\nconst DEGREES_TO_RADIANS = PI / 180;\nconst RADIANS_TO_DEGREES = 180 / PI;\nconst TILE_SIZE = 512;\nconst EARTH_CIRCUMFERENCE = 40.03e6;\nexport const MAX_LATITUDE = 85.051129;\nexport const DEFAULT_ALTITUDE = 1.5;\nexport function zoomToScale(zoom) {\n  return Math.pow(2, zoom);\n}\nexport function scaleToZoom(scale) {\n  return log2(scale);\n}\nexport function lngLatToWorld([lng, lat]) {\n  assert(Number.isFinite(lng));\n  assert(Number.isFinite(lat) && lat >= -90 && lat <= 90, 'invalid latitude');\n  const lambda2 = lng * DEGREES_TO_RADIANS;\n  const phi2 = lat * DEGREES_TO_RADIANS;\n  const x = TILE_SIZE * (lambda2 + PI) / (2 * PI);\n  const y = TILE_SIZE * (PI + Math.log(Math.tan(PI_4 + phi2 * 0.5))) / (2 * PI);\n  return [x, y];\n}\nexport function worldToLngLat([x, y]) {\n  const lambda2 = x / TILE_SIZE * (2 * PI) - PI;\n  const phi2 = 2 * (Math.atan(Math.exp(y / TILE_SIZE * (2 * PI) - PI)) - PI_4);\n  return [lambda2 * RADIANS_TO_DEGREES, phi2 * RADIANS_TO_DEGREES];\n}\nexport function getMeterZoom({\n  latitude\n}) {\n  assert(Number.isFinite(latitude));\n  const latCosine = Math.cos(latitude * DEGREES_TO_RADIANS);\n  return scaleToZoom(EARTH_CIRCUMFERENCE * latCosine) - 9;\n}\nexport function getDistanceScales({\n  latitude,\n  longitude,\n  highPrecision = false\n}) {\n  assert(Number.isFinite(latitude) && Number.isFinite(longitude));\n  const result = {};\n  const worldSize = TILE_SIZE;\n  const latCosine = Math.cos(latitude * DEGREES_TO_RADIANS);\n  const unitsPerDegreeX = worldSize / 360;\n  const unitsPerDegreeY = unitsPerDegreeX / latCosine;\n  const altUnitsPerMeter = worldSize / EARTH_CIRCUMFERENCE / latCosine;\n  result.unitsPerMeter = [altUnitsPerMeter, altUnitsPerMeter, altUnitsPerMeter];\n  result.metersPerUnit = [1 / altUnitsPerMeter, 1 / altUnitsPerMeter, 1 / altUnitsPerMeter];\n  result.unitsPerDegree = [unitsPerDegreeX, unitsPerDegreeY, altUnitsPerMeter];\n  result.degreesPerUnit = [1 / unitsPerDegreeX, 1 / unitsPerDegreeY, 1 / altUnitsPerMeter];\n\n  if (highPrecision) {\n    const latCosine2 = DEGREES_TO_RADIANS * Math.tan(latitude * DEGREES_TO_RADIANS) / latCosine;\n    const unitsPerDegreeY2 = unitsPerDegreeX * latCosine2 / 2;\n    const altUnitsPerDegree2 = worldSize / EARTH_CIRCUMFERENCE * latCosine2;\n    const altUnitsPerMeter2 = altUnitsPerDegree2 / unitsPerDegreeY * altUnitsPerMeter;\n    result.unitsPerDegree2 = [0, unitsPerDegreeY2, altUnitsPerDegree2];\n    result.unitsPerMeter2 = [altUnitsPerMeter2, 0, altUnitsPerMeter2];\n  }\n\n  return result;\n}\nexport function addMetersToLngLat(lngLatZ, xyz) {\n  const [longitude, latitude, z0] = lngLatZ;\n  const [x, y, z] = xyz;\n  const {\n    unitsPerMeter,\n    unitsPerMeter2\n  } = getDistanceScales({\n    longitude,\n    latitude,\n    highPrecision: true\n  });\n  const worldspace = lngLatToWorld(lngLatZ);\n  worldspace[0] += x * (unitsPerMeter[0] + unitsPerMeter2[0] * y);\n  worldspace[1] += y * (unitsPerMeter[1] + unitsPerMeter2[1] * y);\n  const newLngLat = worldToLngLat(worldspace);\n  const newZ = (z0 || 0) + (z || 0);\n  return Number.isFinite(z0) || Number.isFinite(z) ? [newLngLat[0], newLngLat[1], newZ] : newLngLat;\n}\nexport function getViewMatrix({\n  height,\n  pitch,\n  bearing,\n  altitude,\n  scale,\n  center = null\n}) {\n  const vm = createMat4();\n  mat4.translate(vm, vm, [0, 0, -altitude]);\n  mat4.rotateX(vm, vm, -pitch * DEGREES_TO_RADIANS);\n  mat4.rotateZ(vm, vm, bearing * DEGREES_TO_RADIANS);\n  scale /= height;\n  mat4.scale(vm, vm, [scale, scale, scale]);\n\n  if (center) {\n    mat4.translate(vm, vm, vec3.negate([], center));\n  }\n\n  return vm;\n}\nexport function getProjectionParameters({\n  width,\n  height,\n  fovy = altitudeToFovy(DEFAULT_ALTITUDE),\n  altitude,\n  pitch = 0,\n  nearZMultiplier = 1,\n  farZMultiplier = 1\n}) {\n  if (altitude !== undefined) {\n    fovy = altitudeToFovy(altitude);\n  }\n\n  const halfFov = 0.5 * fovy * DEGREES_TO_RADIANS;\n  const focalDistance = fovyToAltitude(fovy);\n  const pitchRadians = pitch * DEGREES_TO_RADIANS;\n  const topHalfSurfaceDistance = Math.sin(halfFov) * focalDistance / Math.sin(Math.min(Math.max(Math.PI / 2 - pitchRadians - halfFov, 0.01), Math.PI - 0.01));\n  const farZ = Math.sin(pitchRadians) * topHalfSurfaceDistance + focalDistance;\n  return {\n    fov: 2 * halfFov,\n    aspect: width / height,\n    focalDistance,\n    near: nearZMultiplier,\n    far: farZ * farZMultiplier\n  };\n}\nexport function getProjectionMatrix({\n  width,\n  height,\n  pitch,\n  altitude,\n  fovy,\n  nearZMultiplier,\n  farZMultiplier\n}) {\n  const {\n    fov,\n    aspect,\n    near,\n    far\n  } = getProjectionParameters({\n    width,\n    height,\n    altitude,\n    fovy,\n    pitch,\n    nearZMultiplier,\n    farZMultiplier\n  });\n  const projectionMatrix = mat4.perspective([], fov, aspect, near, far);\n  return projectionMatrix;\n}\nexport function altitudeToFovy(altitude) {\n  return 2 * Math.atan(0.5 / altitude) * RADIANS_TO_DEGREES;\n}\nexport function fovyToAltitude(fovy) {\n  return 0.5 / Math.tan(0.5 * fovy * DEGREES_TO_RADIANS);\n}\nexport function worldToPixels(xyz, pixelProjectionMatrix) {\n  const [x, y, z = 0] = xyz;\n  assert(Number.isFinite(x) && Number.isFinite(y) && Number.isFinite(z));\n  return transformVector(pixelProjectionMatrix, [x, y, z, 1]);\n}\nexport function pixelsToWorld(xyz, pixelUnprojectionMatrix, targetZ = 0) {\n  const [x, y, z] = xyz;\n  assert(Number.isFinite(x) && Number.isFinite(y), 'invalid pixel coordinate');\n\n  if (Number.isFinite(z)) {\n    const coord = transformVector(pixelUnprojectionMatrix, [x, y, z, 1]);\n    return coord;\n  }\n\n  const coord0 = transformVector(pixelUnprojectionMatrix, [x, y, 0, 1]);\n  const coord1 = transformVector(pixelUnprojectionMatrix, [x, y, 1, 1]);\n  const z0 = coord0[2];\n  const z1 = coord1[2];\n  const t = z0 === z1 ? 0 : ((targetZ || 0) - z0) / (z1 - z0);\n  return vec2.lerp([], coord0, coord1, t);\n}\n//# sourceMappingURL=web-mercator-utils.js.map","import { lngLatToWorld } from '@math.gl/web-mercator';\n\n/**\n * Transform WGS84 coordinates to tile coords.\n * It's the inverse of deck.gl coordinate-transform (https://github.com/visgl/deck.gl/blob/master/modules/geo-layers/src/mvt-layer/coordinate-transform.js)\n *\n * @param {object} geometry - any valid geojson geometry\n * @param {{ west: number, east: number, north: number, south: number }} bbox - tile bbox as used in deck.gl\n * @returns {GeoJSON}\n */\nexport default function transformToTileCoords(geometry, bbox) {\n  const nw = projectFlat([bbox.west, bbox.north]);\n  const se = projectFlat([bbox.east, bbox.south]);\n  const projectedBbox = [nw, se];\n\n  const transformFn = availableTransformations[geometry.type];\n  if (!transformFn) {\n    throw new Error(`Unrecognized geometry type ${geometry.type}`);\n  }\n\n  return {\n    ...geometry,\n    coordinates: transformFn(geometry.coordinates, projectedBbox)\n  };\n}\n\nconst availableTransformations = {\n  Point,\n  MultiPoint,\n  LineString,\n  MultiLineString,\n  Polygon,\n  MultiPolygon\n};\n\nfunction Point([pointX, pointY], [nw, se]) {\n  const x = inverseLerp(nw[0], se[0], pointX);\n  const y = inverseLerp(nw[1], se[1], pointY);\n\n  return [x, y];\n}\n\nfunction getPoints(geometry, bbox) {\n  return geometry.map((g) => Point(projectFlat(g), bbox));\n}\n\nfunction MultiPoint(multiPoint, bbox) {\n  return getPoints(multiPoint, bbox);\n}\n\nfunction LineString(line, bbox) {\n  return getPoints(line, bbox);\n}\n\nfunction MultiLineString(multiLineString, bbox) {\n  return multiLineString.map((lineString) => LineString(lineString, bbox));\n}\n\nfunction Polygon(polygon, bbox) {\n  return polygon.map((polygonRing) => getPoints(polygonRing, bbox));\n}\n\nfunction MultiPolygon(multiPolygon, bbox) {\n  return multiPolygon.map((polygon) => Polygon(polygon, bbox));\n}\n\nfunction projectFlat(xyz) {\n  return lngLatToWorld(xyz);\n}\n\nfunction inverseLerp(a, b, x) {\n  return (x - a) / (b - a);\n}\n","import { worldToLngLat } from './web-mercator-utils';\nimport * as vec2 from 'gl-matrix/vec2';\nimport { transformVector } from './math-utils';\nconst DEGREES_TO_RADIANS = Math.PI / 180;\nexport default function getBounds(viewport, z = 0) {\n  const {\n    width,\n    height,\n    unproject\n  } = viewport;\n  const unprojectOps = {\n    targetZ: z\n  };\n  const bottomLeft = unproject([0, height], unprojectOps);\n  const bottomRight = unproject([width, height], unprojectOps);\n  let topLeft;\n  let topRight;\n  const halfFov = viewport.fovy ? 0.5 * viewport.fovy * DEGREES_TO_RADIANS : Math.atan(0.5 / viewport.altitude);\n  const angleToGround = (90 - viewport.pitch) * DEGREES_TO_RADIANS;\n\n  if (halfFov > angleToGround - 0.01) {\n    topLeft = unprojectOnFarPlane(viewport, 0, z);\n    topRight = unprojectOnFarPlane(viewport, width, z);\n  } else {\n    topLeft = unproject([0, 0], unprojectOps);\n    topRight = unproject([width, 0], unprojectOps);\n  }\n\n  return [bottomLeft, bottomRight, topRight, topLeft];\n}\n\nfunction unprojectOnFarPlane(viewport, x, targetZ) {\n  const {\n    pixelUnprojectionMatrix\n  } = viewport;\n  const coord0 = transformVector(pixelUnprojectionMatrix, [x, 0, 1, 1]);\n  const coord1 = transformVector(pixelUnprojectionMatrix, [x, viewport.height, 1, 1]);\n  const z = targetZ * viewport.distanceScales.unitsPerMeter[2];\n  const t = (z - coord0[2]) / (coord1[2] - coord0[2]);\n  const coord = vec2.lerp([], coord0, coord1, t);\n  const result = worldToLngLat(coord);\n  result[2] = targetZ;\n  return result;\n}\n//# sourceMappingURL=get-bounds.js.map","import { TILE_FORMATS } from '@deck.gl/carto';\nimport bboxPolygon from '@turf/bbox-polygon';\nimport intersects from '@turf/boolean-intersects';\nimport booleanWithin from '@turf/boolean-within';\nimport intersect from '@turf/intersect';\nimport transformToTileCoords from '../utils/transformToTileCoords';\n\nconst GEOMETRY_TYPES = Object.freeze({\n  Point: 0,\n  LineString: 1,\n  Polygon: 2\n});\n\nfunction addIntersectedFeaturesInTile({\n  map,\n  data,\n  geometryIntersection,\n  type,\n  uniqueIdProperty\n}) {\n  const indices = getIndices(data);\n  const { positions } = data;\n\n  for (let i = 0; i < indices.length - 1; i++) {\n    const startIndex = indices[i];\n    const endIndex = indices[i + 1];\n\n    const tileProps = getPropertiesFromTile(data, startIndex);\n    const uniquePropertyValue = getUniquePropertyValue(tileProps, uniqueIdProperty, map);\n\n    if (uniquePropertyValue && !map.has(uniquePropertyValue)) {\n      const ringCoordinates = getRingCoordinatesFor(startIndex, endIndex, positions);\n      if (intersects(getFeatureByType(ringCoordinates, type), geometryIntersection)) {\n        map.set(uniquePropertyValue, parseProperties(tileProps));\n      }\n    }\n  }\n}\n\nfunction getIndices(data) {\n  const indices = data.primitivePolygonIndices || data.pathIndices || data.pointIndices;\n  return indices.value;\n}\n\nfunction getFeatureId(data, startIndex) {\n  return data.featureIds.value[startIndex];\n}\n\nfunction getPropertiesFromTile(data, startIndex) {\n  const featureId = getFeatureId(data, startIndex);\n  const { properties, numericProps } = data;\n  const result = {\n    properties: properties[featureId],\n    numericProps: {}\n  };\n\n  for (const key in numericProps) {\n    result.numericProps[key] = numericProps[key].value[startIndex];\n  }\n\n  return result;\n}\n\nfunction parseProperties(tileProps) {\n  const { properties, numericProps } = tileProps;\n  return Object.assign({}, properties, numericProps);\n}\n\nfunction getUniquePropertyValue(tileProps, uniqueIdProperty, map) {\n  if (uniqueIdProperty) {\n    return getValueFromTileProps(tileProps, uniqueIdProperty);\n  }\n\n  const artificialId = map.size + 1; // a counter, assumed as a valid new id\n  return (\n    getValueFromTileProps(tileProps, 'cartodb_id') ||\n    getValueFromTileProps(tileProps, 'geoid') ||\n    artificialId\n  );\n}\n\nfunction getValueFromTileProps(tileProps, propertyName) {\n  const { properties, numericProps } = tileProps;\n  return numericProps[propertyName] || properties[propertyName];\n}\n\nfunction getFeatureByType(coordinates, type) {\n  switch (type) {\n    case GEOMETRY_TYPES['Polygon']:\n      return { type: 'Polygon', coordinates: [coordinates] };\n    case GEOMETRY_TYPES['LineString']:\n      return { type: 'LineString', coordinates };\n    case GEOMETRY_TYPES['Point']:\n      return { type: 'Point', coordinates: coordinates[0] };\n    default:\n      throw new Error('Invalid geometry type');\n  }\n}\n\nfunction getRingCoordinatesFor(startIndex, endIndex, positions) {\n  const ringCoordinates = [];\n\n  for (let j = startIndex; j < endIndex; j++) {\n    ringCoordinates.push(\n      Array.from(positions.value.subarray(j * positions.size, (j + 1) * positions.size))\n    );\n  }\n\n  return ringCoordinates;\n}\n\nfunction calculateFeatures({\n  map,\n  tileIsFullyVisible,\n  geometryIntersection,\n  data,\n  type,\n  uniqueIdProperty\n}) {\n  if (!data?.properties.length) {\n    return;\n  }\n\n  if (tileIsFullyVisible) {\n    addAllFeaturesInTile({ map, data, uniqueIdProperty });\n  } else {\n    addIntersectedFeaturesInTile({\n      map,\n      data,\n      geometryIntersection,\n      type,\n      uniqueIdProperty\n    });\n  }\n}\n\nfunction addAllFeaturesInTile({ map, data, uniqueIdProperty }) {\n  const indices = getIndices(data);\n\n  for (let i = 0; i < indices.length - 1; i++) {\n    const startIndex = indices[i];\n\n    const tileProps = getPropertiesFromTile(data, startIndex);\n    const uniquePropertyValue = getUniquePropertyValue(tileProps, uniqueIdProperty, map);\n\n    if (uniquePropertyValue && !map.has(uniquePropertyValue)) {\n      map.set(uniquePropertyValue, parseProperties(tileProps));\n    }\n  }\n}\n\nfunction createIndicesForPoints(data) {\n  const featureIds = data.featureIds.value;\n  const lastFeatureId = featureIds[featureIds.length - 1];\n\n  data.pointIndices = {\n    value: new featureIds.constructor(featureIds.length + 1),\n    size: 1\n  };\n  data.pointIndices.value.set(featureIds);\n  data.pointIndices.value.set([lastFeatureId + 1], featureIds.length);\n}\n\nexport function getGeometryToIntersect(viewport, geometry) {\n  return geometry ? intersect(bboxPolygon(viewport), geometry) : bboxPolygon(viewport);\n}\n\nexport function tileFeatures({\n  tiles,\n  viewport,\n  geometry,\n  uniqueIdProperty,\n  tileFormat\n}) {\n  const map = new Map();\n  const geometryToIntersect = getGeometryToIntersect(viewport, geometry);\n\n  if (!geometryToIntersect) {\n    return [];\n  }\n\n  for (const tile of tiles) {\n    // Discard if it's not a visible tile (only check false value, not undefined)\n    // or tile has not data\n    if (tile.isVisible === false || !tile.data) {\n      continue;\n    }\n\n    const { bbox } = tile;\n    const bboxToGeom = bboxPolygon([bbox.west, bbox.south, bbox.east, bbox.north]);\n    const tileIsFullyVisible = booleanWithin(bboxToGeom, geometryToIntersect);\n    // Clip the geometry to intersect with the tile\n    const clippedGeometryToIntersect = intersect(bboxToGeom, geometryToIntersect);\n\n    if (!clippedGeometryToIntersect) {\n      continue;\n    }\n    // We assume that MVT tileFormat uses local coordinates so we transform the geometry to intersect to tile coordinates [0..1],\n    // while in the case of 'geojson' or binary, the geometries are already in WGS84\n    const transformedGeomtryToIntersect = {\n      type: 'Feature',\n      geometry:\n        tileFormat === TILE_FORMATS.MVT\n          ? transformToTileCoords(clippedGeometryToIntersect.geometry, bbox)\n          : clippedGeometryToIntersect.geometry\n    };\n\n    createIndicesForPoints(tile.data.points);\n\n    calculateFeatures({\n      map,\n      tileIsFullyVisible,\n      geometryIntersection: transformedGeomtryToIntersect,\n      data: tile.data.points,\n      type: GEOMETRY_TYPES['Point'],\n      uniqueIdProperty\n    });\n    calculateFeatures({\n      map,\n      tileIsFullyVisible,\n      geometryIntersection: transformedGeomtryToIntersect,\n      data: tile.data.lines,\n      type: GEOMETRY_TYPES['LineString'],\n      uniqueIdProperty\n    });\n    calculateFeatures({\n      map,\n      tileIsFullyVisible,\n      geometryIntersection: transformedGeomtryToIntersect,\n      data: tile.data.polygons,\n      type: GEOMETRY_TYPES['Polygon'],\n      uniqueIdProperty\n    });\n  }\n  return Array.from(map.values());\n}\n","import intersects from '@turf/boolean-intersects';\nimport { getGeometryToIntersect } from './tileFeatures';\n\nexport function geojsonFeatures({ geojson, viewport, geometry, uniqueIdProperty }) {\n  let uniqueIdx = 0;\n  // Map is used to cache multi geometries. Only a sucessfull intersect by multipolygon\n  const map = new Map();\n  const geometryToIntersect = getGeometryToIntersect(viewport, geometry);\n\n  if (!geometryToIntersect) {\n    return [];\n  }\n\n  for (const feature of geojson.features) {\n    const uniqueId = uniqueIdProperty\n      ? feature.properties[uniqueIdProperty]\n      : ++uniqueIdx;\n    if (!map.has(uniqueId) && intersects(geometryToIntersect, feature)) {\n      map.set(uniqueId, feature.properties);\n    }\n  }\n\n  return Array.from(map.values());\n}\n","/**\n * Enum for the different types of group by date available for widgets\n * @enum {string}\n * @readonly\n */\nexport const GroupDateTypes = Object.freeze({\n  /** Years */\n  YEARS: 'years',\n\n  /** Months */\n  MONTHS: 'months',\n\n  /** Weeks */\n  WEEKS: 'weeks',\n\n  /** Days */\n  DAYS: 'days',\n\n  /** Hours */\n  HOURS: 'hours',\n\n  /** Minutes */\n  MINUTES: 'minutes'\n});\n","import { getMonday } from '../utils/dateUtils';\nimport { aggregationFunctions } from './aggregation/values';\nimport { GroupDateTypes } from './GroupDateTypes';\n\nconst GROUP_KEY_FN_MAPPING = {\n  // @ts-ignore\n  [GroupDateTypes.YEARS]: (date) => Date.UTC(date.getUTCFullYear()),\n  [GroupDateTypes.MONTHS]: (date) => Date.UTC(date.getUTCFullYear(), date.getUTCMonth()),\n  [GroupDateTypes.WEEKS]: (date) => getMonday(date),\n  [GroupDateTypes.DAYS]: (date) =>\n    Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate()),\n  [GroupDateTypes.HOURS]: (date) =>\n    Date.UTC(\n      date.getUTCFullYear(),\n      date.getUTCMonth(),\n      date.getUTCDate(),\n      date.getUTCHours()\n    ),\n  [GroupDateTypes.MINUTES]: (date) =>\n    Date.UTC(\n      date.getUTCFullYear(),\n      date.getUTCMonth(),\n      date.getUTCDate(),\n      date.getUTCHours(),\n      date.getUTCMinutes()\n    )\n};\n\nexport function groupValuesByDateColumn(\n  data,\n  valuesColumn,\n  keysColumn,\n  groupType,\n  operation\n) {\n  if (Array.isArray(data) && data.length === 0) {\n    return null;\n  }\n\n  const groupKeyFn = GROUP_KEY_FN_MAPPING[groupType];\n\n  if (!groupKeyFn) {\n    return null;\n  }\n\n  const groups = data.reduce((acc, item) => {\n    const value = item[keysColumn];\n    const formattedValue = new Date(value);\n    const groupKey = groupKeyFn(formattedValue);\n\n    if (!isNaN(groupKey)) {\n      let groupedValues = acc.get(groupKey);\n      if (!groupedValues) {\n        groupedValues = [];\n        acc.set(groupKey, groupedValues);\n      }\n\n      const isValid = item[valuesColumn] !== null && item[valuesColumn] !== undefined;\n\n      if (isValid) {\n        groupedValues.push(item[valuesColumn]);\n        acc.set(groupKey, groupedValues);\n      }\n    }\n\n    return acc;\n  }, new Map());\n\n  const targetOperation = aggregationFunctions[operation];\n\n  if (targetOperation) {\n    return [...groups.entries()]\n      .map(([name, value]) => ({\n        name,\n        value: targetOperation(value)\n      }))\n      .sort((a, b) => a.name - b.name);\n  }\n\n  return [];\n}\n","// Don't rename values. These values come from nebula.\nexport const FEATURE_SELECTION_MODES = Object.freeze({\n  POLYGON: 'DrawPolygonMode',\n  RECTANGLE: 'DrawRectangleMode',\n  CIRCLE: 'DrawCircleFromCenterMode',\n  LASSO_TOOL: 'DrawPolygonByDraggingMode'\n});\n\nexport const EDIT_MODES = Object.freeze({\n  EDIT: 'edit'\n});\n\nexport const MASK_ID = 'feature_selection_mask';\n"]},"metadata":{},"sourceType":"script"}