{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _toConsumableArray from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _classCallCheck from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _get from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport { Matrix4 } from '@math.gl/core';\nimport { log } from '@luma.gl/webgl';\nimport ScenegraphNode from './scenegraph-node';\n\nvar GroupNode = /*#__PURE__*/function (_ScenegraphNode) {\n  _inherits(GroupNode, _ScenegraphNode);\n\n  var _super = _createSuper(GroupNode);\n\n  function GroupNode() {\n    var _this;\n\n    var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, GroupNode);\n\n    props = Array.isArray(props) ? {\n      children: props\n    } : props;\n    var _props = props,\n        _props$children = _props.children,\n        children = _props$children === void 0 ? [] : _props$children;\n    log.assert(children.every(function (child) {\n      return child instanceof ScenegraphNode;\n    }), 'every child must an instance of ScenegraphNode');\n    _this = _super.call(this, props);\n    _this.children = children;\n    return _this;\n  }\n\n  _createClass(GroupNode, [{\n    key: \"add\",\n    value: function add() {\n      for (var _len = arguments.length, children = new Array(_len), _key = 0; _key < _len; _key++) {\n        children[_key] = arguments[_key];\n      }\n\n      for (var _i = 0, _children = children; _i < _children.length; _i++) {\n        var child = _children[_i];\n\n        if (Array.isArray(child)) {\n          this.add.apply(this, _toConsumableArray(child));\n        } else {\n          this.children.push(child);\n        }\n      }\n\n      return this;\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(child) {\n      var children = this.children;\n      var indexOf = children.indexOf(child);\n\n      if (indexOf > -1) {\n        children.splice(indexOf, 1);\n      }\n\n      return this;\n    }\n  }, {\n    key: \"removeAll\",\n    value: function removeAll() {\n      this.children = [];\n      return this;\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      this.children.forEach(function (child) {\n        return child.delete();\n      });\n      this.removeAll();\n\n      _get(_getPrototypeOf(GroupNode.prototype), \"delete\", this).call(this);\n    }\n  }, {\n    key: \"traverse\",\n    value: function traverse(visitor) {\n      var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          _ref$worldMatrix = _ref.worldMatrix,\n          worldMatrix = _ref$worldMatrix === void 0 ? new Matrix4() : _ref$worldMatrix;\n\n      var modelMatrix = new Matrix4(worldMatrix).multiplyRight(this.matrix);\n\n      var _iterator = _createForOfIteratorHelper(this.children),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var child = _step.value;\n\n          if (child instanceof GroupNode) {\n            child.traverse(visitor, {\n              worldMatrix: modelMatrix\n            });\n          } else {\n            visitor(child, {\n              worldMatrix: modelMatrix\n            });\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n  }]);\n\n  return GroupNode;\n}(ScenegraphNode);\n\nexport { GroupNode as default };","map":{"version":3,"mappings":";;;;;;;;AAAA,SAAQA,OAAR,QAAsB,eAAtB;AACA,SAAQC,GAAR,QAAkB,gBAAlB;AACA,OAAOC,cAAP,MAA2B,mBAA3B;;IAEqBC,S;;;;;EACnBC,qBAAwB;IAAA;;IAAA,IAAZC,KAAY,uEAAJ,EAAI;;IAAA;;IACtBA,KAAK,GAAGC,KAAK,CAACC,OAAND,CAAcD,KAAdC,IAAuB;MAACE,QAAQ,EAAEH;IAAX,CAAvBC,GAA2CD,KAAnDA;IACA,aAAwBA,KAAxB;IAAA,6BAAOG,QAAP;IAAA,IAAOA,QAAP,gCAAkB,EAAlB;IACAP,GAAG,CAACQ,MAAJR,CACEO,QAAQ,CAACE,KAATF,CAAeG,eAAK;MAAA,OAAIA,KAAK,YAAYT,cAArB;IAAA,CAApBM,CADFP,EAEE,gDAFFA;IAIA,0BAAMI,KAAN;IACA,MAAKG,QAAL,GAAgBA,QAAhB;IARsB;EASvB;;;;WAGDI,eAAiB;MAAA,kCAAVJ,QAAU;QAAVA,QAAU;MAAA;;MACf,6BAAoBA,QAApB,+BAA8B;QAAzB,IAAMG,KAAX,gBAAK;;QACH,IAAIL,KAAK,CAACC,OAAND,CAAcK,KAAdL,CAAJ,EAA0B;UACxB,KAAKM,GAAL,gCAAYD,KAAZ;QADF,OAEO;UACL,KAAKH,QAAL,CAAcK,IAAd,CAAmBF,KAAnB;QACD;MACF;;MACD,OAAO,IAAP;IACD;;;WAEDG,gBAAOH,KAAPG,EAAc;MACZ,IAAMN,QAAQ,GAAG,KAAKA,QAAtB;MACA,IAAMO,OAAO,GAAGP,QAAQ,CAACO,OAATP,CAAiBG,KAAjBH,CAAhB;;MACA,IAAIO,OAAO,GAAG,CAAC,CAAf,EAAkB;QAChBP,QAAQ,CAACQ,MAATR,CAAgBO,OAAhBP,EAAyB,CAAzBA;MACD;;MACD,OAAO,IAAP;IACD;;;WAEDS,qBAAY;MACV,KAAKT,QAAL,GAAgB,EAAhB;MACA,OAAO,IAAP;IACD;;;WAEDU,mBAAS;MACP,KAAKV,QAAL,CAAcW,OAAd,CAAsBR,eAAK;QAAA,OAAIA,KAAK,CAACO,MAANP,EAAJ;MAAA,CAA3B;MACA,KAAKM,SAAL;;MACA;IACD;;;WAEDG,kBAASC,OAATD,EAAsD;MAAA,+EAAJ,EAAI;MAAA,4BAAnCE,WAAmC;MAAA,IAAnCA,WAAmC,iCAArB,IAAItB,OAAJ,EAAqB;;MACpD,IAAMuB,WAAW,GAAG,IAAIvB,OAAJ,CAAYsB,WAAZ,EAAyBE,aAAzB,CAAuC,KAAKC,MAA5C,CAApB;;MADoD,2CAGhC,KAAKjB,QAH2B;MAAA;;MAAA;QAGpD,oDAAmC;UAAA,IAAxBG,KAAwB;;UACjC,IAAIA,KAAK,YAAYR,SAArB,EAAgC;YAC9BQ,KAAK,CAACS,QAANT,CAAeU,OAAfV,EAAwB;cAACW,WAAW,EAAEC;YAAd,CAAxBZ;UADF,OAEO;YACLU,OAAO,CAACV,KAAD,EAAQ;cAACW,WAAW,EAAEC;YAAd,CAAR,CAAPF;UACD;QACF;MATmD;QAAA;MAAA;QAAA;MAAA;IAUrD;;;;EAtDoCnB,c;;SAAlBC,S","names":["Matrix4","log","ScenegraphNode","GroupNode","constructor","props","Array","isArray","children","assert","every","child","add","push","remove","indexOf","splice","removeAll","delete","forEach","traverse","visitor","worldMatrix","modelMatrix","multiplyRight","matrix"],"sources":["../../../src/scenegraph/group-node.js"],"sourcesContent":["import {Matrix4} from '@math.gl/core';\nimport {log} from '@luma.gl/webgl';\nimport ScenegraphNode from './scenegraph-node';\n\nexport default class GroupNode extends ScenegraphNode {\n  constructor(props = {}) {\n    props = Array.isArray(props) ? {children: props} : props;\n    const {children = []} = props;\n    log.assert(\n      children.every(child => child instanceof ScenegraphNode),\n      'every child must an instance of ScenegraphNode'\n    );\n    super(props);\n    this.children = children;\n  }\n\n  // Unpacks arrays and nested arrays of children\n  add(...children) {\n    for (const child of children) {\n      if (Array.isArray(child)) {\n        this.add(...child);\n      } else {\n        this.children.push(child);\n      }\n    }\n    return this;\n  }\n\n  remove(child) {\n    const children = this.children;\n    const indexOf = children.indexOf(child);\n    if (indexOf > -1) {\n      children.splice(indexOf, 1);\n    }\n    return this;\n  }\n\n  removeAll() {\n    this.children = [];\n    return this;\n  }\n\n  delete() {\n    this.children.forEach(child => child.delete());\n    this.removeAll();\n    super.delete();\n  }\n\n  traverse(visitor, {worldMatrix = new Matrix4()} = {}) {\n    const modelMatrix = new Matrix4(worldMatrix).multiplyRight(this.matrix);\n\n    for (const child of this.children) {\n      if (child instanceof GroupNode) {\n        child.traverse(visitor, {worldMatrix: modelMatrix});\n      } else {\n        visitor(child, {worldMatrix: modelMatrix});\n      }\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}