{"ast":null,"code":"import _classCallCheck from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _get from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport ComponentState from '../lifecycle/component-state';\n\nvar LayerState = /*#__PURE__*/function (_ComponentState) {\n  _inherits(LayerState, _ComponentState);\n\n  var _super = _createSuper(LayerState);\n\n  function LayerState(_ref) {\n    var _this;\n\n    var attributeManager = _ref.attributeManager,\n        layer = _ref.layer;\n\n    _classCallCheck(this, LayerState);\n\n    _this = _super.call(this, layer);\n\n    _defineProperty(_assertThisInitialized(_this), \"attributeManager\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"needsRedraw\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"subLayers\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"usesPickingColorCache\", void 0);\n\n    _this.attributeManager = attributeManager;\n    _this.needsRedraw = true;\n    _this.subLayers = null;\n    _this.usesPickingColorCache = false;\n    return _this;\n  }\n\n  _createClass(LayerState, [{\n    key: \"layer\",\n    get: function get() {\n      return this.component;\n    },\n    set: function set(layer) {\n      this.component = layer;\n    }\n  }, {\n    key: \"_fetch\",\n    value: function _fetch(propName, url) {\n      var fetch = this.component.props.fetch;\n\n      if (fetch) {\n        return fetch(url, {\n          propName: propName,\n          layer: this.layer\n        });\n      }\n\n      return _get(_getPrototypeOf(LayerState.prototype), \"_fetch\", this).call(this, propName, url);\n    }\n  }, {\n    key: \"_onResolve\",\n    value: function _onResolve(propName, value) {\n      var onDataLoad = this.component.props.onDataLoad;\n\n      if (propName === 'data' && onDataLoad) {\n        onDataLoad(value, {\n          propName: propName,\n          layer: this.layer\n        });\n      }\n    }\n  }, {\n    key: \"_onError\",\n    value: function _onError(propName, error) {\n      this.layer.raiseError(error, \"loading \".concat(propName, \" of \").concat(this.layer));\n    }\n  }]);\n\n  return LayerState;\n}(ComponentState);\n\nexport { LayerState as default };","map":{"version":3,"mappings":";;;;;;;;AAAA,OAAOA,cAAP,MAA2B,8BAA3B;;IAMqBC,U;;;;;EAYnBC,0BAA2F;IAAA;;IAAA,IAA9EC,gBAA8E,QAA9EA,gBAA8E;IAAA,IAA5DC,KAA4D,QAA5DA,KAA4D;;IAAA;;IACzF,0BAAMA,KAAN;;IADyFC;;IAAAA;;IAAAA;;IAAAA;;IAEzF,MAAKF,gBAAL,GAAwBA,gBAAxB;IACA,MAAKG,WAAL,GAAmB,IAAnB;IACA,MAAKC,SAAL,GAAiB,IAAjB;IACA,MAAKC,qBAAL,GAA6B,KAA7B;IALyF;EAM1F;;;;SAEQ,eAAU;MACjB,OAAO,KAAKC,SAAZ;IACD,C;SAEQ,aAACL,KAAD,EAAe;MACtB,KAAKK,SAAL,GAAiBL,KAAjB;IACD;;;WAISM,gBAAOC,QAAPD,EAAiBE,GAAjBF,EAA8B;MACtC,IAAMG,KAAK,GAAG,KAAKJ,SAAL,CAAeK,KAAf,CAAqBD,KAAnC;;MACA,IAAIA,KAAJ,EAAW;QACT,OAAOA,KAAK,CAACD,GAAD,EAAM;UAACD,QAAD,EAACA,QAAD;UAAWP,KAAK,EAAE,KAAKA;QAAvB,CAAN,CAAZ;MACD;;MACD,8EAAoBO,QAApB,EAA8BC,GAA9B;IACD;;;WAESG,oBAAWJ,QAAXI,EAA8BC,KAA9BD,EAA0C;MAClD,IAAME,UAAU,GAAG,KAAKR,SAAL,CAAeK,KAAf,CAAqBG,UAAxC;;MACA,IAAIN,QAAQ,KAAK,MAAbA,IAAuBM,UAA3B,EAAuC;QACrCA,UAAU,CAACD,KAAD,EAAQ;UAACL,QAAD,EAACA,QAAD;UAAWP,KAAK,EAAE,KAAKA;QAAvB,CAAR,CAAVa;MACD;IACF;;;WAESC,kBAASP,QAATO,EAA4BC,KAA5BD,EAA0C;MAClD,KAAKd,KAAL,CAAWgB,UAAX,CAAsBD,KAAtB,oBAAwCR,QAAxC,iBAAuD,KAAKP,KAA5D;IACD;;;;EA/C2DJ,c;;SAAzCC,U","names":["ComponentState","LayerState","constructor","attributeManager","layer","_defineProperty","needsRedraw","subLayers","usesPickingColorCache","component","_fetch","propName","url","fetch","props","_onResolve","value","onDataLoad","_onError","error","raiseError"],"sources":["../../../src/lib/layer-state.ts"],"sourcesContent":["import ComponentState from '../lifecycle/component-state';\n\nimport type Layer from './layer';\nimport type AttributeManager from './attribute/attribute-manager';\nimport {LayerProps} from './layer-props';\n\nexport default class LayerState<T extends LayerProps> extends ComponentState<T> {\n  attributeManager: AttributeManager;\n  needsRedraw: boolean;\n  /**\n   * Sublayers rendered in a previous cycle\n   */\n  subLayers: any;\n  /**\n   * If the layer is using the shared instancedPickingColors buffer\n   */\n  usesPickingColorCache: boolean;\n\n  constructor({attributeManager, layer}: {attributeManager: AttributeManager; layer: Layer}) {\n    super(layer);\n    this.attributeManager = attributeManager;\n    this.needsRedraw = true;\n    this.subLayers = null;\n    this.usesPickingColorCache = false;\n  }\n\n  get layer(): Layer {\n    return this.component as Layer;\n  }\n\n  set layer(layer: Layer) {\n    this.component = layer;\n  }\n\n  /* Override base Component methods with Layer-specific handling */\n\n  protected _fetch(propName, url: string) {\n    const fetch = this.component.props.fetch;\n    if (fetch) {\n      return fetch(url, {propName, layer: this.layer});\n    }\n    return super._fetch(propName, url);\n  }\n\n  protected _onResolve(propName: keyof T, value: any) {\n    const onDataLoad = this.component.props.onDataLoad;\n    if (propName === 'data' && onDataLoad) {\n      onDataLoad(value, {propName, layer: this.layer});\n    }\n  }\n\n  protected _onError(propName: keyof T, error: Error) {\n    this.layer.raiseError(error, `loading ${propName} of ${this.layer}`);\n  }\n}\n"]},"metadata":{},"sourceType":"module"}