{"code":"(this.webpackJsonpcustom_filter=this.webpackJsonpcustom_filter||[]).push([[11],{682:function(e,t,o){\"use strict\";o.d(t,\"a\",(function(){return f}));var r,n=o(10),c=o(3),a=(o(710),o(713),o(714),o(715),o(716),o(718),\"en-US\"),i=function(e){var t=l(e);return{prefix:\"\".concat(t.operation,\" $\"),value:Intl.NumberFormat(a,{maximumFractionDigits:2,minimumFractionDigits:2,notation:\"compact\",compactDisplay:\"short\"}).format(t.value)}},u=function(e){var t=l(e);return t.operation+Intl.NumberFormat(a,{maximumFractionDigits:1,minimumFractionDigits:0,notation:\"compact\",compactDisplay:\"short\"}).format(t.value)},l=function(e){if(!isNaN(e))return{value:e,operation:\"\"};try{var t,o=new RegExp(/([<>]=?)[^$]?(\\d+)/gm).exec(e);return o&&(t=o[1],e=Number(o[2])),isNaN(e)?{value:0,operation:\"\"}:{value:e,operation:t}}catch(r){throw new Error(\"You are using a numberFormatter on a not valid value: \".concat(e))}},s=Object.freeze({CURRENCY:\"currency\",NUMBER:\"number\"}),d=(r={},Object(c.a)(r,s.CURRENCY,(function(e){var t=i(e);return\"\".concat(t.prefix).concat(t.value)})),Object(c.a)(r,s.NUMBER,(function(e){return u(e)})),r),b={type:\"\",columns:[]};function f(e){var t=e.title,o=e.feature,r=e.formatter,c=void 0===r?b:r,a=e.includeColumns,i=void 0===a?\"*\":a,u=e.showColumnName,l=void 0===u||u;if(!o)throw new Error('htmlForFeature needs \"info.object\" information');var f=Object.keys(o.properties);if((null===c||void 0===c||!c.type||null===c||void 0===c||!c.columns||function(e,t){var o=Object.values(s);if(!o.includes(t.type))throw new Error('\"'.concat(t.type,'\" is not supported as formatter, use one of \"').concat(o,'\"'));if(!t.columns||0===t.columns.length)return!0;if(!m(t.columns))throw new Error('\"formatter.columns\" property needs to be an array of strings');var r,c=Object(n.a)(t.columns);try{for(c.s();!(r=c.n()).done;){var a=r.value;if(!e.includes(a)){var i=e.join(\", \");throw new Error('\"formatted.columns\" includes \\''.concat(a,\"' but it was not found!. Available cols are [\").concat(i,\"]\"))}}}catch(u){c.e(u)}finally{c.f()}return!0}(f,c))&&function(e,t){if(\"*\"===t)return!0;if(!m(t))throw new Error('\"includeColumns\" property needs to be an array of existing feature columns or \"*\"');if(m(t)){var o,r=Object(n.a)(t);try{for(r.s();!(o=r.n()).done;){var c=o.value;if(!e.includes(c))throw new Error('colums set in \"includeColumns\" should exist in picked feature')}}catch(a){r.e(a)}finally{r.f()}}return!0}(f,i)){var j=\"\";t&&(j='<h3 style=\"margin: 0\"><strong>'.concat(t,\"</strong></h3>\"));for(var v=0,O=f;v<O.length;v++){var y=O[v];if(\"layerName\"!==y&&(i.includes(y)||\"*\"===i))if(null!==c&&void 0!==c&&c.columns.includes(y))j=p(o,y,l,j,d[c.type]);else j=p(o,y,l,j)}return j}}function p(e,t,o,r){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return e};return r.concat(\"\".concat(o?\"<strong>\".concat(t,\"</strong>: \"):\"\").concat(n(e.properties[t]),\"<br/>\"))}function m(e){return Array.isArray(e)&&e.length&&e.every(String)}},691:function(e,t,o){\"use strict\";o.d(t,\"a\",(function(){return l})),o.d(t,\"b\",(function(){return s}));var r=o(5),n=o(177),c=o(493),a=o(244),i=o(679),u=o(682),l=\"popAggLayer\";function s(){var e=Object(n.useSelector)((function(e){return e.carto.layers})).popAggLayer,t=Object(n.useSelector)((function(t){return Object(a.selectSourceById)(t,null===e||void 0===e?void 0:e.source)})),o=Object(i.useCartoLayerProps)({source:t});if(e&&t)return new c.a(Object(r.a)(Object(r.a)({},o),{},{id:l,getFillColor:[241,109,122],pointRadiusMinPixels:2,getLineColor:[255,0,0],lineWidthMinPixels:1,pickable:!0,visible:!1,onHover:function(e){null!==e&&void 0!==e&&e.object&&(e.object={html:Object(u.a)({feature:e.object}),style:{}})}}))}},694:function(e,t,o){\"use strict\";o.d(t,\"a\",(function(){return s})),o.d(t,\"b\",(function(){return b}));var r=o(5),n=o(177),c=o(493),a=o(244),i=o(679),u=o(682),l=o(695),s=\"populationLayer\",d={title:\"Population\",visible:!0,legend:{}};function b(){var e=Object(n.useSelector)((function(e){return e.carto.layers})).populationLayer,t=Object(n.useSelector)((function(t){return Object(a.selectSourceById)(t,null===e||void 0===e?void 0:e.source)})),o=Object(i.useCartoLayerProps)({source:t}),b=Object(n.useDispatch)();if(e&&t)return new c.a(Object(r.a)(Object(r.a)({},o),{},{id:s,getFillColor:[217,219,94],pointRadiusMinPixels:.8,getLineColor:[0,0,0],lineWidthMinPixels:1,pickable:!0,parameters:{blendFunc:[l.default.SRC_ALPHA,l.default.DST_ALPHA],blendEquation:l.default.FUNC_ADD},visible:e.visible,onDataLoad:function(e){b(Object(a.updateLayer)({id:s,layerAttributes:Object(r.a)({},d)})),o.onDataLoad(e)},onHover:function(e){null!==e&&void 0!==e&&e.object&&(e.object={html:Object(u.a)({feature:e.object}),style:{}})}}))}},696:function(e,t,o){\"use strict\";o.d(t,\"a\",(function(){return l})),o.d(t,\"b\",(function(){return d}));var r=o(5),n=o(177),c=o(493),a=o(244),i=o(679),u=o(682),l=\"countiesLayer\",s={title:\"Counties\",visible:!0,legend:{}};function d(){var e=Object(n.useSelector)((function(e){return e.carto.layers})).countiesLayer,t=Object(n.useSelector)((function(t){return Object(a.selectSourceById)(t,null===e||void 0===e?void 0:e.source)})),o=Object(i.useCartoLayerProps)({source:t}),d=Object(n.useDispatch)();if(e&&t)return new c.a(Object(r.a)(Object(r.a)({},o),{},{id:l,getFillColor:[195,199,198,0],pointRadiusMinPixels:1,getLineColor:[195,199,198],lineWidthMinPixels:.3,pickable:!0,visible:e.visible,onDataLoad:function(e){d(Object(a.updateLayer)({id:l,layerAttributes:Object(r.a)({},s)})),o.onDataLoad(e)},onHover:function(e){null!==e&&void 0!==e&&e.object&&(e.object={html:Object(u.a)({feature:e.object}),style:{}})}}))}},733:function(e,t){},842:function(e,t,o){\"use strict\";o.r(t),o.d(t,\"default\",(function(){return w}));var r=o(0),n=o(29),c={id:\"popAggSource\",type:n.h.TILESET,connection:\"tehren\",data:\"cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_agg_tileset\"},a=o(691),i={id:\"populationSource\",type:n.h.TILESET,connection:\"tehren\",data:\"cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_tileset\"},u=o(694),l={id:\"countiesSource\",type:n.h.TABLE,connection:\"tehren\",data:\"cartodb-gcp-solutions-eng-team.tomas_data.usa_counties\"},s=o(696),d=o(177),b=o(244),f=o(497),p=o(646),m=o(305),j=o(5),v=o(12),O=o(19),y=o(376),g=o(685);var h=o(24),S=[];function C(e){var t=e.id,o=e.title,n=e.dataSource,c=e.column,a=e.operationColumn,i=e.operation,u=e.formatter,l=e.labels,s=e.animation,f=e.filterable,p=e.searchable,C=e.onError,L=e.wrapperProps,E=e.noDataAlertProps,w=e.otherSources,F=Object(d.useDispatch)(),N=Object(d.useSelector)((function(e){return[].concat(Object(O.a)(w.map((function(e){return e.id}))),[n]).map((function(t){return Object(b.selectAreFeaturesReadyForSource)(e,t)})).every((function(e){return!0===e}))})),x=Object(r.useState)([]),A=Object(v.a)(x,2),D=A[0],P=A[1],_=Object(r.useState)(!0),T=Object(v.a)(_,2),I=T[0],M=T[1],R=Object(g.useSourceFilters)({dataSource:n,id:t}),U=function(e){var t=e.dataSource,o=e.id,n=e.column,c=e.type,a=Object(d.useSelector)((function(e){return Object(b.selectSourceById)(e,t)||{}})).filters;return Object(r.useMemo)((function(){var e,t=null===a||void 0===a||null===(e=a[n])||void 0===e?void 0:e[c];return t&&t.owner===o?t.values:null}),[a,n,c,o])}({dataSource:n,id:t,column:c,type:m._FilterTypes.IN})||S;Object(r.useEffect)((function(){M(!0),N&&Object(g.getCategories)({column:c,operationColumn:a,operation:i,filters:R,dataSource:n}).then((function(e){e&&(M(!1),P(e))})).catch((function(e){M(!1),C&&C(e)}))}),[t,c,a,i,R,n,M,C,N]);var k=Object(r.useCallback)((function(e){e&&e.length?(F(Object(b.addFilter)({id:n,column:c,type:m._FilterTypes.IN,values:e,owner:t})),w.forEach((function(o){F(Object(b.addFilter)({id:o.id,column:o.column,type:m._FilterTypes.IN,values:e,owner:t}))}))):(F(Object(b.removeFilter)({id:n,column:c})),w.forEach((function(e){F(Object(b.removeFilter)({id:e.id,column:e.column}))})))}),[c,n,t,F]);return Object(h.jsx)(y.WrapperWidgetUI,Object(j.a)(Object(j.a)({title:o,isLoading:I},L),{},{children:D.length||I?Object(h.jsx)(y.CategoryWidgetUI,{data:D,formatter:u,labels:l,selectedCategories:U,onSelectedCategoriesChange:k,animation:s,filterable:f,searchable:p}):Object(h.jsx)(y.NoDataAlert,Object(j.a)({},E))}))}C.defaultProps={labels:{},animation:!0,filterable:!0,searchable:!0,wrapperProps:{},noDataAlertProps:{}};var L=C,E=Object(f.a)((function(){return{filters:{}}}));function w(){var e=Object(d.useDispatch)(),t=E();Object(r.useEffect)((function(){return e(Object(b.addSource)(i)),e(Object(b.addLayer)({id:u.a,source:i.id})),function(){e(Object(b.removeLayer)(u.a)),e(Object(b.removeSource)(i.id))}}),[e]),Object(r.useEffect)((function(){return e(Object(b.addSource)(l)),e(Object(b.addLayer)({id:s.a,source:l.id})),function(){e(Object(b.removeLayer)(s.a)),e(Object(b.removeSource)(l.id))}}),[e]),Object(r.useEffect)((function(){return e(Object(b.addSource)(c)),e(Object(b.addLayer)({id:a.a,source:c.id})),function(){e(Object(b.removeLayer)(a.a)),e(Object(b.removeSource)(c.id))}}),[e]);return Object(h.jsx)(p.a,{container:!0,direction:\"column\",className:t.filters,children:Object(h.jsxs)(p.a,{item:!0,children:[Object(h.jsx)(g.FormulaWidget,{id:\"totPop\",title:\"Total Population\",dataSource:c.id,column:\"aggregated_total\",operation:m.AggregationTypes.SUM,formatter:function(e){return(t=e)>1e6?\"\".concat(Math.round(t/1e6,2),\" M\"):t>1e3?\"\".concat(Math.round(t/1e3,2),\" k\"):\"\".concat(t);var t},onError:console.error}),Object(h.jsx)(L,{id:\"stateCategory\",title:\"State Name\",dataSource:l.id,column:\"state\",operation:m.AggregationTypes.COUNT,onError:console.error,otherSources:[{id:i.id,column:\"state\"},{id:c.id,column:\"state\"}]}),Object(h.jsx)(L,{id:\"countyCategory\",title:\"County Name\",dataSource:l.id,column:\"county\",operation:m.AggregationTypes.COUNT,onError:console.error,otherSources:[{id:i.id,column:\"county\"},{id:c.id,column:\"county\"}]})]})})}}}]);","name":"static/js/11.2821c129.chunk.js","map":{"version":3,"sources":["static/js/11.2821c129.chunk.js"],"names":["this","push","module","__webpack_exports__","__webpack_require__","d","htmlForFeature","_formatterFunctions","createForOfIteratorHelper","defineProperty","DEFAULT_LOCALE","currencyFormatter","value","_value","parseLogicalOperation","prefix","concat","operation","Intl","NumberFormat","maximumFractionDigits","minimumFractionDigits","notation","compactDisplay","format","numberFormatter","isNaN","match","RegExp","exec","Number","_unused","Error","FORMATTER_TYPES","Object","freeze","CURRENCY","NUMBER","formatterFunctions","formatted","DEFAULT_FORMATTER","type","columns","_ref","title","feature","_ref$formatter","formatter","_ref$includeColumns","includeColumns","_ref$showColumnName","showColumnName","propertyNames","keys","properties","supportedTypes","values","includes","length","isArrayOfStrings","_step","_iterator","s","n","done","column","available","join","err","e","f","isFormatterValid","_step2","_iterator2","includedColumnsAreValid","html","_i","_propertyNames","name","generateHtml","propertyName","formatterFunction","arguments","undefined","v","Array","isArray","every","String","POP_AGG_LAYER_ID","PopAggLayer","_Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__","react_redux__WEBPACK_IMPORTED_MODULE_1__","_deck_gl_carto__WEBPACK_IMPORTED_MODULE_2__","_carto_react_redux__WEBPACK_IMPORTED_MODULE_3__","_carto_react_api__WEBPACK_IMPORTED_MODULE_4__","utils_htmlForFeature__WEBPACK_IMPORTED_MODULE_5__","popAggLayer","state","carto","layers","source","cartoLayerProps","id","getFillColor","pointRadiusMinPixels","getLineColor","lineWidthMinPixels","pickable","visible","onHover","info","object","style","POPULATION_LAYER_ID","PopulationLayer","_luma_gl_constants__WEBPACK_IMPORTED_MODULE_6__","layerConfig","legend","populationLayer","dispatch","parameters","blendFunc","SRC_ALPHA","DST_ALPHA","blendEquation","FUNC_ADD","onDataLoad","data","layerAttributes","COUNTIES_LAYER_ID","CountiesLayer","countiesLayer","exports","r","Filters","react","maps_api_common","popAggSource","TILESET","connection","populationSource","countiesSource","TABLE","es","dist","makeStyles","Grid","react_core_dist","objectSpread2","slicedToArray","toConsumableArray","react_ui_dist","react_widgets_dist","jsx_runtime","EMPTY_ARRAY","CustomCategoryWidget","props","dataSource","operationColumn","labels","animation","filterable","searchable","onError","wrapperProps","noDataAlertProps","otherSources","isSourceReady","map","_useState","_useState2","categoryData","setCategoryData","_useState3","_useState4","isLoading","setIsLoading","filters","selectedCategories","_filters$column","filter","owner","useWidgetFilterValues","IN","then","catch","error","handleSelectedCategoriesChange","categories","forEach","children","onSelectedCategoriesChange","defaultProps","widgets_CustomCategoryWidget","useStyles","classes","container","direction","className","item","SUM","Math","round","console","COUNT"],"mappings":"CAACA,KAAgC,0BAAIA,KAAgC,2BAAK,IAAIC,KAAK,CAAC,CAAC,IAAI,CAEnF,IACA,SAAUC,EAAQC,EAAqBC,GAE7C,aAGAA,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAqBG,KAGlF,IAiCIC,EAjCAC,EAA4BJ,EAAoB,IAGhDK,EAAiBL,EAAoB,GA0BnCM,GAvBSN,EAAoB,KAGKA,EAAoB,KAG5BA,EAAoB,KAG3CA,EAAoB,KAGIA,EAAoB,KAGhCA,EAAoB,KAQpB,SAA6LO,EAAkB,SAA2BC,GAAO,IAAIC,EAAOC,EAAsBF,GAAO,MAAM,CAACG,OAAO,GAAGC,OAAOH,EAAOI,UAAU,MAAML,MAAMM,KAAKC,aAAaT,EAAe,CAACU,sBAAsB,EAAEC,sBAAsB,EAAEC,SAAS,UAAUC,eAAe,UAAUC,OAAOX,EAAOD,SAAca,EAAgB,SAAyBb,GAAO,IAAIC,EAAOC,EAAsBF,GAAO,OAAOC,EAAOI,UAAUC,KAAKC,aAAaT,EAAe,CAACU,sBAAsB,EAAEC,sBAAsB,EAAEC,SAAS,UAAUC,eAAe,UAAUC,OAAOX,EAAOD,QAAkSE,EAAsB,SAA+BF,GAAO,IAAIc,MAAMd,GAAO,MAAM,CAACA,MAAMA,EAAMK,UAAU,IAAI,IACzoC,IACsFA,EAA7BU,EAA9C,IAAIC,OADmB,wBACoCC,KAAKjB,GAA0E,OAAlDe,IAAOV,EAAUU,EAAM,GAAGf,EAAMkB,OAAOH,EAAM,KAAYD,MAAMd,GAAO,CAACA,MAAM,EAAEK,UAAU,IAAI,CAACL,MAAMA,EAAMK,UAAUA,GAAY,MAAMc,GAAS,MAAM,IAAIC,MAAM,yDAAyDhB,OAAOJ,MAEtSqB,EAAgBC,OAAOC,OAAO,CAACC,SAAS,WAAWC,OAAO,WAAeC,GAAoB/B,EAAoB,GAAG2B,OAAOzB,EAAgC,EAAvCyB,CAA0C3B,EAAoB0B,EAAgBG,UAAS,SAASxB,GAAO,IAAI2B,EAAU5B,EAAkBC,GAAO,MAAM,GAAGI,OAAOuB,EAAUxB,QAAQC,OAAOuB,EAAU3B,UAAUsB,OAAOzB,EAAgC,EAAvCyB,CAA0C3B,EAAoB0B,EAAgBI,QAAO,SAASzB,GAAO,OAAOa,EAAgBb,MAAUL,GAAyBiC,EAAkB,CAACC,KAAK,GAAGC,QAAQ,IAAI,SAASpC,EAAeqC,GAAM,IAAIC,EAAMD,EAAKC,MAAMC,EAAQF,EAAKE,QAAQC,EAAeH,EAAKI,UAAUA,OAA2B,IAAjBD,EAAwBN,EAAkBM,EAAeE,EAAoBL,EAAKM,eAAeA,OAAqC,IAAtBD,EAA6B,IAAIA,EAAoBE,EAAoBP,EAAKQ,eAAeA,OAAqC,IAAtBD,GAAkCA,EAAoB,IAAIL,EAAS,MAAM,IAAIb,MAAM,kDAAqD,IAAIoB,EAAclB,OAAOmB,KAAKR,EAAQS,YAAY,IAAe,OAAZP,QAA8B,IAAZA,IAAoBA,EAAUN,MAAkB,OAAZM,QAA8B,IAAZA,IAAoBA,EAAUL,SAAg/B,SAA0BY,EAAWP,GAAW,IAAIQ,EAAerB,OAAOsB,OAAOvB,GAAiB,IAAIsB,EAAeE,SAASV,EAAUN,MAAO,MAAM,IAAIT,MAAM,IAAKhB,OAAO+B,EAAUN,KAAK,iDAAmDzB,OAAOuC,EAAe,MAAQ,IAAIR,EAAUL,SAAoC,IAA3BK,EAAUL,QAAQgB,OAAW,OAAO,EAAK,IAAIC,EAAiBZ,EAAUL,SAAU,MAAM,IAAIV,MAAM,gEAAmE,IAAsF4B,EAAlFC,EAAU3B,OAAO1B,EAA2C,EAAlD0B,CAAqDa,EAAUL,SAAe,IAAI,IAAImB,EAAUC,MAAMF,EAAMC,EAAUE,KAAKC,MAAM,CAAC,IAAIC,EAAOL,EAAMhD,MAAM,IAAI0C,EAAWG,SAASQ,GAAQ,CAAC,IAAIC,EAAUZ,EAAWa,KAAK,MAAM,MAAM,IAAInC,MAAM,kCAAmChB,OAAOiD,EAAO,iDAAiDjD,OAAOkD,EAAU,QAAS,MAAME,GAAKP,EAAUQ,EAAED,GAAM,QAAQP,EAAUS,IAAK,OAAO,EAAh2DC,CAAiBnB,EAAcL,KAAu0D,SAAiCO,EAAWL,GAAgB,GAAoB,MAAjBA,EAAsB,OAAO,EAAM,IAAIU,EAAiBV,GAAiB,MAAM,IAAIjB,MAAM,qFAA0F,GAAG2B,EAAiBV,GAAgB,CAAC,IAAoFuB,EAAhFC,EAAWvC,OAAO1B,EAA2C,EAAlD0B,CAAqDe,GAAuB,IAAI,IAAIwB,EAAWX,MAAMU,EAAOC,EAAWV,KAAKC,MAAM,CAAC,IAAIC,EAAOO,EAAO5D,MAAM,IAAI0C,EAAWG,SAASQ,GAAS,MAAM,IAAIjC,MAAM,kEAAoE,MAAMoC,GAAKK,EAAWJ,EAAED,GAAM,QAAQK,EAAWH,KAAM,OAAO,EAAn6EI,CAAwBtB,EAAcH,GAA1C,CAAmE,IAAI0B,EAAK,GAAM/B,IAAO+B,EAAK,iCAAmC3D,OAAO4B,EAAM,mBAAmB,IAAI,IAAIgC,EAAG,EAAEC,EAAezB,EAAcwB,EAAGC,EAAenB,OAAOkB,IAAK,CAAC,IAAIE,EAAKD,EAAeD,GAAI,GAAU,cAAPE,IAAqB7B,EAAeQ,SAASqB,IAAwB,MAAjB7B,GAAuB,GAAe,OAAZF,QAA8B,IAAZA,GAAoBA,EAAUL,QAAQe,SAASqB,GAAgEH,EAAKI,EAAalC,EAAQiC,EAAK3B,EAAewB,EAAjFrC,EAAmBS,EAAUN,YAAkFkC,EAAKI,EAAalC,EAAQiC,EAAK3B,EAAewB,GAAS,OAAOA,GAAM,SAASI,EAAalC,EAAQmC,EAAa7B,EAAewB,GAAM,IAAIM,EAAkBC,UAAUxB,OAAO,QAAkByB,IAAfD,UAAU,GAAeA,UAAU,GAAG,SAASE,GAAG,OAAOA,GAAI,OAAOT,EAAK3D,OAAO,GAAGA,OAAOmC,EAAe,WAAWnC,OAAOgE,EAAa,eAAe,IAAIhE,OAAOiE,EAAkBpC,EAAQS,WAAW0B,IAAe,UAAqgD,SAASrB,EAAiB/C,GAAO,OAAOyE,MAAMC,QAAQ1E,IAAQA,EAAM8C,QAAQ9C,EAAM2E,MAAMC,UAI5sH,IACA,SAAUtF,EAAQC,EAAqBC,GAE7C,aAC+BA,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOsF,KACpErF,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOuF,KAC9E,IAAIC,EAA0JvF,EAAoB,GAC9KwF,EAA2CxF,EAAoB,KAC/DyF,EAA8CzF,EAAoB,KAClE0F,EAAkD1F,EAAoB,KAEtE2F,EAAgD3F,EAAoB,KAEpE4F,EAAoD5F,EAAoB,KAC7FqF,EAAiB,cAAc,SAASC,IAAc,IAA8HO,EAA7G/D,OAAO0D,EAAsD,YAA7D1D,EAAgE,SAASgE,GAAO,OAAOA,EAAMC,MAAMC,UAAmCH,YAAgBI,EAAOnE,OAAO0D,EAAsD,YAA7D1D,EAAgE,SAASgE,GAAO,OAAOhE,OAAO4D,EAAkE,iBAAzE5D,CAA4EgE,EAAoB,OAAdD,QAAkC,IAAdA,OAAqB,EAAOA,EAAYI,WAAeC,EAAgBpE,OAAO6D,EAAkE,mBAAzE7D,CAA4E,CAACmE,OAAOA,IAAS,GAAGJ,GAAaI,EAAQ,OAAO,IAAIR,EAA6D,EAAE3D,OAAOyD,EAAyK,EAAhLzD,CAAmLA,OAAOyD,EAAyK,EAAhLzD,CAAmL,GAAGoE,GAAiB,GAAG,CAACC,GAAGd,EAAiBe,aAAa,CAAC,IAAI,IAAI,KAAKC,qBAAqB,EAAEC,aAAa,CAAC,IAAI,EAAE,GAAGC,mBAAmB,EAAEC,UAAS,EAAKC,SAAQ,EAAMC,QAAQ,SAAiBC,GAAgB,OAAPA,QAAoB,IAAPA,GAAeA,EAAKC,SAAQD,EAAKC,OAAO,CAACrC,KAAKzC,OAAO8D,EAAmE,EAA1E9D,CAA6E,CAACW,QAAQkE,EAAKC,SAASC,MAAM,WAIx3C,IACA,SAAU/G,EAAQC,EAAqBC,GAE7C,aAC+BA,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAO+G,KACpE9G,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOgH,KAC9E,IAAIxB,EAA0JvF,EAAoB,GAC9KwF,EAA2CxF,EAAoB,KAC/DyF,EAA8CzF,EAAoB,KAClE0F,EAAkD1F,EAAoB,KAEtE2F,EAAgD3F,EAAoB,KAEpE4F,EAAoD5F,EAAoB,KACxEgH,EAAkDhH,EAAoB,KAC3F8G,EAAoB,kBAAsBG,EAAY,CAACzE,MAAM,aAAaiE,SAAQ,EAAKS,OAAO,IAAI,SAASH,IAAkB,IAA8HI,EAA7GrF,OAAO0D,EAAsD,YAA7D1D,EAAgE,SAASgE,GAAO,OAAOA,EAAMC,MAAMC,UAAuCmB,gBAAoBlB,EAAOnE,OAAO0D,EAAsD,YAA7D1D,EAAgE,SAASgE,GAAO,OAAOhE,OAAO4D,EAAkE,iBAAzE5D,CAA4EgE,EAAwB,OAAlBqB,QAA0C,IAAlBA,OAAyB,EAAOA,EAAgBlB,WAAeC,EAAgBpE,OAAO6D,EAAkE,mBAAzE7D,CAA4E,CAACmE,OAAOA,IAAamB,EAAStF,OAAO0D,EAAsD,YAA7D1D,GAAkE,GAAGqF,GAAiBlB,EAAQ,OAAO,IAAIR,EAA6D,EAAE3D,OAAOyD,EAAyK,EAAhLzD,CAAmLA,OAAOyD,EAAyK,EAAhLzD,CAAmL,GAAGoE,GAAiB,GAAG,CAACC,GAAGW,EAAoBV,aAAa,CAAC,IAAI,IAAI,IAAIC,qBAAqB,GAAIC,aAAa,CAAC,EAAE,EAAE,GAAGC,mBAAmB,EAAEC,UAAS,EAAKa,WAAW,CAACC,UAAU,CAACN,EAAyD,QAAEO,UAAUP,EAAyD,QAAEQ,WAAWC,cAAcT,EAAyD,QAAEU,UAAUjB,QAAQU,EAAgBV,QAAQkB,WAAW,SAAoBC,GAAMR,EAAStF,OAAO4D,EAA6D,YAApE5D,CAAuE,CAACqE,GAAGW,EAAoBe,gBAAgB/F,OAAOyD,EAAyK,EAAhLzD,CAAmL,GAAGmF,MAAgBf,EAAgByB,WAAWC,IAAQlB,QAAQ,SAAiBC,GAAgB,OAAPA,QAAoB,IAAPA,GAAeA,EAAKC,SAAQD,EAAKC,OAAO,CAACrC,KAAKzC,OAAO8D,EAAmE,EAA1E9D,CAA6E,CAACW,QAAQkE,EAAKC,SAASC,MAAM,WAIrrE,IACA,SAAU/G,EAAQC,EAAqBC,GAE7C,aAC+BA,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAO+H,KACpE9H,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOgI,KAC9E,IAAIxC,EAA0JvF,EAAoB,GAC9KwF,EAA2CxF,EAAoB,KAC/DyF,EAA8CzF,EAAoB,KAClE0F,EAAkD1F,EAAoB,KAEtE2F,EAAgD3F,EAAoB,KAEpE4F,EAAoD5F,EAAoB,KAC7F8H,EAAkB,gBAAoBb,EAAY,CAACzE,MAAM,WAAWiE,SAAQ,EAAKS,OAAO,IAAI,SAASa,IAAgB,IAA8HC,EAA7GlG,OAAO0D,EAAsD,YAA7D1D,EAAgE,SAASgE,GAAO,OAAOA,EAAMC,MAAMC,UAAqCgC,cAAkB/B,EAAOnE,OAAO0D,EAAsD,YAA7D1D,EAAgE,SAASgE,GAAO,OAAOhE,OAAO4D,EAAkE,iBAAzE5D,CAA4EgE,EAAsB,OAAhBkC,QAAsC,IAAhBA,OAAuB,EAAOA,EAAc/B,WAAeC,EAAgBpE,OAAO6D,EAAkE,mBAAzE7D,CAA4E,CAACmE,OAAOA,IAAamB,EAAStF,OAAO0D,EAAsD,YAA7D1D,GAAkE,GAAGkG,GAAe/B,EAAQ,OAAO,IAAIR,EAA6D,EAAE3D,OAAOyD,EAAyK,EAAhLzD,CAAmLA,OAAOyD,EAAyK,EAAhLzD,CAAmL,GAAGoE,GAAiB,GAAG,CAACC,GAAG2B,EAAkB1B,aAAa,CAAC,IAAI,IAAI,IAAI,GAAGC,qBAAqB,EAAEC,aAAa,CAAC,IAAI,IAAI,KAAKC,mBAAmB,GAAIC,UAAS,EAAKC,QAAQuB,EAAcvB,QAAQkB,WAAW,SAAoBC,GAAMR,EAAStF,OAAO4D,EAA6D,YAApE5D,CAAuE,CAACqE,GAAG2B,EAAkBD,gBAAgB/F,OAAOyD,EAAyK,EAAhLzD,CAAmL,GAAGmF,MAAgBf,EAAgByB,WAAWC,IAAQlB,QAAQ,SAAiBC,GAAgB,OAAPA,QAAoB,IAAPA,GAAeA,EAAKC,SAAQD,EAAKC,OAAO,CAACrC,KAAKzC,OAAO8D,EAAmE,EAA1E9D,CAA6E,CAACW,QAAQkE,EAAKC,SAASC,MAAM,WAI/6D,IACA,SAAU/G,EAAQmI,KAMlB,IACA,SAAUnI,EAAQC,EAAqBC,GAE7C,aAEAA,EAAoBkI,EAAEnI,GAGtBC,EAAoBC,EAAEF,EAAqB,WAAW,WAAa,OAAqBoI,KAGxF,IAAIC,EAAQpI,EAAoB,GAG5BqI,EAAkBrI,EAAoB,IAmCqLsI,EAAnM,CAACnC,GAhCP,eAgC4B9D,KAAKgG,EAAmC,EAAEE,QAAQC,WAAW,SAASZ,KAAK,iEAEzHtC,EAActF,EAAoB,KAwByMyI,EAAlM,CAACtC,GArBrB,mBAqB6C9D,KAAKgG,EAAmC,EAAEE,QAAQC,WAAW,SAASZ,KAAK,6DAE7Ib,EAAkB/G,EAAoB,KAc6L0I,EAA3L,CAACvC,GAXtB,iBAW4C9D,KAAKgG,EAAmC,EAAEM,MAAMH,WAAW,SAASZ,KAAK,0DAExIG,EAAgB/H,EAAoB,KAGpC4I,EAAK5I,EAAoB,KAGzB6I,EAAO7I,EAAoB,KAG3B8I,EAAa9I,EAAoB,KAGjC+I,EAAO/I,EAAoB,KAG3BgJ,EAAkBhJ,EAAoB,KAGtCiJ,EAAgBjJ,EAAoB,GAGpCkJ,EAAgBlJ,EAAoB,IAGpCmJ,EAAoBnJ,EAAoB,IAGxCoJ,EAAgBpJ,EAAoB,KAGpCqJ,EAAqBrJ,EAAoB,KAa7C,IAAIsJ,EAActJ,EAAoB,IAGlCuJ,EAAY,GAkBb,SAASC,EAAqBC,GAAO,IAAItD,EAAGsD,EAAMtD,GAAG3D,EAAMiH,EAAMjH,MAAMkH,EAAWD,EAAMC,WAAW7F,EAAO4F,EAAM5F,OAAO8F,EAAgBF,EAAME,gBAAgB9I,EAAU4I,EAAM5I,UAAU8B,EAAU8G,EAAM9G,UAAUiH,EAAOH,EAAMG,OAAOC,EAAUJ,EAAMI,UAAUC,EAAWL,EAAMK,WAAWC,EAAWN,EAAMM,WAAWC,EAAQP,EAAMO,QAAQC,EAAaR,EAAMQ,aAAaC,EAAiBT,EAAMS,iBAAiBC,EAAaV,EAAMU,aAAiB/C,EAAStF,OAAO8G,EAAgB,YAAvB9G,GAAgCsI,EAActI,OAAO8G,EAAgB,YAAvB9G,EAA0B,SAASgE,GAAoP,MAAjO,GAAGlF,OAAOkB,OAAOqH,EAAmC,EAA1CrH,CAA6CqI,EAAaE,KAAI,SAASpG,GAAG,OAAOA,EAAEkC,OAAO,CAACuD,IAAyCW,KAAI,SAASpG,GAAG,OAAOnC,OAAO+G,EAAsC,gCAA7C/G,CAAgDgE,EAAM7B,MAA6BkB,OAAM,SAASH,GAAG,OAAW,IAAJA,QAAmBsF,EAAUxI,OAAOsG,EAAgB,SAAvBtG,CAA0B,IAAIyI,EAAWzI,OAAOoH,EAA+B,EAAtCpH,CAAyCwI,EAAU,GAAGE,EAAaD,EAAW,GAAGE,EAAgBF,EAAW,GAAOG,EAAW5I,OAAOsG,EAAgB,SAAvBtG,EAA0B,GAAM6I,EAAW7I,OAAOoH,EAA+B,EAAtCpH,CAAyC4I,EAAW,GAAGE,EAAUD,EAAW,GAAGE,EAAaF,EAAW,GAAOG,EAAQhJ,OAAOuH,EAAqC,iBAA5CvH,CAA+C,CAAC4H,WAAWA,EAAWvD,GAAGA,IAAS4E,EAvB9uC,SAA+BxI,GAAM,IAAImH,EAAWnH,EAAKmH,WAAWvD,EAAG5D,EAAK4D,GAAGtC,EAAOtB,EAAKsB,OAAOxB,EAAKE,EAAKF,KAAiIyI,EAA3GhJ,OAAO8G,EAAgB,YAAvB9G,EAA0B,SAASgE,GAAO,OAAOhE,OAAO+G,EAAuB,iBAA9B/G,CAAiCgE,EAAM4D,IAAa,MAA2BoB,QAAQ,OAAOhJ,OAAOsG,EAAe,QAAtBtG,EAAyB,WAAW,IAAIkJ,EAAoBC,EAAiB,OAAVH,QAA0B,IAAVA,GAA4D,QAAnCE,EAAgBF,EAAQjH,UAAmC,IAAlBmH,OAAjD,EAAiFA,EAAgB3I,GAAM,OAAI4I,GAAQA,EAAOC,QAAQ/E,EAAwB8E,EAAO7H,OAApB,OAA6B,CAAC0H,EAAQjH,EAAOxB,EAAK8D,IAuB6sBgF,CAAsB,CAACzB,WAAWA,EAAWvD,GAAGA,EAAGtC,OAAOA,EAAOxB,KAAK2G,EAA8B,aAAEoC,MAAM7B,EAAYzH,OAAOsG,EAAiB,UAAxBtG,EAA2B,WAAW+I,GAAa,GAAST,GAAetI,OAAOuH,EAAkC,cAAzCvH,CAA4C,CAAC+B,OAAOA,EAAO8F,gBAAgBA,EAAgB9I,UAAUA,EAAUiK,QAAQA,EAAQpB,WAAWA,IAAa2B,MAAK,SAASzD,GAASA,IAAMiD,GAAa,GAAOJ,EAAgB7C,OAAU0D,OAAM,SAASC,GAAOV,GAAa,GAAUb,GAAQA,EAAQuB,QAAa,CAACpF,EAAGtC,EAAO8F,EAAgB9I,EAAUiK,EAAQpB,EAAWmB,EAAab,EAAQI,IAAgB,IAAIoB,EAA+B1J,OAAOsG,EAAmB,YAA1BtG,EAA6B,SAAS2J,GAAeA,GAAYA,EAAWnI,QAAQ8D,EAAStF,OAAO+G,EAAgB,UAAvB/G,CAA0B,CAACqE,GAAGuD,EAAW7F,OAAOA,EAAOxB,KAAK2G,EAA8B,aAAEoC,GAAGhI,OAAOqI,EAAWP,MAAM/E,KAAMgE,EAAauB,SAAQ,SAASzH,GAAGmD,EAAStF,OAAO+G,EAAgB,UAAvB/G,CAA0B,CAACqE,GAAGlC,EAAEkC,GAAGtC,OAAOI,EAAEJ,OAAOxB,KAAK2G,EAA8B,aAAEoC,GAAGhI,OAAOqI,EAAWP,MAAM/E,UAAeiB,EAAStF,OAAO+G,EAAmB,aAA1B/G,CAA6B,CAACqE,GAAGuD,EAAW7F,OAAOA,KAAUsG,EAAauB,SAAQ,SAASzH,GAAGmD,EAAStF,OAAO+G,EAAmB,aAA1B/G,CAA6B,CAACqE,GAAGlC,EAAEkC,GAAGtC,OAAOI,EAAEJ,gBAAgB,CAACA,EAAO6F,EAAWvD,EAAGiB,IAAW,OAAmBtF,OAAOwH,EAAiB,IAAxBxH,CAA2BsH,EAA+B,gBAAEtH,OAAOmH,EAA+B,EAAtCnH,CAAyCA,OAAOmH,EAA+B,EAAtCnH,CAAyC,CAACU,MAAMA,EAAMoI,UAAUA,GAAWX,GAAc,GAAG,CAAC0B,SAASnB,EAAalH,QAAQsH,EAAuB9I,OAAOwH,EAAiB,IAAxBxH,CAA2BsH,EAAgC,iBAAE,CAACxB,KAAK4C,EAAa7H,UAAUA,EAAUiH,OAAOA,EAAOmB,mBAAmBA,EAAmBa,2BAA2BJ,EAA+B3B,UAAUA,EAAUC,WAAWA,EAAWC,WAAWA,IAA0BjI,OAAOwH,EAAiB,IAAxBxH,CAA2BsH,EAA2B,YAAEtH,OAAOmH,EAA+B,EAAtCnH,CAAyC,GAAGoI,OAAuBV,EAAqBqC,aAAa,CAACjC,OAAO,GAAGC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKE,aAAa,GAAGC,iBAAiB,IAAiC,IAAI4B,EAA+B,EAG5yGC,EAAUjK,OAAOgH,EAA4B,EAAnChH,EAAsC,WAAW,MAAM,CAACgJ,QAAQ,OAAO,SAAS3C,IAAU,IAAIf,EAAStF,OAAO8G,EAAgB,YAAvB9G,GAAgCkK,EAAQD,IAAYjK,OAAOsG,EAAiB,UAAxBtG,EAA2B,WAAoL,OAAzKsF,EAAStF,OAAO+G,EAAgB,UAAvB/G,CAA0B2G,IAAmBrB,EAAStF,OAAO+G,EAAe,SAAtB/G,CAAyB,CAACqE,GAAGY,EAA6C,EAAEd,OAAOwC,EAAiBtC,MAAa,WAAWiB,EAAStF,OAAO+G,EAAkB,YAAzB/G,CAA4BiF,EAA6C,IAAIK,EAAStF,OAAO+G,EAAmB,aAA1B/G,CAA6B2G,EAAiBtC,QAAS,CAACiB,IAAWtF,OAAOsG,EAAiB,UAAxBtG,EAA2B,WAA4K,OAAjKsF,EAAStF,OAAO+G,EAAgB,UAAvB/G,CAA0B4G,IAAiBtB,EAAStF,OAAO+G,EAAe,SAAtB/G,CAAyB,CAACqE,GAAG4B,EAAyC,EAAE9B,OAAOyC,EAAevC,MAAa,WAAWiB,EAAStF,OAAO+G,EAAkB,YAAzB/G,CAA4BiG,EAAyC,IAAIX,EAAStF,OAAO+G,EAAmB,aAA1B/G,CAA6B4G,EAAevC,QAAS,CAACiB,IAAWtF,OAAOsG,EAAiB,UAAxBtG,EAA2B,WAAqK,OAA1JsF,EAAStF,OAAO+G,EAAgB,UAAvB/G,CAA0BwG,IAAelB,EAAStF,OAAO+G,EAAe,SAAtB/G,CAAyB,CAACqE,GAAGb,EAAsC,EAAEW,OAAOqC,EAAanC,MAAa,WAAWiB,EAAStF,OAAO+G,EAAkB,YAAzB/G,CAA4BwD,EAAsC,IAAI8B,EAAStF,OAAO+G,EAAmB,aAA1B/G,CAA6BwG,EAAanC,QAAS,CAACiB,IACrjC,OAAmBtF,OAAOwH,EAAiB,IAAxBxH,CAA2BiH,EAAsB,EAAE,CAACkD,WAAU,EAAKC,UAAU,SAASC,UAAUH,EAAQlB,QAAQa,SAAsB7J,OAAOwH,EAAkB,KAAzBxH,CAA4BiH,EAAsB,EAAE,CAACqD,MAAK,EAAKT,SAAS,CAAc7J,OAAOwH,EAAiB,IAAxBxH,CAA2BuH,EAAkC,cAAE,CAAClD,GAAG,SAAS3D,MAAM,mBAAmBkH,WAAWpB,EAAanC,GAAGtC,OAAO,mBAAmBhD,UAAUmI,EAAkC,iBAAEqD,IAAI1J,UAAU,SAAmBqC,GAAG,OAAxnBxE,EAA+oBwE,GAApnB,IAAI,GAAGpE,OAAO0L,KAAKC,MAAM/L,EAAM,IAAI,GAAG,MAAMA,EAAM,IAAI,GAAGI,OAAO0L,KAAKC,MAAM/L,EAAM,IAAI,GAAG,MAAM,GAAGI,OAAOJ,GAA5J,IAAyBA,GAAopBwJ,QAAQwC,QAAQjB,QAAqBzJ,OAAOwH,EAAiB,IAAxBxH,CAA2BgK,EAA6B,CAAC3F,GAAG,gBAAgB3D,MAAM,aAAakH,WAAWhB,EAAevC,GAAGtC,OAAO,QAAQhD,UAAUmI,EAAkC,iBAAEyD,MAAMzC,QAAQwC,QAAQjB,MAAMpB,aAAa,CAAC,CAAChE,GAAGsC,EAAiBtC,GAAGtC,OAAO,SAAS,CAACsC,GAAGmC,EAAanC,GAAGtC,OAAO,YAAyB/B,OAAOwH,EAAiB,IAAxBxH,CAA2BgK,EAA6B,CAAC3F,GAAG,iBAAiB3D,MAAM,cAAckH,WAAWhB,EAAevC,GAAGtC,OAAO,SAAShD,UAAUmI,EAAkC,iBAAEyD,MAAMzC,QAAQwC,QAAQjB,MAAMpB,aAAa,CAAC,CAAChE,GAAGsC,EAAiBtC,GAAGtC,OAAO,UAAU,CAACsC,GAAGmC,EAAanC,GAAGtC,OAAO"},"input":"(this[\"webpackJsonpcustom_filter\"] = this[\"webpackJsonpcustom_filter\"] || []).push([[11],{\n\n/***/ 682:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ htmlForFeature; });\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\nvar createForOfIteratorHelper = __webpack_require__(10);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/defineProperty.js\nvar defineProperty = __webpack_require__(3);\n\n// EXTERNAL MODULE: ./node_modules/@formatjs/intl-locale/polyfill.js\nvar polyfill = __webpack_require__(710);\n\n// EXTERNAL MODULE: ./node_modules/@formatjs/intl-getcanonicallocales/polyfill.js\nvar intl_getcanonicallocales_polyfill = __webpack_require__(713);\n\n// EXTERNAL MODULE: ./node_modules/@formatjs/intl-pluralrules/polyfill.js\nvar intl_pluralrules_polyfill = __webpack_require__(714);\n\n// EXTERNAL MODULE: ./node_modules/@formatjs/intl-pluralrules/locale-data/en.js\nvar en = __webpack_require__(715);\n\n// EXTERNAL MODULE: ./node_modules/@formatjs/intl-numberformat/polyfill.js\nvar intl_numberformat_polyfill = __webpack_require__(716);\n\n// EXTERNAL MODULE: ./node_modules/@formatjs/intl-numberformat/locale-data/en.js\nvar locale_data_en = __webpack_require__(718);\n\n// CONCATENATED MODULE: ./src/utils/formatter.js\n// int-numberformat dependencies (support for ios v13)\n// int-pluralrules dependencies (support for ios v12)\n/*\n  Note: `notation` & `compactDisplay` properties are not supported yet by Safari.\n  Those require the use of a polyfill: https://www.npmjs.com/package/@formatjs/intl-numberformat\n*/var DEFAULT_LOCALE='en-US';var CIRCLE_SVG=\"<svg width=\\\"10px\\\" height=\\\"10px\\\" fill=\\\"#47db99\\\" viewBox=\\\"0 0 10 10\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\n  <circle cx=\\\"5\\\" cy=\\\"5\\\" r=\\\"5\\\"/>\\n</svg>\";var currencyFormatter=function currencyFormatter(value){var _value=parseLogicalOperation(value);return{prefix:\"\".concat(_value.operation,\" $\"),value:Intl.NumberFormat(DEFAULT_LOCALE,{maximumFractionDigits:2,minimumFractionDigits:2,notation:'compact',compactDisplay:'short'}).format(_value.value)};};var numberFormatter=function numberFormatter(value){var _value=parseLogicalOperation(value);return _value.operation+Intl.NumberFormat(DEFAULT_LOCALE,{maximumFractionDigits:1,minimumFractionDigits:0,notation:'compact',compactDisplay:'short'}).format(_value.value);};var intervalsFormatter=function intervalsFormatter(value,dataIndex,ticks){var _value=numberFormatter(value);if(!ticks||dataIndex===undefined)return _value;var intervals=moneyInterval(dataIndex,ticks);return\"\".concat(intervals,\" <br/> \").concat(CIRCLE_SVG,\" \").concat(_value);};var parseLogicalOperation=function parseLogicalOperation(value){if(!isNaN(value))return{value:value,operation:''};try{// To allow formatting even values after a comparison operator\nvar numberWithComparisonOperators=/([<>]=?)[^$]?(\\d+)/gm;// eg. < 2, <2, >= 3\nvar regExp=new RegExp(numberWithComparisonOperators);var match=regExp.exec(value);var operation;if(match){operation=match[1];value=Number(match[2]);}return isNaN(value)?{value:0,operation:''}:{value:value,operation:operation};}catch(_unused){throw new Error(\"You are using a numberFormatter on a not valid value: \".concat(value));}};var moneyInterval=function moneyInterval(dataIndex,ticks){var isFirst=dataIndex===0;try{if(isFirst||dataIndex===ticks.length){var comparison=isFirst?'<':'≥';var formattedValue=isFirst?currencyFormatter(ticks[dataIndex]):currencyFormatter(ticks[dataIndex-1]);return\"\".concat(comparison,\" \").concat(formattedValue.prefix).concat(formattedValue.value);}else{dataIndex=dataIndex-1;var prevTick=currencyFormatter(ticks[dataIndex]);var nextTick=currencyFormatter(ticks[dataIndex+1]);return\"\".concat(prevTick.prefix).concat(prevTick.value,\" \\u2014 \").concat(nextTick.prefix).concat(nextTick.value);}}catch(_unused2){throw new Error(\"You are using an \\\"intervalsFormatter\\\" on a not valid index: \".concat(dataIndex,\" & for the ticks \").concat(ticks));}};\n// CONCATENATED MODULE: ./src/utils/htmlForFeature.js\nvar _formatterFunctions;var FORMATTER_TYPES=Object.freeze({CURRENCY:'currency',NUMBER:'number'});var formatterFunctions=(_formatterFunctions={},Object(defineProperty[\"a\" /* default */])(_formatterFunctions,FORMATTER_TYPES.CURRENCY,function(value){var formatted=currencyFormatter(value);return\"\".concat(formatted.prefix).concat(formatted.value);}),Object(defineProperty[\"a\" /* default */])(_formatterFunctions,FORMATTER_TYPES.NUMBER,function(value){return numberFormatter(value);}),_formatterFunctions);var DEFAULT_FORMATTER={type:'',columns:[]};function htmlForFeature(_ref){var title=_ref.title,feature=_ref.feature,_ref$formatter=_ref.formatter,formatter=_ref$formatter===void 0?DEFAULT_FORMATTER:_ref$formatter,_ref$includeColumns=_ref.includeColumns,includeColumns=_ref$includeColumns===void 0?'*':_ref$includeColumns,_ref$showColumnName=_ref.showColumnName,showColumnName=_ref$showColumnName===void 0?true:_ref$showColumnName;if(!feature){throw new Error(\"htmlForFeature needs \\\"info.object\\\" information\");}var propertyNames=Object.keys(feature.properties);if(formatter!==null&&formatter!==void 0&&formatter.type&&formatter!==null&&formatter!==void 0&&formatter.columns&&!isFormatterValid(propertyNames,formatter)){return;}if(!includedColumnsAreValid(propertyNames,includeColumns)){return;}var html='';if(title){html=\"<h3 style=\\\"margin: 0\\\"><strong>\".concat(title,\"</strong></h3>\");}for(var _i=0,_propertyNames=propertyNames;_i<_propertyNames.length;_i++){var name=_propertyNames[_i];if(name!=='layerName'&&(includeColumns.includes(name)||includeColumns==='*')){if(formatter!==null&&formatter!==void 0&&formatter.columns.includes(name)){var formatterFunction=formatterFunctions[formatter.type];html=generateHtml(feature,name,showColumnName,html,formatterFunction);}else{html=generateHtml(feature,name,showColumnName,html);}}}return html;}function generateHtml(feature,propertyName,showColumnName,html){var formatterFunction=arguments.length>4&&arguments[4]!==undefined?arguments[4]:function(v){return v;};return html.concat(\"\".concat(showColumnName?\"<strong>\".concat(propertyName,\"</strong>: \"):'').concat(formatterFunction(feature.properties[propertyName]),\"<br/>\"));}function isFormatterValid(properties,formatter){var supportedTypes=Object.values(FORMATTER_TYPES);if(!supportedTypes.includes(formatter.type)){throw new Error(\"\\\"\".concat(formatter.type,\"\\\" is not supported as formatter, use one of \\\"\").concat(supportedTypes,\"\\\"\"));}if(!formatter.columns||formatter.columns.length===0)return true;if(!isArrayOfStrings(formatter.columns)){throw new Error(\"\\\"formatter.columns\\\" property needs to be an array of strings\");}var _iterator=Object(createForOfIteratorHelper[\"a\" /* default */])(formatter.columns),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var column=_step.value;if(!properties.includes(column)){var available=properties.join(', ');throw new Error(\"\\\"formatted.columns\\\" includes '\".concat(column,\"' but it was not found!. Available cols are [\").concat(available,\"]\"));}}}catch(err){_iterator.e(err);}finally{_iterator.f();}return true;}function includedColumnsAreValid(properties,includeColumns){if(includeColumns==='*'){return true;}if(!isArrayOfStrings(includeColumns)){throw new Error(\"\\\"includeColumns\\\" property needs to be an array of existing feature columns or \\\"*\\\"\");}if(isArrayOfStrings(includeColumns)){var _iterator2=Object(createForOfIteratorHelper[\"a\" /* default */])(includeColumns),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var column=_step2.value;if(!properties.includes(column)){throw new Error('colums set in \"includeColumns\" should exist in picked feature');}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}return true;}function isArrayOfStrings(value){return Array.isArray(value)&&value.length&&value.every(String);}\n\n/***/ }),\n\n/***/ 691:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return POP_AGG_LAYER_ID; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return PopAggLayer; });\n/* harmony import */ var _Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(5);\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(177);\n/* harmony import */ var _deck_gl_carto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(493);\n/* harmony import */ var _carto_react_redux__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(244);\n/* harmony import */ var _carto_react_redux__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_carto_react_redux__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _carto_react_api__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(679);\n/* harmony import */ var _carto_react_api__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_carto_react_api__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var utils_htmlForFeature__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(682);\nvar POP_AGG_LAYER_ID='popAggLayer';function PopAggLayer(){var _useSelector=Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[\"useSelector\"])(function(state){return state.carto.layers;}),popAggLayer=_useSelector.popAggLayer;var source=Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[\"useSelector\"])(function(state){return Object(_carto_react_redux__WEBPACK_IMPORTED_MODULE_3__[\"selectSourceById\"])(state,popAggLayer===null||popAggLayer===void 0?void 0:popAggLayer.source);});var cartoLayerProps=Object(_carto_react_api__WEBPACK_IMPORTED_MODULE_4__[\"useCartoLayerProps\"])({source:source});if(popAggLayer&&source){return new _deck_gl_carto__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"](Object(_Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])(Object(_Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({},cartoLayerProps),{},{id:POP_AGG_LAYER_ID,getFillColor:[241,109,122],pointRadiusMinPixels:2,getLineColor:[255,0,0],lineWidthMinPixels:1,pickable:true,visible:false,onHover:function onHover(info){if(info!==null&&info!==void 0&&info.object){info.object={html:Object(utils_htmlForFeature__WEBPACK_IMPORTED_MODULE_5__[/* default */ \"a\"])({feature:info.object}),style:{}};}}}));}}\n\n/***/ }),\n\n/***/ 694:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return POPULATION_LAYER_ID; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return PopulationLayer; });\n/* harmony import */ var _Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(5);\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(177);\n/* harmony import */ var _deck_gl_carto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(493);\n/* harmony import */ var _carto_react_redux__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(244);\n/* harmony import */ var _carto_react_redux__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_carto_react_redux__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _carto_react_api__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(679);\n/* harmony import */ var _carto_react_api__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_carto_react_api__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var utils_htmlForFeature__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(682);\n/* harmony import */ var _luma_gl_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(695);\nvar POPULATION_LAYER_ID='populationLayer';var layerConfig={title:'Population',visible:true,legend:{}};function PopulationLayer(){var _useSelector=Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[\"useSelector\"])(function(state){return state.carto.layers;}),populationLayer=_useSelector.populationLayer;var source=Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[\"useSelector\"])(function(state){return Object(_carto_react_redux__WEBPACK_IMPORTED_MODULE_3__[\"selectSourceById\"])(state,populationLayer===null||populationLayer===void 0?void 0:populationLayer.source);});var cartoLayerProps=Object(_carto_react_api__WEBPACK_IMPORTED_MODULE_4__[\"useCartoLayerProps\"])({source:source});var dispatch=Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[\"useDispatch\"])();if(populationLayer&&source){return new _deck_gl_carto__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"](Object(_Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])(Object(_Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({},cartoLayerProps),{},{id:POPULATION_LAYER_ID,getFillColor:[217,219,94],pointRadiusMinPixels:0.8,getLineColor:[0,0,0],lineWidthMinPixels:1,pickable:true,parameters:{blendFunc:[_luma_gl_constants__WEBPACK_IMPORTED_MODULE_6__[\"default\"].SRC_ALPHA,_luma_gl_constants__WEBPACK_IMPORTED_MODULE_6__[\"default\"].DST_ALPHA],blendEquation:_luma_gl_constants__WEBPACK_IMPORTED_MODULE_6__[\"default\"].FUNC_ADD},visible:populationLayer.visible,onDataLoad:function onDataLoad(data){dispatch(Object(_carto_react_redux__WEBPACK_IMPORTED_MODULE_3__[\"updateLayer\"])({id:POPULATION_LAYER_ID,layerAttributes:Object(_Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({},layerConfig)}));cartoLayerProps.onDataLoad(data);},onHover:function onHover(info){if(info!==null&&info!==void 0&&info.object){info.object={html:Object(utils_htmlForFeature__WEBPACK_IMPORTED_MODULE_5__[/* default */ \"a\"])({feature:info.object}),style:{}};}}}));}}\n\n/***/ }),\n\n/***/ 696:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return COUNTIES_LAYER_ID; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return CountiesLayer; });\n/* harmony import */ var _Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(5);\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(177);\n/* harmony import */ var _deck_gl_carto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(493);\n/* harmony import */ var _carto_react_redux__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(244);\n/* harmony import */ var _carto_react_redux__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_carto_react_redux__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _carto_react_api__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(679);\n/* harmony import */ var _carto_react_api__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_carto_react_api__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var utils_htmlForFeature__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(682);\nvar COUNTIES_LAYER_ID='countiesLayer';var layerConfig={title:'Counties',visible:true,legend:{}};function CountiesLayer(){var _useSelector=Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[\"useSelector\"])(function(state){return state.carto.layers;}),countiesLayer=_useSelector.countiesLayer;var source=Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[\"useSelector\"])(function(state){return Object(_carto_react_redux__WEBPACK_IMPORTED_MODULE_3__[\"selectSourceById\"])(state,countiesLayer===null||countiesLayer===void 0?void 0:countiesLayer.source);});var cartoLayerProps=Object(_carto_react_api__WEBPACK_IMPORTED_MODULE_4__[\"useCartoLayerProps\"])({source:source});var dispatch=Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[\"useDispatch\"])();if(countiesLayer&&source){return new _deck_gl_carto__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"](Object(_Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])(Object(_Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({},cartoLayerProps),{},{id:COUNTIES_LAYER_ID,getFillColor:[195,199,198,0],pointRadiusMinPixels:1,getLineColor:[195,199,198],lineWidthMinPixels:0.3,pickable:true,visible:countiesLayer.visible,onDataLoad:function onDataLoad(data){dispatch(Object(_carto_react_redux__WEBPACK_IMPORTED_MODULE_3__[\"updateLayer\"])({id:COUNTIES_LAYER_ID,layerAttributes:Object(_Users_tomasehrenfeld_projs_se_team_tomas_react_apps_custom_filter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({},layerConfig)}));cartoLayerProps.onDataLoad(data);},onHover:function onHover(info){if(info!==null&&info!==void 0&&info.object){info.object={html:Object(utils_htmlForFeature__WEBPACK_IMPORTED_MODULE_5__[/* default */ \"a\"])({feature:info.object}),style:{}};}}}));}}\n\n/***/ }),\n\n/***/ 733:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 842:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"default\", function() { return /* binding */ Filters; });\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(0);\n\n// EXTERNAL MODULE: ./node_modules/@deck.gl/carto/dist/esm/api/maps-api-common.js\nvar maps_api_common = __webpack_require__(29);\n\n// CONCATENATED MODULE: ./src/data/sources/popAggSource.js\nvar POP_AGG_SOURCE_ID='popAggSource';/***************\n -- popAgg layer was created from query:\n\nDROP TABLE IF EXISTS `cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_agg_tileset`;\nCALL `carto-un`.carto.CREATE_POINT_AGGREGATION_TILESET(\n  R'''(\n    SELECT state, county, points as geom FROM `cartodb-gcp-solutions-eng-team.tomas_data.usa_pop` \n  )''',\n  '`cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_agg_tileset`',\n  R'''\n    {\n      \"zoom_min\": 3,\n      \"zoom_max\": 8,\n      \"aggregation_type\": \"quadkey\",\n      \"aggregation_resolution\": 7,\n      \"aggregation_placement\": \"cell-centroid\",\n      \"properties\":{\n        \"aggregated_total\": {\n          \"formula\":\"count(*)\",\n          \"type\":\"Number\"\n        },\n        \"state\": {\n            \"formula\":\"APPROX_TOP_COUNT(state, 1)[OFFSET(0)].value\",\n            \"type\":\"String\"\n        },\n        \"county\": {\n            \"formula\":\"APPROX_TOP_COUNT(county, 1)[OFFSET(0)].value\",\n            \"type\":\"String\"\n        }\n      }\n    }\n  ''');\n ***************/var source={id:POP_AGG_SOURCE_ID,type:maps_api_common[\"h\" /* MAP_TYPES */].TILESET,connection:'tehren',data:\"cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_agg_tileset\"};/* harmony default export */ var popAggSource = (source);\n// EXTERNAL MODULE: ./src/components/layers/PopAggLayer.js\nvar PopAggLayer = __webpack_require__(691);\n\n// CONCATENATED MODULE: ./src/data/sources/populationSource.js\nvar POPULATION_SOURCE_ID='populationSource';/****************\n -- population layer was created from query:\n\n  CREATE OR REPLACE TABLE `cartodb-gcp-solutions-eng-team.tomas_data.usa_pop` AS \n  WITH blocks AS (\n    SELECT \n      d.total_pop, \n      g.state_name AS state,\n      g.county_name AS county,\n      g.blockgroup_geom\n    FROM `bigquery-public-data.geo_census_blockgroups.us_blockgroups_national` AS g\n    INNER JOIN `bigquery-public-data.census_bureau_acs.blockgroup_2018_5yr` AS d ON g.geo_id = d.geo_id\n  ),\n  point_lists AS (\n    SELECT \n      state,\n      county,\n      `carto-un`.carto.ST_GENERATEPOINTS(blockgroup_geom, CAST(total_pop AS INT64)) AS points\n    FROM blocks\n  )\n\n****************/var populationSource_source={id:POPULATION_SOURCE_ID,type:maps_api_common[\"h\" /* MAP_TYPES */].TILESET,connection:'tehren',data:\"cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_tileset\"};/* harmony default export */ var populationSource = (populationSource_source);\n// EXTERNAL MODULE: ./src/components/layers/PopulationLayer.js\nvar PopulationLayer = __webpack_require__(694);\n\n// CONCATENATED MODULE: ./src/data/sources/countiesSource.js\nvar COUNTIES_SOURCE_ID='countiesSource';/****************\n -- counties layer was created from query:\n  CREATE OR REPLACE TABLE `cartodb-gcp-solutions-eng-team.tomas_data.usa_counties` AS\n  SELECT \n    state_name AS state,\n    county_name AS county,\n    SUM(d.total_pop) AS pop,\n    ST_SIMPLIFY(ST_UNION_AGG(blockgroup_geom), 200) as geom\n  FROM `bigquery-public-data.geo_census_blockgroups.us_blockgroups_national` AS g\n  INNER JOIN `bigquery-public-data.census_bureau_acs.blockgroup_2018_5yr` AS d ON g.geo_id = d.geo_id\n  GROUP BY 1, 2\n ****************/var countiesSource_source={id:COUNTIES_SOURCE_ID,type:maps_api_common[\"h\" /* MAP_TYPES */].TABLE,connection:'tehren',data:\"cartodb-gcp-solutions-eng-team.tomas_data.usa_counties\"};/* harmony default export */ var countiesSource = (countiesSource_source);\n// EXTERNAL MODULE: ./src/components/layers/CountiesLayer.js\nvar CountiesLayer = __webpack_require__(696);\n\n// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 24 modules\nvar es = __webpack_require__(177);\n\n// EXTERNAL MODULE: ./node_modules/@carto/react-redux/dist/index.js\nvar dist = __webpack_require__(244);\n\n// EXTERNAL MODULE: ./node_modules/@material-ui/core/esm/styles/makeStyles.js\nvar makeStyles = __webpack_require__(497);\n\n// EXTERNAL MODULE: ./node_modules/@material-ui/core/esm/Grid/Grid.js\nvar Grid = __webpack_require__(646);\n\n// EXTERNAL MODULE: ./node_modules/@carto/react-core/dist/index.js\nvar react_core_dist = __webpack_require__(305);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js\nvar objectSpread2 = __webpack_require__(5);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 1 modules\nvar slicedToArray = __webpack_require__(12);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js + 2 modules\nvar toConsumableArray = __webpack_require__(19);\n\n// EXTERNAL MODULE: ./node_modules/@carto/react-ui/dist/index.js\nvar react_ui_dist = __webpack_require__(376);\n\n// EXTERNAL MODULE: ./node_modules/@carto/react-widgets/dist/index.js\nvar react_widgets_dist = __webpack_require__(685);\n\n// CONCATENATED MODULE: ./src/components/widgets/useWidgetFilterValues.js\n/**\n * Obtain widget's filter values.\n *\n * @param  {object} props\n * @param  {string} props.dataSource - ID of the source to get the filters from.\n * @param  {string} props.id - ID of the widget that applied the filter.\n * @param  {string} props.column - name of column of this widget.\n * @param  {string} props.type - type of filter\n */function useWidgetFilterValues(_ref){var dataSource=_ref.dataSource,id=_ref.id,column=_ref.column,type=_ref.type;var _useSelector=Object(es[\"useSelector\"])(function(state){return Object(dist[\"selectSourceById\"])(state,dataSource)||{};}),filters=_useSelector.filters;return Object(react[\"useMemo\"])(function(){var _filters$column;var filter=filters===null||filters===void 0?void 0:(_filters$column=filters[column])===null||_filters$column===void 0?void 0:_filters$column[type];if(!filter||filter.owner!==id){return null;}return filter.values;},[filters,column,type,id]);}\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(24);\n\n// CONCATENATED MODULE: ./src/components/widgets/CustomCategoryWidget.js\nvar EMPTY_ARRAY=[];/**\n * Renders a <CustomCategoryWidget /> component\n * @param  {object} props\n * @param  {string} props.id - ID for the widget instance.\n * @param  {string} props.title - Title to show in the widget header.\n * @param  {string} props.dataSource - ID of the data source to get the data from.\n * @param  {string} props.column - Name of the data source's column to get the data from.\n * @param  {string} [props.operationColumn] - Name of the data source's column to operate with. If not defined it will default to the one defined in `column`.\n * @param  {string} props.operation - Operation to apply to the operationColumn. Must be one of those defined in `AggregationTypes` object.\n * @param  {Function} [props.formatter] - Function to format each value returned.\n * @param  {Object} [props.labels] - Overwrite category labels.\n * @param  {boolean} [props.animation] - Enable/disable widget animations on data updates. Enabled by default.\n * @param  {boolean} [props.filterable] - Enable/disable widget filtering capabilities. Enabled by default.\n * @param  {boolean} [props.searchable] - Enable/disable widget searching capabilities. Enabled by default.\n * @param  {Function} [props.onError] - Function to handle error messages from the widget.\n * @param  {Object} [props.wrapperProps] - Extra props to pass to [WrapperWidgetUI](https://storybook-react.carto.com/?path=/docs/widgets-wrapperwidgetui--default)\n * @param  {Object} [props.noDataAlertProps] - Extra props to pass to [NoDataAlert]()\n * @param {Array} [props.otherSources] - Extra sources to filter based on the main source.\n */function CustomCategoryWidget(props){var id=props.id,title=props.title,dataSource=props.dataSource,column=props.column,operationColumn=props.operationColumn,operation=props.operation,formatter=props.formatter,labels=props.labels,animation=props.animation,filterable=props.filterable,searchable=props.searchable,onError=props.onError,wrapperProps=props.wrapperProps,noDataAlertProps=props.noDataAlertProps,otherSources=props.otherSources;var dispatch=Object(es[\"useDispatch\"])();var isSourceReady=Object(es[\"useSelector\"])(function(state){var sources=[].concat(Object(toConsumableArray[\"a\" /* default */])(otherSources.map(function(e){return e.id;})),[dataSource]);var areSourcesReady=sources.map(function(e){return Object(dist[\"selectAreFeaturesReadyForSource\"])(state,e);});return areSourcesReady.every(function(v){return v===true;});});var _useState=Object(react[\"useState\"])([]),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),categoryData=_useState2[0],setCategoryData=_useState2[1];var _useState3=Object(react[\"useState\"])(true),_useState4=Object(slicedToArray[\"a\" /* default */])(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var filters=Object(react_widgets_dist[\"useSourceFilters\"])({dataSource:dataSource,id:id});var selectedCategories=useWidgetFilterValues({dataSource:dataSource,id:id,column:column,type:react_core_dist[\"_FilterTypes\"].IN})||EMPTY_ARRAY;Object(react[\"useEffect\"])(function(){setIsLoading(true);if(isSourceReady){Object(react_widgets_dist[\"getCategories\"])({column:column,operationColumn:operationColumn,operation:operation,filters:filters,dataSource:dataSource}).then(function(data){if(data){setIsLoading(false);setCategoryData(data);}}).catch(function(error){setIsLoading(false);if(onError)onError(error);});}},[id,column,operationColumn,operation,filters,dataSource,setIsLoading,onError,isSourceReady]);var handleSelectedCategoriesChange=Object(react[\"useCallback\"])(function(categories){if(categories&&categories.length){dispatch(Object(dist[\"addFilter\"])({id:dataSource,column:column,type:react_core_dist[\"_FilterTypes\"].IN,values:categories,owner:id}));otherSources.forEach(function(e){dispatch(Object(dist[\"addFilter\"])({id:e.id,column:e.column,type:react_core_dist[\"_FilterTypes\"].IN,values:categories,owner:id}));});}else{dispatch(Object(dist[\"removeFilter\"])({id:dataSource,column:column}));otherSources.forEach(function(e){dispatch(Object(dist[\"removeFilter\"])({id:e.id,column:e.column}));});}},[column,dataSource,id,dispatch]);return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_ui_dist[\"WrapperWidgetUI\"],Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({title:title,isLoading:isLoading},wrapperProps),{},{children:categoryData.length||isLoading?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_ui_dist[\"CategoryWidgetUI\"],{data:categoryData,formatter:formatter,labels:labels,selectedCategories:selectedCategories,onSelectedCategoriesChange:handleSelectedCategoriesChange,animation:animation,filterable:filterable,searchable:searchable}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_ui_dist[\"NoDataAlert\"],Object(objectSpread2[\"a\" /* default */])({},noDataAlertProps))}));}CustomCategoryWidget.defaultProps={labels:{},animation:true,filterable:true,searchable:true,wrapperProps:{},noDataAlertProps:{}};/* harmony default export */ var widgets_CustomCategoryWidget = (CustomCategoryWidget);\n// CONCATENATED MODULE: ./src/components/views/Filters.js\n//import { CategoryWidget } from '@carto/react-widgets';\nvar useStyles=Object(makeStyles[\"a\" /* default */])(function(){return{filters:{}};});function Filters(){var dispatch=Object(es[\"useDispatch\"])();var classes=useStyles();Object(react[\"useEffect\"])(function(){dispatch(Object(dist[\"addSource\"])(populationSource));dispatch(Object(dist[\"addLayer\"])({id:PopulationLayer[\"a\" /* POPULATION_LAYER_ID */],source:populationSource.id}));return function(){dispatch(Object(dist[\"removeLayer\"])(PopulationLayer[\"a\" /* POPULATION_LAYER_ID */]));dispatch(Object(dist[\"removeSource\"])(populationSource.id));};},[dispatch]);Object(react[\"useEffect\"])(function(){dispatch(Object(dist[\"addSource\"])(countiesSource));dispatch(Object(dist[\"addLayer\"])({id:CountiesLayer[\"a\" /* COUNTIES_LAYER_ID */],source:countiesSource.id}));return function(){dispatch(Object(dist[\"removeLayer\"])(CountiesLayer[\"a\" /* COUNTIES_LAYER_ID */]));dispatch(Object(dist[\"removeSource\"])(countiesSource.id));};},[dispatch]);Object(react[\"useEffect\"])(function(){dispatch(Object(dist[\"addSource\"])(popAggSource));dispatch(Object(dist[\"addLayer\"])({id:PopAggLayer[\"a\" /* POP_AGG_LAYER_ID */],source:popAggSource.id}));return function(){dispatch(Object(dist[\"removeLayer\"])(PopAggLayer[\"a\" /* POP_AGG_LAYER_ID */]));dispatch(Object(dist[\"removeSource\"])(popAggSource.id));};},[dispatch]);// [hygen] Add useEffect\nvar CustomFormatter=function CustomFormatter(value){var formatted=value>1e6?\"\".concat(Math.round(value/1e6,2),\" M\"):value>1e3?\"\".concat(Math.round(value/1e3,2),\" k\"):\"\".concat(value);return formatted;};return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Grid[\"a\" /* default */],{container:true,direction:\"column\",className:classes.filters,children:/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(Grid[\"a\" /* default */],{item:true,children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_widgets_dist[\"FormulaWidget\"],{id:\"totPop\",title:\"Total Population\",dataSource:popAggSource.id,column:\"aggregated_total\",operation:react_core_dist[\"AggregationTypes\"].SUM,formatter:function formatter(v){return CustomFormatter(v);},onError:console.error}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(widgets_CustomCategoryWidget,{id:\"stateCategory\",title:\"State Name\",dataSource:countiesSource.id,column:\"state\",operation:react_core_dist[\"AggregationTypes\"].COUNT,onError:console.error,otherSources:[{id:populationSource.id,column:'state'},{id:popAggSource.id,column:'state'}]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(widgets_CustomCategoryWidget,{id:\"countyCategory\",title:\"County Name\",dataSource:countiesSource.id,column:\"county\",operation:react_core_dist[\"AggregationTypes\"].COUNT,onError:console.error,otherSources:[{id:populationSource.id,column:'county'},{id:popAggSource.id,column:'county'}]})]})});}\n\n/***/ })\n\n}]);","inputSourceMap":{"version":3,"sources":["/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/src/utils/formatter.js","/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/src/utils/htmlForFeature.js","/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/src/components/layers/PopAggLayer.js","/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/src/components/layers/PopulationLayer.js","/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/src/components/layers/CountiesLayer.js","ignored /Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/node_modules/@loaders.gl/worker-utils/dist/esm/lib/library-utils ../node/require-utils.node","/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/src/data/sources/popAggSource.js","/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/src/data/sources/populationSource.js","/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/src/data/sources/countiesSource.js","/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/src/components/widgets/useWidgetFilterValues.js","/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/src/components/widgets/CustomCategoryWidget.js","/Users/tomasehrenfeld/projs/se-team/tomas/react-apps/custom_filter/src/components/views/Filters.js"],"names":["DEFAULT_LOCALE","CIRCLE_SVG","currencyFormatter","value","_value","parseLogicalOperation","prefix","operation","Intl","NumberFormat","maximumFractionDigits","minimumFractionDigits","notation","compactDisplay","format","numberFormatter","intervalsFormatter","dataIndex","ticks","undefined","intervals","moneyInterval","isNaN","numberWithComparisonOperators","regExp","RegExp","match","exec","Number","Error","isFirst","length","comparison","formattedValue","prevTick","nextTick","FORMATTER_TYPES","Object","freeze","CURRENCY","NUMBER","formatterFunctions","formatted","DEFAULT_FORMATTER","type","columns","htmlForFeature","title","feature","formatter","includeColumns","showColumnName","propertyNames","keys","properties","isFormatterValid","includedColumnsAreValid","html","name","includes","formatterFunction","generateHtml","propertyName","v","concat","supportedTypes","values","isArrayOfStrings","column","available","join","Array","isArray","every","String","POP_AGG_LAYER_ID","PopAggLayer","useSelector","state","carto","layers","popAggLayer","source","selectSourceById","cartoLayerProps","useCartoLayerProps","CartoLayer","id","getFillColor","pointRadiusMinPixels","getLineColor","lineWidthMinPixels","pickable","visible","onHover","info","object","style","POPULATION_LAYER_ID","layerConfig","legend","PopulationLayer","populationLayer","dispatch","useDispatch","parameters","blendFunc","GL","SRC_ALPHA","DST_ALPHA","blendEquation","FUNC_ADD","onDataLoad","data","updateLayer","layerAttributes","COUNTIES_LAYER_ID","CountiesLayer","countiesLayer","POP_AGG_SOURCE_ID","MAP_TYPES","TILESET","connection","POPULATION_SOURCE_ID","COUNTIES_SOURCE_ID","TABLE","useWidgetFilterValues","dataSource","filters","useMemo","filter","owner","EMPTY_ARRAY","CustomCategoryWidget","props","operationColumn","labels","animation","filterable","searchable","onError","wrapperProps","noDataAlertProps","otherSources","isSourceReady","sources","map","e","areSourcesReady","selectAreFeaturesReadyForSource","useState","categoryData","setCategoryData","isLoading","setIsLoading","useSourceFilters","selectedCategories","FilterTypes","IN","useEffect","getCategories","then","catch","error","handleSelectedCategoriesChange","useCallback","categories","addFilter","forEach","removeFilter","defaultProps","useStyles","makeStyles","Filters","classes","addSource","populationSource","addLayer","removeLayer","removeSource","countiesSource","popAggSource","CustomFormatter","Math","round","AggregationTypes","SUM","console","COUNT"],"mappings":"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","file":"x","sourcesContent":["// int-numberformat dependencies (support for ios v13)\nimport '@formatjs/intl-locale/polyfill';\nimport '@formatjs/intl-getcanonicallocales/polyfill';\n\n// int-pluralrules dependencies (support for ios v12)\nimport '@formatjs/intl-pluralrules/polyfill';\nimport '@formatjs/intl-pluralrules/locale-data/en';\n\n/*\n  Note: `notation` & `compactDisplay` properties are not supported yet by Safari.\n  Those require the use of a polyfill: https://www.npmjs.com/package/@formatjs/intl-numberformat\n*/\nimport '@formatjs/intl-numberformat/polyfill';\nimport '@formatjs/intl-numberformat/locale-data/en';\n\nconst DEFAULT_LOCALE = 'en-US';\nconst CIRCLE_SVG = `<svg width=\"10px\" height=\"10px\" fill=\"#47db99\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n  <circle cx=\"5\" cy=\"5\" r=\"5\"/>\n</svg>`;\n\nexport const currencyFormatter = (value) => {\n  const _value = parseLogicalOperation(value);\n  return {\n    prefix: `${_value.operation} $`,\n    value: Intl.NumberFormat(DEFAULT_LOCALE, {\n      maximumFractionDigits: 2,\n      minimumFractionDigits: 2,\n      notation: 'compact',\n      compactDisplay: 'short',\n    }).format(_value.value),\n  };\n};\n\nexport const numberFormatter = (value) => {\n  const _value = parseLogicalOperation(value);\n  return (\n    _value.operation +\n    Intl.NumberFormat(DEFAULT_LOCALE, {\n      maximumFractionDigits: 1,\n      minimumFractionDigits: 0,\n      notation: 'compact',\n      compactDisplay: 'short',\n    }).format(_value.value)\n  );\n};\n\nexport const intervalsFormatter = (value, dataIndex, ticks) => {\n  const _value = numberFormatter(value);\n  if (!ticks || dataIndex === undefined) return _value;\n  const intervals = moneyInterval(dataIndex, ticks);\n  return `${intervals} <br/> ${CIRCLE_SVG} ${_value}`;\n};\n\nconst parseLogicalOperation = (value) => {\n  if (!isNaN(value)) return { value, operation: '' };\n\n  try {\n    // To allow formatting even values after a comparison operator\n    const numberWithComparisonOperators = /([<>]=?)[^$]?(\\d+)/gm; // eg. < 2, <2, >= 3\n    const regExp = new RegExp(numberWithComparisonOperators);\n    const match = regExp.exec(value);\n\n    let operation;\n    if (match) {\n      operation = match[1];\n      value = Number(match[2]);\n    }\n\n    return isNaN(value) ? { value: 0, operation: '' } : { value, operation };\n  } catch {\n    throw new Error(`You are using a numberFormatter on a not valid value: ${value}`);\n  }\n};\n\nconst moneyInterval = (dataIndex, ticks) => {\n  const isFirst = dataIndex === 0;\n  try {\n    if (isFirst || dataIndex === ticks.length) {\n      const comparison = isFirst ? '<' : '≥';\n      const formattedValue = isFirst\n        ? currencyFormatter(ticks[dataIndex])\n        : currencyFormatter(ticks[dataIndex - 1]);\n      return `${comparison} ${formattedValue.prefix}${formattedValue.value}`;\n    } else {\n      dataIndex = dataIndex - 1;\n      const prevTick = currencyFormatter(ticks[dataIndex]);\n      const nextTick = currencyFormatter(ticks[dataIndex + 1]);\n      return `${prevTick.prefix}${prevTick.value} — ${nextTick.prefix}${nextTick.value}`;\n    }\n  } catch {\n    throw new Error(\n      `You are using an \"intervalsFormatter\" on a not valid index: ${dataIndex} & for the ticks ${ticks}`\n    );\n  }\n};\n","import { currencyFormatter, numberFormatter } from 'utils/formatter';\n\nconst FORMATTER_TYPES = Object.freeze({\n  CURRENCY: 'currency',\n  NUMBER: 'number',\n});\n\nconst formatterFunctions = {\n  [FORMATTER_TYPES.CURRENCY](value) {\n    const formatted = currencyFormatter(value);\n    return `${formatted.prefix}${formatted.value}`;\n  },\n  [FORMATTER_TYPES.NUMBER](value) {\n    return numberFormatter(value);\n  },\n};\n\nconst DEFAULT_FORMATTER = {\n  type: '',\n  columns: [],\n};\n\nexport default function htmlForFeature({\n  title,\n  feature,\n  formatter = DEFAULT_FORMATTER,\n  includeColumns = '*',\n  showColumnName = true,\n}) {\n  if (!feature) {\n    throw new Error(`htmlForFeature needs \"info.object\" information`);\n  }\n\n  const propertyNames = Object.keys(feature.properties);\n\n  if (\n    formatter?.type &&\n    formatter?.columns &&\n    !isFormatterValid(propertyNames, formatter)\n  ) {\n    return;\n  }\n\n  if (!includedColumnsAreValid(propertyNames, includeColumns)) {\n    return;\n  }\n\n  let html = '';\n\n  if (title) {\n    html = `<h3 style=\"margin: 0\"><strong>${title}</strong></h3>`;\n  }\n\n  for (const name of propertyNames) {\n    if (\n      name !== 'layerName' &&\n      (includeColumns.includes(name) || includeColumns === '*')\n    ) {\n      if (formatter?.columns.includes(name)) {\n        const formatterFunction = formatterFunctions[formatter.type];\n        html = generateHtml(feature, name, showColumnName, html, formatterFunction);\n      } else {\n        html = generateHtml(feature, name, showColumnName, html);\n      }\n    }\n  }\n\n  return html;\n}\n\nfunction generateHtml(\n  feature,\n  propertyName,\n  showColumnName,\n  html,\n  formatterFunction = (v) => v\n) {\n  return html.concat(\n    `${showColumnName ? `<strong>${propertyName}</strong>: ` : ''}${formatterFunction(\n      feature.properties[propertyName]\n    )}<br/>`\n  );\n}\n\nfunction isFormatterValid(properties, formatter) {\n  const supportedTypes = Object.values(FORMATTER_TYPES);\n\n  if (!supportedTypes.includes(formatter.type)) {\n    throw new Error(\n      `\"${formatter.type}\" is not supported as formatter, use one of \"${supportedTypes}\"`\n    );\n  }\n\n  if (!formatter.columns || formatter.columns.length === 0) return true;\n\n  if (!isArrayOfStrings(formatter.columns)) {\n    throw new Error(`\"formatter.columns\" property needs to be an array of strings`);\n  }\n\n  for (const column of formatter.columns) {\n    if (!properties.includes(column)) {\n      const available = properties.join(', ');\n      throw new Error(\n        `\"formatted.columns\" includes '${column}' but it was not found!. Available cols are [${available}]`\n      );\n    }\n  }\n\n  return true;\n}\n\nfunction includedColumnsAreValid(properties, includeColumns) {\n  if (includeColumns === '*') {\n    return true;\n  }\n\n  if (!isArrayOfStrings(includeColumns)) {\n    throw new Error(\n      `\"includeColumns\" property needs to be an array of existing feature columns or \"*\"`\n    );\n  }\n\n  if (isArrayOfStrings(includeColumns)) {\n    for (const column of includeColumns) {\n      if (!properties.includes(column)) {\n        throw new Error('colums set in \"includeColumns\" should exist in picked feature');\n      }\n    }\n  }\n\n  return true;\n}\n\nfunction isArrayOfStrings(value) {\n  return Array.isArray(value) && value.length && value.every(String);\n}\n","import { useSelector } from 'react-redux';\nimport { CartoLayer } from '@deck.gl/carto';\nimport { selectSourceById } from '@carto/react-redux';\nimport { useCartoLayerProps } from '@carto/react-api';\nimport htmlForFeature from 'utils/htmlForFeature';\n\nexport const POP_AGG_LAYER_ID = 'popAggLayer';\n\nexport default function PopAggLayer() {\n  const { popAggLayer } = useSelector((state) => state.carto.layers);\n  const source = useSelector((state) => selectSourceById(state, popAggLayer?.source));\n  const cartoLayerProps = useCartoLayerProps({ source });\n\n  if (popAggLayer && source) {\n    return new CartoLayer({\n      ...cartoLayerProps,\n      id: POP_AGG_LAYER_ID,\n      getFillColor: [241, 109, 122],\n      pointRadiusMinPixels: 2,\n      getLineColor: [255, 0, 0],\n      lineWidthMinPixels: 1,\n      pickable: true,\n      visible: false,\n      onHover: (info) => {\n        if (info?.object) {\n          info.object = {\n            html: htmlForFeature({ feature: info.object }),\n            style: {},\n          };\n        }\n      },\n    });\n  }\n}\n","import { useSelector, useDispatch } from 'react-redux';\nimport { CartoLayer } from '@deck.gl/carto';\nimport { selectSourceById, updateLayer } from '@carto/react-redux';\nimport { useCartoLayerProps } from '@carto/react-api';\nimport htmlForFeature from 'utils/htmlForFeature';\nimport GL from '@luma.gl/constants';\n\nexport const POPULATION_LAYER_ID = 'populationLayer';\nconst layerConfig = {\n  title: 'Population',\n  visible: true,\n  legend: {},\n};\n\nexport default function PopulationLayer() {\n  const { populationLayer } = useSelector((state) => state.carto.layers);\n  const source = useSelector((state) => selectSourceById(state, populationLayer?.source));\n  const cartoLayerProps = useCartoLayerProps({ source });\n  const dispatch = useDispatch();\n\n  if (populationLayer && source) {\n    return new CartoLayer({\n      ...cartoLayerProps,\n      id: POPULATION_LAYER_ID,\n      getFillColor: [217, 219, 94],\n      pointRadiusMinPixels: 0.8,\n      getLineColor: [0, 0, 0],\n      lineWidthMinPixels: 1,\n      pickable: true,\n      parameters: {\n        blendFunc: [GL.SRC_ALPHA, GL.DST_ALPHA],\n        blendEquation: GL.FUNC_ADD,\n      },\n      visible: populationLayer.visible,\n      onDataLoad: (data) => {\n        dispatch(\n          updateLayer({\n            id: POPULATION_LAYER_ID,\n            layerAttributes: { ...layerConfig },\n          })\n        );\n        cartoLayerProps.onDataLoad(data);\n      },\n      onHover: (info) => {\n        if (info?.object) {\n          info.object = {\n            html: htmlForFeature({ feature: info.object }),\n            style: {},\n          };\n        }\n      },\n    });\n  }\n}\n","import { useSelector, useDispatch } from 'react-redux';\nimport { CartoLayer } from '@deck.gl/carto';\nimport { selectSourceById, updateLayer } from '@carto/react-redux';\nimport { useCartoLayerProps } from '@carto/react-api';\nimport htmlForFeature from 'utils/htmlForFeature';\n\nexport const COUNTIES_LAYER_ID = 'countiesLayer';\n\nconst layerConfig = {\n  title: 'Counties',\n  visible: true,\n  legend: {},\n};\n\nexport default function CountiesLayer() {\n  const { countiesLayer } = useSelector((state) => state.carto.layers);\n  const source = useSelector((state) => selectSourceById(state, countiesLayer?.source));\n  const cartoLayerProps = useCartoLayerProps({ source });\n  const dispatch = useDispatch();\n\n  if (countiesLayer && source) {\n    return new CartoLayer({\n      ...cartoLayerProps,\n      id: COUNTIES_LAYER_ID,\n      getFillColor: [195, 199, 198, 0],\n      pointRadiusMinPixels: 1,\n      getLineColor: [195, 199, 198],\n      lineWidthMinPixels: 0.3,\n      pickable: true,\n      visible: countiesLayer.visible,\n      onDataLoad: (data) => {\n        dispatch(\n          updateLayer({\n            id: COUNTIES_LAYER_ID,\n            layerAttributes: { ...layerConfig },\n          })\n        );\n        cartoLayerProps.onDataLoad(data);\n      },\n      onHover: (info) => {\n        if (info?.object) {\n          info.object = {\n            html: htmlForFeature({ feature: info.object }),\n            style: {},\n          };\n        }\n      },\n    });\n  }\n}\n","/* (ignored) */","import { MAP_TYPES } from '@deck.gl/carto';\n\nconst POP_AGG_SOURCE_ID = 'popAggSource';\n\n/***************\n -- popAgg layer was created from query:\n\nDROP TABLE IF EXISTS `cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_agg_tileset`;\nCALL `carto-un`.carto.CREATE_POINT_AGGREGATION_TILESET(\n  R'''(\n    SELECT state, county, points as geom FROM `cartodb-gcp-solutions-eng-team.tomas_data.usa_pop` \n  )''',\n  '`cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_agg_tileset`',\n  R'''\n    {\n      \"zoom_min\": 3,\n      \"zoom_max\": 8,\n      \"aggregation_type\": \"quadkey\",\n      \"aggregation_resolution\": 7,\n      \"aggregation_placement\": \"cell-centroid\",\n      \"properties\":{\n        \"aggregated_total\": {\n          \"formula\":\"count(*)\",\n          \"type\":\"Number\"\n        },\n        \"state\": {\n            \"formula\":\"APPROX_TOP_COUNT(state, 1)[OFFSET(0)].value\",\n            \"type\":\"String\"\n        },\n        \"county\": {\n            \"formula\":\"APPROX_TOP_COUNT(county, 1)[OFFSET(0)].value\",\n            \"type\":\"String\"\n        }\n      }\n    }\n  ''');\n ***************/\n\nconst source = {\n  id: POP_AGG_SOURCE_ID,\n  type: MAP_TYPES.TILESET,\n  connection: 'tehren',\n  data: `cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_agg_tileset`,\n};\n\nexport default source;\n","import { MAP_TYPES } from '@deck.gl/carto';\n\nconst POPULATION_SOURCE_ID = 'populationSource';\n\n/****************\n -- population layer was created from query:\n\n  CREATE OR REPLACE TABLE `cartodb-gcp-solutions-eng-team.tomas_data.usa_pop` AS \n  WITH blocks AS (\n    SELECT \n      d.total_pop, \n      g.state_name AS state,\n      g.county_name AS county,\n      g.blockgroup_geom\n    FROM `bigquery-public-data.geo_census_blockgroups.us_blockgroups_national` AS g\n    INNER JOIN `bigquery-public-data.census_bureau_acs.blockgroup_2018_5yr` AS d ON g.geo_id = d.geo_id\n  ),\n  point_lists AS (\n    SELECT \n      state,\n      county,\n      `carto-un`.carto.ST_GENERATEPOINTS(blockgroup_geom, CAST(total_pop AS INT64)) AS points\n    FROM blocks\n  )\n\n****************/\n\nconst source = {\n  id: POPULATION_SOURCE_ID,\n  type: MAP_TYPES.TILESET,\n  connection: 'tehren',\n  data: `cartodb-gcp-solutions-eng-team.tomas_data.usa_pop_tileset`,\n};\n\nexport default source;\n","import { MAP_TYPES } from '@deck.gl/carto';\n\nconst COUNTIES_SOURCE_ID = 'countiesSource';\n\n/****************\n -- counties layer was created from query:\n  CREATE OR REPLACE TABLE `cartodb-gcp-solutions-eng-team.tomas_data.usa_counties` AS\n  SELECT \n    state_name AS state,\n    county_name AS county,\n    SUM(d.total_pop) AS pop,\n    ST_SIMPLIFY(ST_UNION_AGG(blockgroup_geom), 200) as geom\n  FROM `bigquery-public-data.geo_census_blockgroups.us_blockgroups_national` AS g\n  INNER JOIN `bigquery-public-data.census_bureau_acs.blockgroup_2018_5yr` AS d ON g.geo_id = d.geo_id\n  GROUP BY 1, 2\n ****************/\n\nconst source = {\n  id: COUNTIES_SOURCE_ID,\n  type: MAP_TYPES.TABLE,\n  connection: 'tehren',\n  data: `cartodb-gcp-solutions-eng-team.tomas_data.usa_counties`,\n};\n\nexport default source;\n","import { selectSourceById } from '@carto/react-redux/';\nimport { useSelector } from 'react-redux';\nimport { useMemo } from 'react';\n\n/**\n * Obtain widget's filter values.\n *\n * @param  {object} props\n * @param  {string} props.dataSource - ID of the source to get the filters from.\n * @param  {string} props.id - ID of the widget that applied the filter.\n * @param  {string} props.column - name of column of this widget.\n * @param  {string} props.type - type of filter\n */\nexport function useWidgetFilterValues({ dataSource, id, column, type }) {\n  const { filters } = useSelector((state) => selectSourceById(state, dataSource) || {});\n\n  return useMemo(() => {\n    const filter = filters?.[column]?.[type];\n    if (!filter || filter.owner !== id) {\n      return null;\n    }\n    return filter.values;\n  }, [filters, column, type, id]);\n}\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport { addFilter, removeFilter } from '@carto/react-redux';\nimport { WrapperWidgetUI, CategoryWidgetUI, NoDataAlert } from '@carto/react-ui';\nimport { _FilterTypes as FilterTypes, AggregationTypes } from '@carto/react-core';\nimport { getCategories } from '@carto/react-widgets';\nimport { useSourceFilters } from '@carto/react-widgets';\nimport { selectAreFeaturesReadyForSource } from '@carto/react-redux/';\nimport { useWidgetFilterValues } from './useWidgetFilterValues';\n\nconst EMPTY_ARRAY = [];\n\n/**\n * Renders a <CustomCategoryWidget /> component\n * @param  {object} props\n * @param  {string} props.id - ID for the widget instance.\n * @param  {string} props.title - Title to show in the widget header.\n * @param  {string} props.dataSource - ID of the data source to get the data from.\n * @param  {string} props.column - Name of the data source's column to get the data from.\n * @param  {string} [props.operationColumn] - Name of the data source's column to operate with. If not defined it will default to the one defined in `column`.\n * @param  {string} props.operation - Operation to apply to the operationColumn. Must be one of those defined in `AggregationTypes` object.\n * @param  {Function} [props.formatter] - Function to format each value returned.\n * @param  {Object} [props.labels] - Overwrite category labels.\n * @param  {boolean} [props.animation] - Enable/disable widget animations on data updates. Enabled by default.\n * @param  {boolean} [props.filterable] - Enable/disable widget filtering capabilities. Enabled by default.\n * @param  {boolean} [props.searchable] - Enable/disable widget searching capabilities. Enabled by default.\n * @param  {Function} [props.onError] - Function to handle error messages from the widget.\n * @param  {Object} [props.wrapperProps] - Extra props to pass to [WrapperWidgetUI](https://storybook-react.carto.com/?path=/docs/widgets-wrapperwidgetui--default)\n * @param  {Object} [props.noDataAlertProps] - Extra props to pass to [NoDataAlert]()\n * @param {Array} [props.otherSources] - Extra sources to filter based on the main source.\n */\nfunction CustomCategoryWidget(props) {\n  const {\n    id,\n    title,\n    dataSource,\n    column,\n    operationColumn,\n    operation,\n    formatter,\n    labels,\n    animation,\n    filterable,\n    searchable,\n    onError,\n    wrapperProps,\n    noDataAlertProps,\n    otherSources,\n  } = props;\n  const dispatch = useDispatch();\n  const isSourceReady = useSelector((state) => {\n    const sources = [...otherSources.map((e) => e.id), dataSource];\n    const areSourcesReady = sources.map((e) => selectAreFeaturesReadyForSource(state, e));\n    return areSourcesReady.every((v) => v === true);\n  });\n\n  const [categoryData, setCategoryData] = useState([]);\n\n  const [isLoading, setIsLoading] = useState(true);\n\n  const filters = useSourceFilters({ dataSource, id });\n  const selectedCategories =\n    useWidgetFilterValues({ dataSource, id, column, type: FilterTypes.IN }) ||\n    EMPTY_ARRAY;\n\n  useEffect(() => {\n    setIsLoading(true);\n\n    if (isSourceReady) {\n      getCategories({\n        column,\n        operationColumn,\n        operation,\n        filters,\n        dataSource,\n      })\n        .then((data) => {\n          if (data) {\n            setIsLoading(false);\n            setCategoryData(data);\n          }\n        })\n        .catch((error) => {\n          setIsLoading(false);\n          if (onError) onError(error);\n        });\n    }\n  }, [\n    id,\n    column,\n    operationColumn,\n    operation,\n    filters,\n    dataSource,\n    setIsLoading,\n    onError,\n    isSourceReady,\n  ]);\n\n  const handleSelectedCategoriesChange = useCallback(\n    (categories) => {\n      if (categories && categories.length) {\n        dispatch(\n          addFilter({\n            id: dataSource,\n            column,\n            type: FilterTypes.IN,\n            values: categories,\n            owner: id,\n          })\n        );\n        otherSources.forEach((e) => {\n          dispatch(\n            addFilter({\n              id: e.id,\n              column: e.column,\n              type: FilterTypes.IN,\n              values: categories,\n              owner: id,\n            })\n          );\n        });\n      } else {\n        dispatch(\n          removeFilter({\n            id: dataSource,\n            column,\n          })\n        );\n        otherSources.forEach((e) => {\n          dispatch(\n            removeFilter({\n              id: e.id,\n              column: e.column,\n            })\n          );\n        });\n      }\n    },\n    [column, dataSource, id, dispatch]\n  );\n\n  return (\n    <WrapperWidgetUI title={title} isLoading={isLoading} {...wrapperProps}>\n      {categoryData.length || isLoading ? (\n        <CategoryWidgetUI\n          data={categoryData}\n          formatter={formatter}\n          labels={labels}\n          selectedCategories={selectedCategories}\n          onSelectedCategoriesChange={handleSelectedCategoriesChange}\n          animation={animation}\n          filterable={filterable}\n          searchable={searchable}\n        />\n      ) : (\n        <NoDataAlert {...noDataAlertProps} />\n      )}\n    </WrapperWidgetUI>\n  );\n}\n\nCustomCategoryWidget.propTypes = {\n  id: PropTypes.string.isRequired,\n  title: PropTypes.string.isRequired,\n  dataSource: PropTypes.string.isRequired,\n  column: PropTypes.string.isRequired,\n  operationColumn: PropTypes.string,\n  operation: PropTypes.oneOf(Object.values(AggregationTypes)).isRequired,\n  formatter: PropTypes.func,\n  labels: PropTypes.object,\n  animation: PropTypes.bool,\n  filterable: PropTypes.bool,\n  searchable: PropTypes.bool,\n  onError: PropTypes.func,\n  wrapperProps: PropTypes.object,\n  noDataAlertProps: PropTypes.object,\n};\n\nCustomCategoryWidget.defaultProps = {\n  labels: {},\n  animation: true,\n  filterable: true,\n  searchable: true,\n  wrapperProps: {},\n  noDataAlertProps: {},\n};\n\nexport default CustomCategoryWidget;\n","import { useEffect } from 'react';\nimport popAggSource from 'data/sources/popAggSource';\nimport { POP_AGG_LAYER_ID } from 'components/layers/PopAggLayer';\nimport populationSource from 'data/sources/populationSource';\nimport { POPULATION_LAYER_ID } from 'components/layers/PopulationLayer';\nimport countiesSource from 'data/sources/countiesSource';\nimport { COUNTIES_LAYER_ID } from 'components/layers/CountiesLayer';\nimport { useDispatch } from 'react-redux';\nimport { addLayer, removeLayer, addSource, removeSource } from '@carto/react-redux';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Grid } from '@material-ui/core';\n\n//import { CategoryWidget } from '@carto/react-widgets';\nimport { AggregationTypes } from '@carto/react-core';\n\nimport CustomCategoryWidget from 'components/widgets/CustomCategoryWidget';\nimport { FormulaWidget } from '@carto/react-widgets';\n\nconst useStyles = makeStyles(() => ({\n  filters: {},\n}));\n\nexport default function Filters() {\n  const dispatch = useDispatch();\n  const classes = useStyles();\n\n  useEffect(() => {\n    dispatch(addSource(populationSource));\n\n    dispatch(\n      addLayer({\n        id: POPULATION_LAYER_ID,\n        source: populationSource.id,\n      })\n    );\n\n    return () => {\n      dispatch(removeLayer(POPULATION_LAYER_ID));\n      dispatch(removeSource(populationSource.id));\n    };\n  }, [dispatch]);\n\n  useEffect(() => {\n    dispatch(addSource(countiesSource));\n\n    dispatch(\n      addLayer({\n        id: COUNTIES_LAYER_ID,\n        source: countiesSource.id,\n      })\n    );\n\n    return () => {\n      dispatch(removeLayer(COUNTIES_LAYER_ID));\n      dispatch(removeSource(countiesSource.id));\n    };\n  }, [dispatch]);\n\n  useEffect(() => {\n    dispatch(addSource(popAggSource));\n\n    dispatch(\n      addLayer({\n        id: POP_AGG_LAYER_ID,\n        source: popAggSource.id,\n      })\n    );\n\n    return () => {\n      dispatch(removeLayer(POP_AGG_LAYER_ID));\n      dispatch(removeSource(popAggSource.id));\n    };\n  }, [dispatch]);\n\n  // [hygen] Add useEffect\n  const CustomFormatter = (value) => {\n    const formatted =\n      value > 1e6\n        ? `${Math.round(value / 1e6, 2)} M`\n        : value > 1e3\n        ? `${Math.round(value / 1e3, 2)} k`\n        : `${value}`;\n    return formatted;\n  };\n  return (\n    <Grid container direction='column' className={classes.filters}>\n      <Grid item>\n        <FormulaWidget\n          id='totPop'\n          title='Total Population'\n          dataSource={popAggSource.id}\n          column='aggregated_total'\n          operation={AggregationTypes.SUM}\n          formatter={(v) => CustomFormatter(v)}\n          onError={console.error}\n        />\n        <CustomCategoryWidget\n          id='stateCategory'\n          title='State Name'\n          dataSource={countiesSource.id}\n          column='state'\n          operation={AggregationTypes.COUNT}\n          onError={console.error}\n          otherSources={[\n            { id: populationSource.id, column: 'state' },\n            { id: popAggSource.id, column: 'state' },\n          ]}\n        />\n        <CustomCategoryWidget\n          id='countyCategory'\n          title='County Name'\n          dataSource={countiesSource.id}\n          column='county'\n          operation={AggregationTypes.COUNT}\n          onError={console.error}\n          otherSources={[\n            { id: populationSource.id, column: 'county' },\n            { id: popAggSource.id, column: 'county' },\n          ]}\n        />\n      </Grid>\n    </Grid>\n  );\n}\n"]}}