/*! For license information please see index.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-redux"),require("@carto/react-redux"),require("@carto/react-ui"),require("@carto/react-core"),require("@carto/react-workers"),require("@carto/react-api"),require("@carto/react-core/"),require("@carto/react-redux/"),require("@material-ui/core"),require("@material-ui/core/styles"),require("@nebula.gl/edit-modes"),require("@nebula.gl/layers"),require("@carto/react-basemaps/"),require("@deck.gl/core"),require("@deck.gl/layers")):"function"==typeof define&&define.amd?define(["react","react-redux","@carto/react-redux","@carto/react-ui","@carto/react-core","@carto/react-workers","@carto/react-api","@carto/react-core/","@carto/react-redux/","@material-ui/core","@material-ui/core/styles","@nebula.gl/edit-modes","@nebula.gl/layers","@carto/react-basemaps/","@deck.gl/core","@deck.gl/layers"],t):"object"==typeof exports?exports.cartoReactWidgets=t(require("react"),require("react-redux"),require("@carto/react-redux"),require("@carto/react-ui"),require("@carto/react-core"),require("@carto/react-workers"),require("@carto/react-api"),require("@carto/react-core/"),require("@carto/react-redux/"),require("@material-ui/core"),require("@material-ui/core/styles"),require("@nebula.gl/edit-modes"),require("@nebula.gl/layers"),require("@carto/react-basemaps/"),require("@deck.gl/core"),require("@deck.gl/layers")):e.cartoReactWidgets=t(e.react,e["react-redux"],e["@carto/react-redux"],e["@carto/react-ui"],e["@carto/react-core"],e["@carto/react-workers"],e["@carto/react-api"],e["@carto/react-core/"],e["@carto/react-redux/"],e["@material-ui/core"],e["@material-ui/core/styles"],e["@nebula.gl/edit-modes"],e["@nebula.gl/layers"],e["@carto/react-basemaps/"],e["@deck.gl/core"],e["@deck.gl/layers"])}(self,(function(e,t,n,r,o,i,a,s,c,u,l,p,h,f,d,v){return(()=>{var m={162:(e,t,n)=>{e.exports=n(47)},629:(e,t,n)=>{var r;!function(o,i,a,s){"use strict";var c,u=["","webkit","Moz","MS","ms","o"],l=i.createElement("div"),p=Math.round,h=Math.abs,f=Date.now;function d(e,t,n){return setTimeout(T(e,n),t)}function v(e,t,n){return!!Array.isArray(e)&&(m(e,n[t],n),!0)}function m(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==s)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function y(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=o.console&&(o.console.warn||o.console.log);return i&&i.call(o.console,r,n),e.apply(this,arguments)}}c="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==s&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])}return t}:Object.assign;var g=y((function(e,t,n){for(var r=Object.keys(t),o=0;o<r.length;)(!n||n&&e[r[o]]===s)&&(e[r[o]]=t[r[o]]),o++;return e}),"extend","Use `assign`."),E=y((function(e,t){return g(e,t,!0)}),"merge","Use `assign`.");function b(e,t,n){var r,o=t.prototype;(r=e.prototype=Object.create(o)).constructor=e,r._super=o,n&&c(r,n)}function T(e,t){return function(){return e.apply(t,arguments)}}function S(e,t){return"function"==typeof e?e.apply(t&&t[0]||s,t):e}function w(e,t){return e===s?t:e}function P(e,t,n){m(I(t),(function(t){e.addEventListener(t,n,!1)}))}function O(e,t,n){m(I(t),(function(t){e.removeEventListener(t,n,!1)}))}function x(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function _(e,t){return e.indexOf(t)>-1}function I(e){return e.trim().split(/\s+/g)}function A(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function C(e){return Array.prototype.slice.call(e,0)}function R(e,t,n){for(var r=[],o=[],i=0;i<e.length;){var a=t?e[i][t]:e[i];A(o,a)<0&&r.push(e[i]),o[i]=a,i++}return n&&(r=t?r.sort((function(e,n){return e[t]>n[t]})):r.sort()),r}function F(e,t){for(var n,r,o=t[0].toUpperCase()+t.slice(1),i=0;i<u.length;){if((r=(n=u[i])?n+o:t)in e)return r;i++}return s}var M=1;function L(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||o}var D="ontouchstart"in o,k=F(o,"PointerEvent")!==s,j=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N="touch",q="mouse",W=["x","y"],z=["clientX","clientY"];function U(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){S(e.options.enable,[e])&&n.handler(t)},this.init()}function H(e,t,n){var r=n.pointers.length,o=n.changedPointers.length,i=1&t&&r-o==0,a=12&t&&r-o==0;n.isFirst=!!i,n.isFinal=!!a,i&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,o=r.length;n.firstInput||(n.firstInput=Y(t)),o>1&&!n.firstMultiple?n.firstMultiple=Y(t):1===o&&(n.firstMultiple=!1);var i=n.firstInput,a=n.firstMultiple,c=a?a.center:i.center,u=t.center=B(r);t.timeStamp=f(),t.deltaTime=t.timeStamp-i.timeStamp,t.angle=K(c,u),t.distance=V(c,u),function(e,t){var n=t.center,r=e.offsetDelta||{},o=e.prevDelta||{},i=e.prevInput||{};1!==t.eventType&&4!==i.eventType||(o=e.prevDelta={x:i.deltaX||0,y:i.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=o.x+(n.x-r.x),t.deltaY=o.y+(n.y-r.y)}(n,t),t.offsetDirection=X(t.deltaX,t.deltaY);var l,p,d=G(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=d.x,t.overallVelocityY=d.y,t.overallVelocity=h(d.x)>h(d.y)?d.x:d.y,t.scale=a?(l=a.pointers,V((p=r)[0],p[1],z)/V(l[0],l[1],z)):1,t.rotation=a?function(e,t){return K(t[1],t[0],z)+K(e[1],e[0],z)}(a.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,o,i,a=e.lastInterval||t,c=t.timeStamp-a.timeStamp;if(8!=t.eventType&&(c>25||a.velocity===s)){var u=t.deltaX-a.deltaX,l=t.deltaY-a.deltaY,p=G(c,u,l);r=p.x,o=p.y,n=h(p.x)>h(p.y)?p.x:p.y,i=X(u,l),e.lastInterval=t}else n=a.velocity,r=a.velocityX,o=a.velocityY,i=a.direction;t.velocity=n,t.velocityX=r,t.velocityY=o,t.direction=i}(n,t);var v=e.element;x(t.srcEvent.target,v)&&(v=t.srcEvent.target),t.target=v}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function Y(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:p(e.pointers[n].clientX),clientY:p(e.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:t,center:B(t),deltaX:e.deltaX,deltaY:e.deltaY}}function B(e){var t=e.length;if(1===t)return{x:p(e[0].clientX),y:p(e[0].clientY)};for(var n=0,r=0,o=0;o<t;)n+=e[o].clientX,r+=e[o].clientY,o++;return{x:p(n/t),y:p(r/t)}}function G(e,t,n){return{x:t/e||0,y:n/e||0}}function X(e,t){return e===t?1:h(e)>=h(t)?e<0?2:4:t<0?8:16}function V(e,t,n){n||(n=W);var r=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return Math.sqrt(r*r+o*o)}function K(e,t,n){n||(n=W);var r=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return 180*Math.atan2(o,r)/Math.PI}U.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(L(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&O(this.element,this.evEl,this.domHandler),this.evTarget&&O(this.target,this.evTarget,this.domHandler),this.evWin&&O(L(this.element),this.evWin,this.domHandler)}};var Z={mousedown:1,mousemove:2,mouseup:4},J="mousedown",$="mousemove mouseup";function Q(){this.evEl=J,this.evWin=$,this.pressed=!1,U.apply(this,arguments)}b(Q,U,{handler:function(e){var t=Z[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:q,srcEvent:e}))}});var ee={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},te={2:N,3:"pen",4:q,5:"kinect"},ne="pointerdown",re="pointermove pointerup pointercancel";function oe(){this.evEl=ne,this.evWin=re,U.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}o.MSPointerEvent&&!o.PointerEvent&&(ne="MSPointerDown",re="MSPointerMove MSPointerUp MSPointerCancel"),b(oe,U,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),o=ee[r],i=te[e.pointerType]||e.pointerType,a=i==N,s=A(t,e.pointerId,"pointerId");1&o&&(0===e.button||a)?s<0&&(t.push(e),s=t.length-1):12&o&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,o,{pointers:t,changedPointers:[e],pointerType:i,srcEvent:e}),n&&t.splice(s,1))}});var ie={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ae="touchstart",se="touchstart touchmove touchend touchcancel";function ce(){this.evTarget=ae,this.evWin=se,this.started=!1,U.apply(this,arguments)}function ue(e,t){var n=C(e.touches),r=C(e.changedTouches);return 12&t&&(n=R(n.concat(r),"identifier",!0)),[n,r]}b(ce,U,{handler:function(e){var t=ie[e.type];if(1===t&&(this.started=!0),this.started){var n=ue.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:N,srcEvent:e})}}});var le={touchstart:1,touchmove:2,touchend:4,touchcancel:8},pe="touchstart touchmove touchend touchcancel";function he(){this.evTarget=pe,this.targetIds={},U.apply(this,arguments)}function fe(e,t){var n=C(e.touches),r=this.targetIds;if(3&t&&1===n.length)return r[n[0].identifier]=!0,[n,n];var o,i,a=C(e.changedTouches),s=[],c=this.target;if(i=n.filter((function(e){return x(e.target,c)})),1===t)for(o=0;o<i.length;)r[i[o].identifier]=!0,o++;for(o=0;o<a.length;)r[a[o].identifier]&&s.push(a[o]),12&t&&delete r[a[o].identifier],o++;return s.length?[R(i.concat(s),"identifier",!0),s]:void 0}function de(){U.apply(this,arguments);var e=T(this.handler,this);this.touch=new he(this.manager,e),this.mouse=new Q(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ve(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,me.call(this,t)):12&e&&me.call(this,t)}function me(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)}),2500)}}function ye(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var o=this.lastTouches[r],i=Math.abs(t-o.x),a=Math.abs(n-o.y);if(i<=25&&a<=25)return!0}return!1}b(he,U,{handler:function(e){var t=le[e.type],n=fe.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:N,srcEvent:e})}}),b(de,U,{handler:function(e,t,n){var r=n.pointerType==N,o=n.pointerType==q;if(!(o&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)ve.call(this,t,n);else if(o&&ye.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ge=F(l.style,"touchAction"),Ee=ge!==s,be="compute",Te="auto",Se="manipulation",we="none",Pe="pan-x",Oe="pan-y",xe=function(){if(!Ee)return!1;var e={},t=o.CSS&&o.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){e[n]=!t||o.CSS.supports("touch-action",n)})),e}();function _e(e,t){this.manager=e,this.set(t)}_e.prototype={set:function(e){e==be&&(e=this.compute()),Ee&&this.manager.element.style&&xe[e]&&(this.manager.element.style[ge]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return m(this.manager.recognizers,(function(t){S(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(_(e,we))return we;var t=_(e,Pe),n=_(e,Oe);return t&&n?we:t||n?t?Pe:Oe:_(e,Se)?Se:Te}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,o=_(r,we)&&!xe.none,i=_(r,Oe)&&!xe["pan-y"],a=_(r,Pe)&&!xe["pan-x"];if(o){var s=1===e.pointers.length,c=e.distance<2,u=e.deltaTime<250;if(s&&c&&u)return}if(!a||!i)return o||i&&6&n||a&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Ie=32;function Ae(e){this.options=c({},this.defaults,e||{}),this.id=M++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Ce(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Re(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Fe(e,t){var n=t.manager;return n?n.get(e):e}function Me(){Ae.apply(this,arguments)}function Le(){Me.apply(this,arguments),this.pX=null,this.pY=null}function De(){Me.apply(this,arguments)}function ke(){Ae.apply(this,arguments),this._timer=null,this._input=null}function je(){Me.apply(this,arguments)}function Ne(){Me.apply(this,arguments)}function qe(){Ae.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function We(e,t){return(t=t||{}).recognizers=w(t.recognizers,We.defaults.preset),new ze(e,t)}function ze(e,t){this.options=c({},We.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(k?oe:j?he:D?de:Q))(this,H),this.touchAction=new _e(this,this.options.touchAction),Ue(this,!0),m(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function Ue(e,t){var n,r=e.element;r.style&&(m(e.options.cssProps,(function(o,i){n=F(r.style,i),t?(e.oldCssProps[n]=r.style[n],r.style[n]=o):r.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}Ae.prototype={defaults:{},set:function(e){return c(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(v(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Fe(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return v(e,"dropRecognizeWith",this)||(e=Fe(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(v(e,"requireFailure",this))return this;var t=this.requireFail;return-1===A(t,e=Fe(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(v(e,"dropRequireFailure",this))return this;e=Fe(e,this);var t=A(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<8&&r(t.options.event+Ce(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=8&&r(t.options.event+Ce(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Ie},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=c({},e);if(!S(this.options.enable,[this,t]))return this.reset(),void(this.state=Ie);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},b(Me,Ae,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=6&t,o=this.attrTest(e);return r&&(8&n||!o)?16|t:r||o?4&n?8|t:2&t?4|t:2:Ie}}),b(Le,Me,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Oe),24&e&&t.push(Pe),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,o=e.direction,i=e.deltaX,a=e.deltaY;return o&t.direction||(6&t.direction?(o=0===i?1:i<0?2:4,n=i!=this.pX,r=Math.abs(e.deltaX)):(o=0===a?1:a<0?8:16,n=a!=this.pY,r=Math.abs(e.deltaY))),e.direction=o,n&&r>t.threshold&&o&t.direction},attrTest:function(e){return Me.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Re(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),b(De,Me,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),b(ke,Ae,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Te]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,o=e.deltaTime>t.time;if(this._input=e,!r||!n||12&e.eventType&&!o)this.reset();else if(1&e.eventType)this.reset(),this._timer=d((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return Ie},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),b(je,Me,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),b(Ne,Me,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Le.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&h(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Re(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),b(qe,Ae,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Se]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(r&&o&&n){if(4!=e.eventType)return this.failTimeout();var i=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||V(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,a&&i?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=d((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Ie},failTimeout:function(){return this._timer=d((function(){this.state=Ie}),this.options.interval,this),Ie},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),We.VERSION="2.0.7",We.defaults={domEvents:!1,touchAction:be,enable:!0,inputTarget:null,inputClass:null,preset:[[je,{enable:!1}],[De,{enable:!1},["rotate"]],[Ne,{direction:6}],[Le,{direction:6},["swipe"]],[qe],[qe,{event:"doubletap",taps:2},["tap"]],[ke]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},ze.prototype={set:function(e){return c(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,o=t.curRecognizer;(!o||o&&8&o.state)&&(o=t.curRecognizer=null);for(var i=0;i<r.length;)n=r[i],2===t.stopped||o&&n!=o&&!n.canRecognizeWith(o)?n.reset():n.recognize(e),!o&&14&n.state&&(o=t.curRecognizer=n),i++}},get:function(e){if(e instanceof Ae)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(v(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(v(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=A(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var n=this.handlers;return m(I(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(e!==s){var n=this.handlers;return m(I(e),(function(e){t?n[e]&&n[e].splice(A(n[e],t),1):delete n[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=i.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](t),r++}},destroy:function(){this.element&&Ue(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},c(We,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ie,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:ze,Input:U,TouchAction:_e,TouchInput:he,MouseInput:Q,PointerEventInput:oe,TouchMouseInput:de,SingleTouchInput:ce,Recognizer:Ae,AttrRecognizer:Me,Tap:qe,Pan:Le,Swipe:Ne,Pinch:De,Rotate:je,Press:ke,on:P,off:O,each:m,merge:E,extend:g,assign:c,inherit:b,bindFn:T,prefixed:F}),(void 0!==o?o:"undefined"!=typeof self?self:{}).Hammer=We,(r=function(){return We}.call(t,n,t,e))===s||(e.exports=r)}(window,document)},262:(e,t,n)=>{"use strict";var r=n(586);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},980:(e,t,n)=>{e.exports=n(262)()},586:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},47:e=>{var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(e,t,n){var r=p;return function(o,i){if(r===f)throw new Error("Generator is already running");if(r===d){if("throw"===o)throw i;return C()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=O(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===p)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var c=l(e,t,n);if("normal"===c.type){if(r=n.done?d:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=d,n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var p="suspendedStart",h="suspendedYield",f="executing",d="completed",v={};function m(){}function y(){}function g(){}var E={};c(E,i,(function(){return this}));var b=Object.getPrototypeOf,T=b&&b(b(A([])));T&&T!==n&&r.call(T,i)&&(E=T);var S=g.prototype=m.prototype=Object.create(E);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==typeof p&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(p).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function O(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=l(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function A(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:C}}function C(){return{value:t,done:!0}}return y.prototype=g,c(S,"constructor",g),c(g,"constructor",y),y.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,s,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},w(P.prototype),c(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new P(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(S),c(S,s,"Generator"),c(S,i,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return s.type="throw",s.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},178:e=>{"use strict";e.exports=a},306:e=>{"use strict";e.exports=f},485:e=>{"use strict";e.exports=o},38:e=>{"use strict";e.exports=s},347:e=>{"use strict";e.exports=n},987:e=>{"use strict";e.exports=c},214:e=>{"use strict";e.exports=r},116:e=>{"use strict";e.exports=i},946:e=>{"use strict";e.exports=d},445:e=>{"use strict";e.exports=v},670:e=>{"use strict";e.exports=u},793:e=>{"use strict";e.exports=l},59:e=>{"use strict";e.exports=p},102:e=>{"use strict";e.exports=h},156:t=>{"use strict";t.exports=e},756:e=>{"use strict";e.exports=t}},y={};function g(e){var t=y[e];if(void 0!==t)return t.exports;var n=y[e]={exports:{}};return m[e](n,n.exports,g),n.exports}g.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return g.d(t,{a:t}),t},g.d=(e,t)=>{for(var n in t)g.o(t,n)&&!g.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},g.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),g.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var E={};return(()=>{"use strict";function e(){return e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.apply(this,arguments)}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}g.r(E),g.d(E,{CategoryWidget:()=>k,FeatureSelectionLayer:()=>At,FeatureSelectionWidget:()=>Te,FormulaWidget:()=>N,GeocoderWidget:()=>G,HistogramWidget:()=>J,LegendWidget:()=>ne,PieWidget:()=>ee,ScatterPlotWidget:()=>oe,TableWidget:()=>we,TimeSeriesWidget:()=>ce,geocodeStreetPoint:()=>w,getCategories:()=>T,getFormula:()=>y,getHistogram:()=>b,getScatter:()=>P,getTable:()=>x,useSourceFilters:()=>F});var o=g(156),i=g.n(o),a=g(756),s=g(980),c=g.n(s),u=g(347),l=g(214),p=g(485);function h(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){h(i,r,o,a,s,"next",e)}function s(e){h(i,r,o,a,s,"throw",e)}a(void 0)}))}}var d=g(162),v=g.n(d),m=g(116),y=function(){var e=f(v().mark((function e(t){var n,r,o,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.operation,r=t.column,o=t.filters,i=t.dataSource,e.abrupt("return",(0,m.executeTask)(i,m.Methods.FEATURES_FORMULA,{filters:o,operation:n,column:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=f(v().mark((function e(t){var n,r,o,i,a;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.column,r=t.operation,o=t.ticks,i=t.filters,a=t.dataSource,e.abrupt("return",(0,m.executeTask)(a,m.Methods.FEATURES_HISTOGRAM,{filters:i,operation:r,column:n,ticks:o}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=f(v().mark((function e(t){var n,r,o,i,a;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.column,r=t.operationColumn,o=t.operation,i=t.filters,a=t.dataSource,e.abrupt("return",(0,m.executeTask)(a,m.Methods.FEATURES_CATEGORY,{filters:i,operation:o,column:n,operationColumn:r||n}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=g(178),w=function(){var e=f(v().mark((function e(t,n){var o,i,a,s,c,u,l,p,h,f,d,m=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.searchText,i=n.city,a=n.state,s=n.country,c=m.length>2&&void 0!==m[2]?m[2]:{},"default_public"!==t.apiKey){e.next=4;break}throw new Error("To search a location you need to login or provide an API KEY");case 4:return u="SELECT ST_AsGeoJSON(cdb_geocode_street_point('".concat(o,"', '").concat(null!=i?i:"","', '").concat(null!=a?a:"","', '").concat(null!=s?s:"","')) AS geometry"),e.next=7,(0,S.executeSQL)({credentials:t,query:u,opts:c});case 7:if(l=e.sent,null!==(p=JSON.parse(l[0].geometry))){e.next=11;break}return e.abrupt("return",null);case 11:return h=r(p.coordinates,2),f=h[0],d=h[1],e.abrupt("return",{longitude:f,latitude:d});case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),P=function(){var e=f(v().mark((function e(t){var n,r,o,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.xAxisColumn,r=t.yAxisColumn,o=t.filters,i=t.dataSource,e.abrupt("return",(0,m.executeTask)(i,m.Methods.FEATURES_SCATTERPLOT,{filters:o,xAxisColumn:n,yAxisColumn:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=f(v().mark((function e(t){var n,r,o,i,a,s;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filters,r=t.dataSource,o=t.column,i=t.operationColumn,a=t.operation,s=t.stepSize,e.abrupt("return",(0,m.executeTask)(r,m.Methods.FEATURES_TIME_SERIES,{filters:n,column:o,stepSize:s,operationColumn:i||o,operation:a}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=f(v().mark((function e(t){var n,r,o,i,a,s;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filters,r=t.dataSource,o=t.rowsPerPage,i=t.page,a=t.sortBy,s=t.sortDirection,e.abrupt("return",(0,m.executeTask)(r,m.Methods.FEATURES_RAW,{filters:n,limit:o,page:i,sortBy:a,sortByDirection:s}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=g(38),I=g(987),A=Object.prototype.hasOwnProperty;function C(e,t,n){for(n of e.keys())if(R(n,t))return n}function R(e,t){var n,r,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((r=e.length)===t.length)for(;r--&&R(e[r],t[r]););return-1===r}if(n===Set){if(e.size!==t.size)return!1;for(r of e){if((o=r)&&"object"==typeof o&&!(o=C(t,o)))return!1;if(!t.has(o))return!1}return!0}if(n===Map){if(e.size!==t.size)return!1;for(r of e){if((o=r[0])&&"object"==typeof o&&!(o=C(t,o)))return!1;if(!R(r[1],t.get(o)))return!1}return!0}if(n===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(n===DataView){if((r=e.byteLength)===t.byteLength)for(;r--&&e.getInt8(r)===t.getInt8(r););return-1===r}if(ArrayBuffer.isView(e)){if((r=e.byteLength)===t.byteLength)for(;r--&&e[r]===t[r];);return-1===r}if(!n||"object"==typeof e){for(n in r=0,e){if(A.call(e,n)&&++r&&!A.call(t,n))return!1;if(!(n in t)||!R(e[n],t[n]))return!1}return Object.keys(t).length===r}}return e!=e&&t!=t}function F(e){var t,n,r=e.dataSource,i=e.id,s=(0,a.useSelector)((function(e){return(0,I.selectSourceById)(e,r)||{}})).filters;return t=(0,o.useMemo)((function(){return(0,_._getApplicableFilters)(s,i)}),[s,i]),R((n=(0,o.useRef)(t)).current,t)||(n.current=t),n.current}function M(e){var t=e.dataSource,n=e.id,r=e.column,i=e.type,s=(0,a.useSelector)((function(e){return(0,I.selectSourceById)(e,t)||{}})).filters;return(0,o.useMemo)((function(){var e,t=null==s||null===(e=s[r])||void 0===e?void 0:e[i];return t&&t.owner===n?t.values:null}),[s,r,i,n])}var L=[];function D(t){var n=t.id,s=t.title,c=t.dataSource,h=t.column,f=t.operationColumn,d=t.operation,v=t.formatter,m=t.labels,y=t.animation,g=t.filterable,E=t.searchable,b=t.onError,S=t.wrapperProps,w=t.noDataAlertProps,P=(0,a.useDispatch)(),O=(0,a.useSelector)((function(e){return(0,I.selectAreFeaturesReadyForSource)(e,c)})),x=r((0,o.useState)([]),2),_=x[0],A=x[1],C=r((0,o.useState)(!0),2),R=C[0],D=C[1],k=F({dataSource:c,id:n}),j=M({dataSource:c,id:n,column:h,type:p._FilterTypes.IN})||L;(0,o.useEffect)((function(){D(!0),O&&T({column:h,operationColumn:f,operation:d,filters:k,dataSource:c}).then((function(e){e&&(D(!1),A(e))})).catch((function(e){D(!1),b&&b(e)}))}),[n,h,f,d,k,c,D,b,O]);var N=(0,o.useCallback)((function(e){e&&e.length?P((0,u.addFilter)({id:c,column:h,type:p._FilterTypes.IN,values:e,owner:n})):P((0,u.removeFilter)({id:c,column:h}))}),[h,c,n,P]);return i().createElement(l.WrapperWidgetUI,e({title:s,isLoading:R},S),_.length||R?i().createElement(l.CategoryWidgetUI,{data:_,formatter:v,labels:m,selectedCategories:j,onSelectedCategoriesChange:N,animation:y,filterable:g,searchable:E}):i().createElement(l.NoDataAlert,w))}D.propTypes={id:c().string.isRequired,title:c().string.isRequired,dataSource:c().string.isRequired,column:c().string.isRequired,operationColumn:c().string,operation:c().oneOf(Object.values(p.AggregationTypes)).isRequired,formatter:c().func,labels:c().object,animation:c().bool,filterable:c().bool,searchable:c().bool,onError:c().func,wrapperProps:c().object,noDataAlertProps:c().object},D.defaultProps={labels:{},animation:!0,filterable:!0,searchable:!0,wrapperProps:{},noDataAlertProps:{}};const k=D;function j(t){var n=t.id,s=t.title,c=t.dataSource,p=t.column,h=t.operation,f=t.formatter,d=t.animation,v=t.onError,m=t.wrapperProps,g=(0,a.useSelector)((function(e){return(0,u.selectAreFeaturesReadyForSource)(e,c)})),E=F({dataSource:c,id:n}),b=r((0,o.useState)(null),2),T=b[0],S=b[1],w=r((0,o.useState)(!0),2),P=w[0],O=w[1];return(0,o.useEffect)((function(){O(!0),g&&y({operation:h,column:p,filters:E,dataSource:c}).then((function(e){e&&e[0]&&(O(!1),S(e[0].value))})).catch((function(e){O(!1),v&&v(e)}))}),[h,p,E,c,O,v,g]),i().createElement(l.WrapperWidgetUI,e({title:s,isLoading:P},m),i().createElement(l.FormulaWidgetUI,{data:T,formatter:f,unitBefore:!0,animation:d}))}j.propTypes={id:s.PropTypes.string.isRequired,title:s.PropTypes.string.isRequired,dataSource:s.PropTypes.string.isRequired,column:s.PropTypes.string.isRequired,operation:s.PropTypes.oneOf(Object.values(p.AggregationTypes)).isRequired,formatter:s.PropTypes.func,animation:s.PropTypes.bool,onError:s.PropTypes.func,wrapperProps:s.PropTypes.object},j.defaultProps={animation:!0,wrapperProps:{}};const N=j;function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W=g(670);function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=(0,g(793).makeStyles)((function(e){return{paperInput:{height:e.spacing(4.5),width:e.spacing(30),paddingLeft:e.spacing(1.5),borderRadius:4,display:"flex",alignItems:"center"},icon:{fill:e.palette.text.secondary,height:"1em",fontSize:"".concat(e.typography.body2.lineHeight,"em")},clear:U({},e.typography.body2),input:U(U({},e.typography.body2),{},{width:"calc(100% - ".concat(e.spacing(5),"px)"),marginLeft:e.spacing(1)})}})),Y=function(e){return i().createElement(W.SvgIcon,e,i().createElement("path",{d:"M11,4 C14.8659932,4 18,7.13400675 18,11 C18,12.7003211 17.3937669,14.2590489 16.3856562,15.4718279 L19.4748737,18.5606602 L18.0606602,19.9748737 L14.8998887,16.8138615 C13.7854137,17.5629194 12.4437497,18 11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 Z M11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 Z",fill:"inherit"}))};function B(e){var t=(0,o.useRef)(),n=(0,a.useSelector)(u.selectOAuthCredentials),s=(0,a.useSelector)((function(e){return e.carto.credentials})),c=n||s,l=r((0,o.useState)(""),2),p=l[0],h=l[1],d=r((0,o.useState)(!1),2),m=d[0],y=d[1],g=(0,a.useDispatch)();(0,o.useEffect)((function(){g((0,u.addLayer)({id:"geocoderLayer"}))}),[g]);var E=H(),b=function(){var e=f(v().mark((function e(t){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:13===t.keyCode&&t.target.blur();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=f(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p.length&&S();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=f(v().mark((function e(){var t;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=15;break}return e.prev=1,y(!0),e.next=5,w(c,{searchText:p,country:""});case 5:(t=e.sent)&&(P(t),O(t)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),x(e.t0);case 12:return e.prev=12,y(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})));return function(){return e.apply(this,arguments)}}(),P=function(e){g((0,u.setViewState)({longitude:e.longitude,latitude:e.latitude,zoom:16,transitionDuration:500}))},O=function(e){g({type:"carto/setGeocoderResult",payload:e})},x=function(t){e.onError&&e.onError(t)};return i().createElement(W.Paper,{className:"".concat(e.className," ").concat(E.paperInput),elevation:2},m?i().createElement(W.CircularProgress,{size:20,className:E.icon}):i().createElement(Y,{className:E.icon}),i().createElement(W.InputBase,{type:"search",tabIndex:-1,inputRef:t,size:"small",placeholder:"Search address",className:E.input,value:p,inputProps:{"aria-label":"GeocoderSearch"},onChange:function(e){h(e.target.value)},onInput:function(e){""===e.target.value&&O(null)},onKeyDown:b,onBlur:T}))}B.propTypes={className:s.PropTypes.string,onError:s.PropTypes.func},B.defaultProps={};const G=B;function X(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}var K=[];function Z(t){var n=t.id,s=t.title,c=t.dataSource,h=t.column,f=t.operation,d=t.ticks,v=t.xAxisFormatter,m=t.dataAxis,y=t.formatter,g=t.tooltip,E=t.animation,T=t.filterable,S=t.onError,w=t.wrapperProps,P=t.noDataAlertProps,O=(0,a.useDispatch)(),x=r((0,o.useState)([]),2),_=x[0],A=x[1],C=r((0,o.useState)(!0),2),R=C[0],L=C[1],D=F({dataSource:c,id:n}),k=(0,a.useSelector)((function(e){return(0,I.selectAreFeaturesReadyForSource)(e,c)})),j=M({dataSource:c,id:n,column:h,type:p._FilterTypes.CLOSED_OPEN}),N=(0,o.useMemo)((function(){return(j||K).map((function(e){var t=r(e,2),n=t[0],o=t[1];if(null==n)return 0;if(null==o)return d.length;var i=d.indexOf(n);return-1!==i?i+1:null})).filter((function(e){return null!==e}))}),[j,d]),q=(0,o.useCallback)((function(e){var t=r(e,1)[0],n=y?y(t.value,t.dataIndex,d):{prefix:"",value:t.value};return"object"===V(n)?"".concat(n.prefix).concat(n.value):n}),[y,d]);(0,o.useEffect)((function(){L(!0),k&&b({column:h,operation:f,ticks:d,filters:D,dataSource:c}).then((function(e){e&&(L(!1),A(e))})).catch((function(e){L(!1),S&&S(e)}))}),[n,h,f,d,c,D,L,S,k]);var W=(0,o.useCallback)((function(e){var t=e.bars;if(t&&t.length){var r=t.map((function(e){return[d[e-1],d.length!==e+1?d[e]:void 0]}));O((0,u.addFilter)({id:c,column:h,type:p._FilterTypes.CLOSED_OPEN,values:r,owner:n}))}else O((0,u.removeFilter)({id:c,column:h}))}),[h,c,n,O,d]),z=d.reduce((function(e,t,n){return 0===e.length?["< ".concat(t)]:n===d.length-1?[].concat(X(e),["< ".concat(t),">= ".concat(t)]):[].concat(X(e),["< ".concat(t)])}),[]);return i().createElement(l.WrapperWidgetUI,e({title:s},w,{isLoading:R}),_.length||R?i().createElement(l.HistogramWidgetUI,{data:_,dataAxis:m||z,selectedBars:N,onSelectedBarsChange:W,tooltip:g,tooltipFormatter:q,xAxisFormatter:v,yAxisFormatter:y,animation:E,filterable:T}):i().createElement(l.NoDataAlert,P))}Z.propTypes={id:s.PropTypes.string.isRequired,title:s.PropTypes.string.isRequired,dataSource:s.PropTypes.string.isRequired,column:s.PropTypes.string.isRequired,operation:s.PropTypes.oneOf(Object.values(p.AggregationTypes)).isRequired,xAxisFormatter:s.PropTypes.func,formatter:s.PropTypes.func,tooltip:s.PropTypes.bool,animation:s.PropTypes.bool,filterable:s.PropTypes.bool,ticks:s.PropTypes.array.isRequired,onError:s.PropTypes.func,wrapperProps:s.PropTypes.object,noDataAlertProps:s.PropTypes.object},Z.defaultProps={tooltip:!0,animation:!0,filterable:!0,wrapperProps:{},noDataAlertProps:{}};const J=Z;var $=[];function Q(t){var n=t.id,s=t.title,c=t.height,h=t.dataSource,f=t.column,d=t.operationColumn,v=t.operation,m=t.formatter,y=t.tooltipFormatter,g=t.labels,E=t.animation,b=t.filterable,S=t.colors,w=t.onError,P=t.wrapperProps,O=t.noDataAlertProps,x=(0,a.useDispatch)(),_=r((0,o.useState)([]),2),A=_[0],C=_[1],R=M({dataSource:h,id:n,column:f,type:p._FilterTypes.IN})||$,L=r((0,o.useState)(!0),2),D=L[0],k=L[1],j=(0,a.useSelector)((function(e){return(0,I.selectAreFeaturesReadyForSource)(e,h)})),N=F({dataSource:h,id:n});(0,o.useEffect)((function(){k(!0),j&&T({column:f,operation:v,operationColumn:d,filters:N,dataSource:h}).then((function(e){e&&(k(!1),C(e))})).catch((function(e){k(!1),w&&w(e)}))}),[n,f,d,v,N,h,k,w,j]);var q=(0,o.useCallback)((function(e){e&&e.length?x((0,u.addFilter)({id:h,column:f,type:p._FilterTypes.IN,values:e,owner:n})):x((0,u.removeFilter)({id:h,column:f}))}),[f,h,n,x]);return i().createElement(l.WrapperWidgetUI,e({title:s,isLoading:D},P),A.length||D?i().createElement(l.PieWidgetUI,{data:A,formatter:m,height:c,tooltipFormatter:y,colors:S,labels:g,animation:E,filterable:b,selectedCategories:R,onSelectedCategoriesChange:q}):i().createElement(l.NoDataAlert,O))}Q.propTypes={id:c().string.isRequired,title:c().string.isRequired,height:c().number,dataSource:c().string.isRequired,column:c().string.isRequired,operationColumn:c().string,operation:c().oneOf(Object.values(p.AggregationTypes)).isRequired,formatter:c().func,tooltipFormatter:c().func,labels:c().object,animation:c().bool,filterable:c().bool,onError:c().func,colors:c().arrayOf(c().string),wrapperProps:c().object,noDataAlertProps:c().object},Q.defaultProps={animation:!0,filterable:!0,wrapperProps:{},noDataAlertProps:{}};const ee=Q;function te(e){var t=e.className,n=e.customLegendTypes,s=e.initialCollapsed,c=(0,a.useDispatch)(),u=(0,a.useSelector)((function(e){return Object.values(e.carto.layers).filter((function(e){return!!e.legend}))})),p=r((0,o.useState)(s),2),h=p[0],f=p[1];return u.length?i().createElement(l.LegendWidgetUI,{className:t,customLegendTypes:n,layers:u,onChangeVisibility:function(e){var t=e.id,n=e.visible;c((0,I.updateLayer)({id:t,layerAttributes:{visible:n}}))},onChangeOpacity:function(e){var t=e.id,n=e.opacity;c((0,I.updateLayer)({id:t,layerAttributes:{opacity:n}}))},collapsed:h,onChangeCollapsed:f,onChangeLegendRowCollapsed:function(e){var t=e.id,n=e.collapsed;c((0,I.updateLayer)({id:t,layerAttributes:{legend:{collapsed:n}}}))}}):null}te.propTypes={className:c().string,customLegendTypes:c().objectOf(c().func),initialCollapsed:c().bool},te.defaultProps={initialCollapsed:!1};const ne=te;function re(t){var n=t.id,s=t.title,c=t.dataSource,p=t.xAxisColumn,h=t.yAxisColumn,f=t.animation,d=t.yAxisFormatter,v=t.xAxisFormatter,m=t.tooltipFormatter,y=t.onError,g=t.wrapperProps,E=t.noDataAlertProps,b=r((0,o.useState)([]),2),T=b[0],S=b[1],w=r((0,o.useState)(!0),2),O=w[0],x=w[1],_=(0,a.useSelector)((function(e){return(0,u.selectAreFeaturesReadyForSource)(e,c)})),I=F({dataSource:c,id:n});return(0,o.useEffect)((function(){x(!0),_&&P({xAxisColumn:p,yAxisColumn:h,filters:I,dataSource:c}).then((function(e){e&&(x(!1),S(e))})).catch((function(e){x(!1),y&&y(e)}))}),[n,p,h,c,I,x,_,y]),i().createElement(l.WrapperWidgetUI,e({title:s,isLoading:O},g),T.length||O?i().createElement(l.ScatterPlotWidgetUI,{data:T,tooltipFormatter:m,xAxisFormatter:v,yAxisFormatter:d,animation:f}):i().createElement(l.NoDataAlert,E))}re.propTypes={id:s.PropTypes.string.isRequired,title:s.PropTypes.string.isRequired,dataSource:s.PropTypes.string.isRequired,xAxisColumn:s.PropTypes.string.isRequired,yAxisColumn:s.PropTypes.string.isRequired,animation:s.PropTypes.bool,xAxisFormatter:s.PropTypes.func,yAxisFormatter:s.PropTypes.func,tooltipFormatter:s.PropTypes.func,onError:s.PropTypes.func,wrapperProps:s.PropTypes.object,noDataAlertProps:s.PropTypes.object},re.defaultProps={tooltip:!0,animation:!0,wrapperProps:{},noDataAlertProps:{},tooltipFormatter:function(e){return"[".concat(e.value[0],", ").concat(e.value[1],")")},xAxisFormatter:function(e){return e},yAxisFormatter:function(e){return e}};const oe=re;var ie,ae=(q(ie={},p.GroupDateTypes.YEARS,31536e6),q(ie,p.GroupDateTypes.MONTHS,2592e6),q(ie,p.GroupDateTypes.WEEKS,6048e5),q(ie,p.GroupDateTypes.DAYS,864e5),q(ie,p.GroupDateTypes.HOURS,36e5),q(ie,p.GroupDateTypes.MINUTES,6e4),ie);function se(t){var n=t.id,s=t.title,c=t.dataSource,h=t.column,f=t.operationColumn,d=t.operation,v=t.stepSizeOptions,m=t.onError,y=t.wrapperProps,g=t.noDataAlertProps,E=t.chartType,b=t.tooltip,T=t.tooltipFormatter,S=t.formatter,w=t.height,P=t.showControls,x=t.animation,_=t.isPlaying,I=t.onPlay,A=t.isPaused,C=t.onPause,R=t.onStop,M=t.onTimelineUpdate,L=t.timeWindow,D=t.onTimeWindowUpdate,k=t.stepSize,j=(0,a.useDispatch)(),N=(0,a.useSelector)((function(e){return(0,u.selectAreFeaturesReadyForSource)(e,c)})),q=F({dataSource:c,id:n}),z=r((0,o.useState)([]),2),U=z[0],H=z[1],Y=r((0,o.useState)(k),2),B=Y[0],G=Y[1],V=r((0,o.useState)(!0),2),K=V[0],Z=V[1];(0,o.useEffect)((function(){k!==B&&G(k)}),[k]),(0,o.useEffect)((function(){Z(!0),N&&O({filters:q,dataSource:c,column:h,stepSize:B,operationColumn:f,operation:d}).then((function(e){e&&(Z(!1),H(e))})).catch((function(e){Z(!1),m&&m(e)}))}),[n,q,c,h,B,N,Z,f,d,m]);var J=(0,o.useCallback)((function(e){K||(j((0,u.addFilter)({id:c,column:h,type:p._FilterTypes.TIME,values:[e.map((function(e){var t;return(null===(t=e.getTime)||void 0===t?void 0:t.call(e))||e}))],owner:n})),D&&D(e))}),[h,c,K,j,n,D]),$=(0,o.useCallback)((function(e){if(!K){var t=U[e].name;j((0,u.addFilter)({id:c,column:h,type:p._FilterTypes.TIME,values:[[t,t+ae[B]]],owner:n})),M&&M(new Date(t))}}),[h,c,K,j,n,M,B,U]),Q=(0,o.useCallback)((function(){j((0,u.removeFilter)({id:c,column:h})),R&&R()}),[h,c,j,R]),ee=r((0,o.useState)(null),2),te=ee[0],ne=ee[1],re=function(){ne(null)};return i().createElement(i().Fragment,null,i().createElement(l.WrapperWidgetUI,e({title:s,isLoading:K},y,{actions:[].concat(X((null==y?void 0:y.actions)||[]),X(null!=v&&v.length?[{id:"a0",name:"Bucket size",icon:i().createElement(ue,null),action:function(e){null!=e&&e.currentTarget&&ne(e.currentTarget)}}]:[]))}),U.length||K?i().createElement(l.TimeSeriesWidgetUI,{data:U,stepSize:B,chartType:E,tooltip:b,tooltipFormatter:T,formatter:S,height:w,showControls:P,animation:x,isPlaying:_,onPlay:I,isPaused:A,onPause:C,onStop:Q,onTimelineUpdate:$,timeWindow:L,onTimeWindowUpdate:J}):i().createElement(l.NoDataAlert,g)),i().createElement(W.Menu,{anchorEl:te,keepMounted:!0,open:Boolean(te),onClose:re},i().createElement(W.MenuItem,{disabled:!0},i().createElement(W.Typography,{variant:"caption",color:"textSecondary"},"Step size")),v.map((function(e){return i().createElement(W.MenuItem,{key:e,selected:B===e,onClick:function(){return function(e){G(e),re()}(e)}},(0,W.capitalize)(e))}))))}se.propTypes={id:s.PropTypes.string.isRequired,title:s.PropTypes.string.isRequired,dataSource:s.PropTypes.string.isRequired,column:s.PropTypes.string.isRequired,operationColumn:s.PropTypes.string,operation:s.PropTypes.oneOf(Object.values(p.AggregationTypes)).isRequired,stepSizeOptions:s.PropTypes.arrayOf(s.PropTypes.oneOf(Object.values(p.GroupDateTypes))),onError:s.PropTypes.func,wrapperProps:s.PropTypes.object,noDataAlertProps:s.PropTypes.object,tooltip:s.PropTypes.bool,tooltipFormatter:s.PropTypes.func,formatter:s.PropTypes.func,height:s.PropTypes.string,animation:s.PropTypes.bool,isPlaying:s.PropTypes.bool,onPlay:s.PropTypes.func,isPaused:s.PropTypes.bool,onPause:s.PropTypes.func,onStop:s.PropTypes.func,onTimelineUpdate:s.PropTypes.func,timeWindow:s.PropTypes.arrayOf(s.PropTypes.any),onTimeWindowUpdate:s.PropTypes.func,showControls:s.PropTypes.bool,chartType:s.PropTypes.oneOf(Object.values(l.TIME_SERIES_CHART_TYPES)),stepSize:s.PropTypes.oneOf(Object.values(p.GroupDateTypes)).isRequired},se.defaultProps={operation:p.AggregationTypes.COUNT,stepSizeOptions:[],wrapperProps:{},noDataAlertProps:{},tooltip:!0,formatter:function(e){return e},animation:!0,isPlaying:!1,isPaused:!1,timeWindow:[],showControls:!0,chartType:l.TIME_SERIES_CHART_TYPES.LINE};const ce=se;function ue(){return i().createElement(W.SvgIcon,null,i().createElement("path",{d:"M19 14l.3 1.5c.32.12.614.278.883.475l.197.155 1.45-.49 1 1.73-1.14 1c.069.429.078.68.03 1.065l-.03.205 1.14 1-1 1.73-1.45-.49c-.256.216-.538.394-.845.533l-.235.097L19 24h-2l-.3-1.51c-.32-.12-.614-.278-.883-.475l-.197-.155-1.45.49-1-1.73 1.14-1c-.067-.417-.078-.667-.033-1.028l.033-.232-1.14-1 1-1.73 1.45.49c.256-.216.538-.394.845-.533l.235-.097L17 14h2zM8 2v2h8V2h2v2h1c1.05 0 1.918.82 1.994 1.851L21 6v6h-2v-2H5v10h6v2H5c-1.06 0-1.919-.82-1.995-1.851L3 20l.01-14c0-1.05.802-1.918 1.84-1.994L5 4h1V2h2zm10 15c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm1-11H5v2h14V6z",id:"-↳Color",fill:"inherit"}))}var le;function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe=l.featureSelectionIcons.PolygonIcon,de=l.featureSelectionIcons.RectangleIcon,ve=l.featureSelectionIcons.CircleIcon,me=l.featureSelectionIcons.LassoIcon,ye=l.featureSelectionIcons.CursorIcon,ge=(q(le={},p.FEATURE_SELECTION_MODES.POLYGON,{label:"Polygon",icon:i().createElement(fe,null)}),q(le,p.FEATURE_SELECTION_MODES.RECTANGLE,{label:"Rectangle",icon:i().createElement(de,null)}),q(le,p.FEATURE_SELECTION_MODES.CIRCLE,{label:"Circle",icon:i().createElement(ve,null)}),q(le,p.FEATURE_SELECTION_MODES.LASSO_TOOL,{label:"Lasso tool",icon:i().createElement(me,null)}),le),Ee=q({},p.EDIT_MODES.EDIT,{label:"Edit mask",icon:i().createElement(ye,null)});function be(e){var t=e.className,n=e.selectionModes,r=e.editModes,s=e.tooltipPlacement,c=(0,a.useDispatch)(),p=(0,a.useSelector)((function(e){return e.carto.spatialFilter})),h=(0,a.useSelector)((function(e){return e.carto.featureSelectionMode})),f=(0,a.useSelector)((function(e){return e.carto.featureSelectionEnabled})),d=(0,o.useMemo)((function(){return n.filter((function(e){return ge[e]})).map((function(e){return he({id:e},ge[e])}))}),[n]),v=(0,o.useMemo)((function(){return r.filter((function(e){return Ee[e]})).map((function(e){return he({id:e},Ee[e])}))}),[r]),m=function(e){c((0,u.setFeatureSelectionEnabled)(e))};return i().createElement(l.FeatureSelectionWidgetUI,{className:t,selectionModes:d,editModes:v,selectedMode:h,onSelectMode:function(e){c((0,u.setFeatureSelectionMode)(e)),m(!0)},enabled:f,onEnabledChange:m,tooltipPlacement:s,geometry:p,onSelectGeometry:function(){c((0,u.addSpatialFilter)({geometry:he(he({},p),{},{properties:he(he({},p.properties),{},{disabled:!p.properties.disabled})})}))},onDeleteGeometry:function(){c((0,u.removeSpatialFilter)())}})}be.defaultProps={selectionModes:Object.values(p.FEATURE_SELECTION_MODES),editModes:Object.values(p.EDIT_MODES),defaultSelectedMode:Object.values(p.FEATURE_SELECTION_MODES)[0],defaultEnabled:l.FeatureSelectionWidgetUI.defaultProps.enabled,tooltipPlacement:l.FeatureSelectionWidgetUI.defaultProps.tooltipPlacement},be.propTypes={className:l.FeatureSelectionWidgetUI.propTypes.className,selectionModes:c().arrayOf(c().oneOf(Object.values(p.FEATURE_SELECTION_MODES))),editModes:c().arrayOf(c().oneOf(Object.values(p.EDIT_MODES))),defaultEnabled:l.FeatureSelectionWidgetUI.propTypes.enabled,defaultSelectedMode:c().oneOf([].concat(X(Object.values(p.FEATURE_SELECTION_MODES)),X(Object.values(p.EDIT_MODES)))),tooltipPlacement:l.FeatureSelectionWidgetUI.propTypes.tooltipPlacement};const Te=be;function Se(t){var n=t.id,s=t.title,c=t.dataSource,u=t.columns,p=t.wrapperProps,h=t.noDataAlertProps,f=t.onError,d=t.initialPageSize,v=void 0===d?10:d,m=t.height,y=t.dense,g=r((0,o.useState)(v),2),E=g[0],b=g[1],T=r((0,o.useState)(0),2),S=T[0],w=T[1],P=r((0,o.useState)(0),2),O=P[0],_=P[1],A=r((0,o.useState)(void 0),2),C=A[0],R=A[1],M=r((0,o.useState)("asc"),2),L=M[0],D=M[1],k=r((0,o.useState)([]),2),j=k[0],N=k[1],q=r((0,o.useState)(!0),2),W=q[0],z=q[1],U=F({dataSource:c,id:n}),H=(0,a.useSelector)((function(e){return(0,I.selectAreFeaturesReadyForSource)(e,c)}));return(0,o.useEffect)((function(){w(0)}),[c,H,U]),(0,o.useEffect)((function(){H&&(z(!0),x({filters:U,dataSource:c,rowsPerPage:E,page:S,sortBy:C,sortDirection:L}).then((function(e){e&&(N(e.data),_(e.totalCount))})).catch((function(e){f&&f(e)})).finally((function(){z(!1)})))}),[n,c,U,C,L,S,E,f,H]),i().createElement(l.WrapperWidgetUI,e({title:s},p,{isLoading:W}),j.length||W?i().createElement(l.TableWidgetUI,{columns:u,rows:j,pagination:!0,totalCount:O,page:S,onSetPage:w,onSetRowsPerPage:b,rowsPerPage:E,sorting:!0,sortBy:C,sortDirection:L,onSetSortBy:R,onSetSortDirection:D,height:m,dense:y}):i().createElement(l.NoDataAlert,h))}Se.propTypes={id:c().string.isRequired,title:c().string.isRequired,dataSource:c().string.isRequired,columns:c().arrayOf(c().shape({field:c().string.isRequired,headerName:c().string.isRequired,align:c().oneOf(["left","right"])})).isRequired,onError:c().func,wrapperProps:c().object,noDataAlertProps:c().object,initialPageSize:c().number,height:c().string,dense:c().bool};const we=Se;var Pe=g(59);function Oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _e(e){return _e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_e(e)}function Ie(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_e(e)););return e}function Ae(){return Ae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Ie(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ae.apply(this,arguments)}function Ce(e,t){return Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ce(e,t)}function Re(e,t){if(t&&("object"===V(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}var Fe=g(102);function Me(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Le(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var De=["anyclick","pointermove","panstart","panmove","panend","keyup"],ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),t&&Ce(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_e(r);if(o){var n=_e(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Re(this,e)});function a(){return Oe(this,a),i.apply(this,arguments)}return t=a,n=[{key:"updateState",value:function(e){var t=e.props,n=e.oldProps,r=e.context,o=e.changeFlags;t.eventManager!==n.eventManager&&(this._removeEventHandlers(t.eventManager),this._removeEventHandlers(n.eventManager),this._addEventHandlers()),Ae(_e(a.prototype),"updateState",this).call(this,{props:t,oldProps:n,context:r,changeFlags:o})}},{key:"_addEventHandlers",value:function(){var e,t=this._getEventManager(),n=this.state._editableLayerState.eventHandler,r=Me(De);try{for(r.s();!(e=r.n()).done;){var o=e.value;t.on(o,n,{priority:100})}}catch(e){r.e(e)}finally{r.f()}}},{key:"_removeEventHandlers",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=t||this._getEventManager(),r=this.state._editableLayerState.eventHandler,o=Me(De);try{for(o.s();!(e=o.n()).done;){var i=e.value;n.off(i,r)}}catch(e){o.e(e)}finally{o.f()}}},{key:"_getEventManager",value:function(){return this.props.eventManager||this.context.deck.eventManager}}],n&&xe(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Fe.EditableGeoJsonLayer),je=g(629),Ne=g.n(je);const qe={mousedown:1,mousemove:2,mouseup:4};!function(e){const t=e.prototype.handler;e.prototype.handler=function(e){const n=this.store;e.button>0&&"pointerdown"===e.type&&(function(t,n){for(let n=0;n<t.length;n++)if(t[n].pointerId===e.pointerId)return!0;return!1}(n)||n.push(e)),t.call(this,e)}}(Ne().PointerEventInput),Ne().MouseInput.prototype.handler=function(e){let t=qe[e.type];1&t&&e.button>=0&&(this.pressed=!0),2&t&&0===e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))};const We=Ne().Manager,ze=Ne(),Ue=ze?[[ze.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[ze.Rotate,{enable:!1}],[ze.Pinch,{enable:!1}],[ze.Swipe,{enable:!1}],[ze.Pan,{threshold:0,enable:!1}],[ze.Press,{enable:!1}],[ze.Tap,{event:"doubletap",taps:2,enable:!1}],[ze.Tap,{event:"anytap",enable:!1}],[ze.Tap,{enable:!1}]]:null,He={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Ye={doubletap:["tap"]},Be={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Ge={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Xe={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Ve={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Ke="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Ze="undefined"!=typeof window?window:g.g;void 0!==g.g?g.g:window,"undefined"!=typeof document&&document;let Je=!1;try{const e={get passive(){return Je=!0,!0}};Ze.addEventListener("test",e,e),Ze.removeEventListener("test",e,e)}catch(e){}const $e=-1!==Ke.indexOf("firefox"),{WHEEL_EVENTS:Qe}=Ge,et="wheel",tt=4.000244140625;class nt{constructor(e,t,n={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},n),this.events=Qe.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((t=>e.addEventListener(t,this.handleEvent,!!Je&&{passive:!1})))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===et&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;Ze.WheelEvent&&($e&&e.deltaMode===Ze.WheelEvent.DOM_DELTA_PIXEL&&(t/=Ze.devicePixelRatio),e.deltaMode===Ze.WheelEvent.DOM_DELTA_LINE&&(t*=40));const n={x:e.clientX,y:e.clientY};0!==t&&t%tt==0&&(t=Math.floor(t/tt)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,n)}_onWheel(e,t,n){this.callback({type:et,center:n,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:rt}=Ge,ot="pointermove",it="pointerover",at="pointerout",st="pointerleave";class ct{constructor(e,t,n={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},n),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=rt.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===ot&&(this.enableMoveEvent=t),e===it&&(this.enableOverEvent=t),e===at&&(this.enableOutEvent=t),e===st&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:it,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:at,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:st,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:ot,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:ut}=Ge,lt="keydown",pt="keyup";class ht{constructor(e,t,n={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},n),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=ut.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=n.tabIndex||0,e.style.outline="none",this.events.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===lt&&(this.enableDownEvent=t),e===pt&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:lt,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:pt,srcEvent:e,key:e.key,target:e.target}))}}const ft="contextmenu";class dt{constructor(e,t,n={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},n),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===ft&&(this.options.enable=t)}handleEvent(e){this.options.enable&&this.callback({type:ft,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const vt={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},mt={srcElement:"root",priority:0};class yt{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,n,r=!1,o=!1){const{handlers:i,handlersByElement:a}=this;n&&("object"!=typeof n||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},mt,n):mt;let s=a.get(n.srcElement);s||(s=[],a.set(n.srcElement,s));const c={type:e,handler:t,srcElement:n.srcElement,priority:n.priority};r&&(c.once=!0),o&&(c.passive=!0),i.push(c),this._active=this._active||!c.passive;let u=s.length-1;for(;u>=0&&!(s[u].priority>=c.priority);)u--;s.splice(u+1,0,c)}remove(e,t){const{handlers:n,handlersByElement:r}=this;for(let o=n.length-1;o>=0;o--){const i=n[o];if(i.type===e&&i.handler===t){n.splice(o,1);const e=r.get(i.srcElement);e.splice(e.indexOf(i),1),0===e.length&&r.delete(i.srcElement)}}this._active=n.some((e=>!e.passive))}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let n=e.srcEvent.target;for(;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let t=!1;const r=()=>{e.handled=!0},o=()=>{e.handled=!0,t=!0},i=[];for(let a=0;a<n.length;a++){const{type:s,handler:c,once:u}=n[a];if(c(Object.assign({},e,{type:s,stopPropagation:r,stopImmediatePropagation:o})),u&&i.push(n[a]),t)break}for(let e=0;e<i.length;e++){const{type:t,handler:n}=i[e];this.remove(t,n)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(e){const t=vt[e.srcEvent.type];if(!t)return null;const{buttons:n,button:r,which:o}=e.srcEvent;let i=!1,a=!1,s=!1;return 4===t||2===t&&!Number.isFinite(n)?(i=1===o,a=2===o,s=3===o):2===t?(i=Boolean(1&n),a=Boolean(4&n),s=Boolean(2&n)):1===t&&(i=0===r,a=1===r,s=2===r),{leftButton:i,middleButton:a,rightButton:s}}(e),function(e,t){const{srcEvent:n}=e;if(!e.center&&!Number.isFinite(n.clientX))return null;const r=e.center||{x:n.clientX,y:n.clientY},o=t.getBoundingClientRect(),i=o.width/t.offsetWidth||1,a=o.height/t.offsetHeight||1;return{center:r,offsetCenter:{x:(r.x-o.left-t.clientLeft)/i,y:(r.y-o.top-t.clientTop)/a}}}(e,t),{handled:!1,rootElement:t})}}const gt={events:null,recognizers:null,recognizerOptions:{},Manager:We,touchAction:"none",tabIndex:0};class Et{constructor(e=null,t={}){this.options=Object.assign({},gt,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:n}=t;n&&this.on(n)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this,n=t.Manager;this.manager=new n(e,{touchAction:t.touchAction,recognizers:t.recognizers||Ue}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(He).forEach((e=>{const t=this.manager.get(e);t&&He[e].forEach((e=>{t.recognizeWith(e)}))}));for(const e in t.recognizerOptions){const n=this.manager.get(e);if(n){const r=t.recognizerOptions[e];delete r.enable,n.set(r)}}this.wheelInput=new nt(e,this._onOtherEvent,{enable:!1}),this.moveInput=new ct(e,this._onOtherEvent,{enable:!1}),this.keyInput=new ht(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new dt(e,this._onOtherEvent,{enable:!1});for(const[e,t]of this.events)t.isEmpty()||(this._toggleRecognizer(t.recognizerName,!0),this.manager.on(e,t.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const r=n.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const o=Ye[e];o&&!this.options.recognizers&&o.forEach((o=>{const i=n.get(o);t?(i.requireFailure(e),r.dropRequireFailure(o)):i.dropRequireFailure(e)}))}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,n,r,o){if("string"!=typeof e){n=t;for(const t in e)this._addEventHandler(t,e[t],n,r,o);return}const{manager:i,events:a}=this,s=Ve[e]||e;let c=a.get(s);c||(c=new yt(this),a.set(s,c),c.recognizerName=Xe[s]||s,i&&i.on(s,c.handleEvent)),c.add(e,t,n,r,o),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const t in e)this._removeEventHandler(t,e[t]);return}const{events:n}=this,r=Ve[e]||e,o=n.get(r);if(o&&(o.remove(e,t),o.isEmpty())){const{recognizerName:e}=o;let t=!1;for(const r of n.values())if(r.recognizerName===e&&!r.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}_onBasicInput(e){const{srcEvent:t}=e,n=Be[t.type];n&&this.manager.emit(n,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}var bt=g(306);function Tt(e){var t=e.eventManager,n=e.isEdit,r=e.isSelected,i=e.selectedMode,s=(0,a.useSelector)((function(e){return"gmaps"===bt.BASEMAPS[e.carto.basemap].type})),c=window.cartoGmap,u=(0,o.useMemo)((function(){return t||(s&&c?new Et(c.getDiv()):void 0)}),[c,t,s]);return(0,o.useEffect)((function(){if(s&&c){var e=n&&r||i===_.FEATURE_SELECTION_MODES.LASSO_TOOL;c.setOptions({gestureHandling:e?"none":"auto"})}}),[c,n,s,r,i]),u}var St=g(946),wt=g(445);function Pt(){var e=(0,a.useSelector)((function(e){return(0,I.selectSpatialFilter)(e)})),t=e?[{polygon:null==e?void 0:e.geometry.coordinates}]:[];return new wt.SolidPolygonLayer({id:_.MASK_ID,operation:St.OPERATION.MASK,data:t,getFillColor:[255,255,255,255]})}var Ot=Pe.ViewMode,xt=Pe.TranslateMode,_t=Pe.ModifyMode,It=new(0,Pe.CompositeMode)([new xt,new _t]);function At(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{eventManager:null,mask:!0},t=e.eventManager,n=e.mask,i=(0,a.useDispatch)(),s=(0,W.useTheme)(),c=(0,o.useState)(null),l=r(c,2),p=l[0],h=l[1],f=(0,a.useSelector)((function(e){return(0,u.selectFeatureSelectionMode)(e)})),d=(0,a.useSelector)((function(e){return(0,u.selectSpatialFilter)(e)})),v=Ct(f),m=!!d,y=null!==p,g=Tt({eventManager:t,isEdit:v,isSelected:y,selectedMode:f});(0,o.useEffect)((function(){!v&&y&&h(null)}),[v,d,y]);var E=(0,o.useMemo)((function(){if(f){if(v&&y)return It;if(!v&&!y)return Pe[f]}return Ot}),[y,v,f]),b=Rt((0,W.hexToRgb)(s.palette.primary.main)),T=Rt((0,W.hexToRgb)(s.palette.secondary.main)),S=m&&!y?T:b;return[n&&Pt(),new ke({eventManager:g,id:"FeatureSelectionLayer",pickable:!!f,data:{type:"FeatureCollection",features:d?[d]:[]},mode:E,selectedFeatureIndexes:isFinite(p)?[p]:[],onEdit:function(e){var t=e.updatedData,n=e.editType;if("addFeature"===n&&i((0,u.setFeatureSelectionEnabled)(!1)),0!==t.features.length&&!n.includes("Tentative")){var o=r(t.features.slice(-1),1)[0];o&&i((0,u.addSpatialFilter)({geometry:o}))}},onClick:function(e){var t=e.index,n=e.object;v&&"Polygon"===(null==n?void 0:n.geometry.type)&&h(t)},getLineColor:S,getFillColor:v?[].concat(X(S.slice(0,3)),[255*.08]):[0,0,0,0],getTentativeFillColor:[].concat(X(b.slice(0,3)),[255*.08]),getTentativeLineColor:b,getEditHandlePointColor:[255,255,255],getEditHandlePointOutlineColor:b,editHandlePointStrokeWidth:5,getEditHandlePointRadius:2})]}function Ct(e){return-1!==Object.values(p.EDIT_MODES).indexOf(e)}function Rt(e){var t=r(e.replace(/[rgba() ]/g,"").split(","),4),n=t[0],o=t[1],i=t[2],a=t[3];return[n,o,i,a?255*a:255].map(Number)}})(),E})()}));
//# sourceMappingURL=index.js.map