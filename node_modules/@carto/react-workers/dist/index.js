!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.cartoReactWorkers=e():t.cartoReactWorkers=e()}(self,(function(){return(()=>{"use strict";var t={5:t=>{t.exports=function(t,e,r,n){var o=self||window;try{try{var i;try{i=new o.Blob([t])}catch(e){(i=new(o.BlobBuilder||o.WebKitBlobBuilder||o.MozBlobBuilder||o.MSBlobBuilder)).append(t),i=i.getBlob()}var u=o.URL||o.webkitURL,a=u.createObjectURL(i),s=new o[e](a,r);return u.revokeObjectURL(a),s}catch(n){return new o[e]("data:application/javascript,".concat(encodeURIComponent(t)),r)}}catch(t){if(!n)throw Error("Inline worker is not supported");return new o[e](n,r)}}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.p="";var n={};return(()=>{r.r(n),r.d(n,{Methods:()=>t,executeTask:()=>l,removeWorker:()=>f});var t=Object.freeze({TILE_FEATURES:"tileFeatures",FEATURES_FORMULA:"featuresFormula",FEATURES_HISTOGRAM:"featuresHistogram",FEATURES_CATEGORY:"featuresCategory",FEATURES_SCATTERPLOT:"featuresScatterPlot",FEATURES_TIME_SERIES:"featuresTimeSeries",FEATURES_RAW:"featuresRawFeatures",LOAD_GEOJSON_FEATURES:"loadGeoJSONFeatures",GEOJSON_FEATURES:"featuresGeoJSON",LOAD_TILES:"loadTiles"});function e(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=r(5),i=r.n(o);function u(){return i()('/*! For license information please see index.worker.js.LICENSE.txt */\n(()=>{var t={189:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(84);e.default=function(t,e){void 0===e&&(e={});var r=Number(t[0]),o=Number(t[1]),i=Number(t[2]),u=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[r,o],s=[r,u],l=[i,u],f=[i,o];return n.polygon([[a,f,l,s,a]],e.properties,{bbox:t,id:e.id})}},26:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(871);function o(t){var e=[1/0,1/0,-1/0,-1/0];return n.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}o.default=o,e.default=o},434:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(549)),i=n(r(377)),u=r(871),a=n(r(289));function s(t,e){for(var r=0;r<t.coordinates.length-1;r++)if(f(t.coordinates[r],t.coordinates[r+1],e.coordinates))return!0;return!1}function l(t,e){for(var r=0,n=e.coordinates;r<n.length;r++){var u=n[r];if(o.default(u,t))return!0}return i.default(e,a.default(t)).features.length>0}function f(t,e,r){var n=r[0]-t[0],o=r[1]-t[1],i=e[0]-t[0],u=e[1]-t[1];return 0==n*u-o*i&&(Math.abs(i)>=Math.abs(u)?i>0?t[0]<=r[0]&&r[0]<=e[0]:e[0]<=r[0]&&r[0]<=t[0]:u>0?t[1]<=r[1]&&r[1]<=e[1]:e[1]<=r[1]&&r[1]<=t[1])}e.default=function(t,e){var r=!0;return u.flattenEach(t,(function(t){u.flattenEach(e,(function(e){if(!1===r)return!1;r=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return u=t.coordinates,f=e.coordinates,!(u[0]===f[0]&&u[1]===f[1]);case"LineString":return!s(e,t);case"Polygon":return!o.default(t,e)}break;case"LineString":switch(e.type){case"Point":return!s(t,e);case"LineString":return r=t,n=e,!(i.default(r,n).features.length>0);case"Polygon":return!l(e,t)}break;case"Polygon":switch(e.type){case"Point":return!o.default(e,t);case"LineString":return!l(t,e);case"Polygon":return!function(t,e){for(var r=0,n=t.coordinates[0];r<n.length;r++){var u=n[r];if(o.default(u,e))return!0}for(var s=0,l=e.coordinates[0];s<l.length;s++){var f=l[s];if(o.default(f,t))return!0}return i.default(a.default(t),a.default(e)).features.length>0}(e,t)}}var r,n,u,f;return!1}(t.geometry,e.geometry)}))})),r}},0:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(434)),i=r(871);e.default=function(t,e){var r=!1;return i.flattenEach(t,(function(t){i.flattenEach(e,(function(e){if(!0===r)return!0;r=!o.default(t.geometry,e.geometry)}))})),r}},549:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(984);function o(t,e,r){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var o=0,i=e.length-1;o<e.length;i=o++){var u=e[o][0],a=e[o][1],s=e[i][0],l=e[i][1];if(t[1]*(u-s)+a*(s-t[0])+l*(t[0]-u)==0&&(u-t[0])*(s-t[0])<=0&&(a-t[1])*(l-t[1])<=0)return!r;a>t[1]!=l>t[1]&&t[0]<(s-u)*(t[1]-a)/(l-a)+u&&(n=!n)}return n}e.default=function(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=n.getCoord(t),u=n.getGeom(e),a=u.type,s=e.bbox,l=u.coordinates;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(i,s))return!1;"Polygon"===a&&(l=[l]);for(var f=!1,c=0;c<l.length&&!f;c++)if(o(i,l[c][0],r.ignoreBoundary)){for(var h=!1,p=1;p<l[c].length&&!h;)o(i,l[c][p],!r.ignoreBoundary)&&(h=!0),p++;h||(f=!0)}return f}},458:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(984);function o(t,e,r,n,o){var i=r[0],u=r[1],a=t[0],s=t[1],l=e[0],f=e[1],c=l-a,h=f-s,p=(r[0]-a)*h-(r[1]-s)*c;if(null!==o){if(Math.abs(p)>o)return!1}else if(0!==p)return!1;return n?"start"===n?Math.abs(c)>=Math.abs(h)?c>0?a<i&&i<=l:l<=i&&i<a:h>0?s<u&&u<=f:f<=u&&u<s:"end"===n?Math.abs(c)>=Math.abs(h)?c>0?a<=i&&i<l:l<i&&i<=a:h>0?s<=u&&u<f:f<u&&u<=s:"both"===n&&(Math.abs(c)>=Math.abs(h)?c>0?a<i&&i<l:l<i&&i<a:h>0?s<u&&u<f:f<u&&u<s):Math.abs(c)>=Math.abs(h)?c>0?a<=i&&i<=l:l<=i&&i<=a:h>0?s<=u&&u<=f:f<=u&&u<=s}e.default=function(t,e,r){void 0===r&&(r={});for(var i=n.getCoord(t),u=n.getCoords(e),a=0;a<u.length-1;a++){var s=!1;if(r.ignoreEndVertices&&(0===a&&(s="start"),a===u.length-2&&(s="end"),0===a&&a+1===u.length-1&&(s="both")),o(u[a],u[a+1],i,s,void 0===r.epsilon?null:r.epsilon))return!0}return!1}},190:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(26)),i=n(r(458)),u=n(r(549)),a=r(984);function s(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function l(t,e){return t[0]===e[0]&&t[1]===e[1]}e.default=function(t,e){var r=a.getGeom(t),n=a.getGeom(e),f=r.type,c=n.type;switch(f){case"Point":switch(c){case"MultiPoint":return function(t,e){var r,n=!1;for(r=0;r<e.coordinates.length;r++)if(l(e.coordinates[r],t.coordinates)){n=!0;break}return n}(r,n);case"LineString":return i.default(r,n,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return u.default(r,n,{ignoreBoundary:!0});default:throw new Error("feature2 "+c+" geometry not supported")}case"MultiPoint":switch(c){case"MultiPoint":return function(t,e){for(var r=0;r<t.coordinates.length;r++){for(var n=!1,o=0;o<e.coordinates.length;o++)l(t.coordinates[r],e.coordinates[o])&&(n=!0);if(!n)return!1}return!0}(r,n);case"LineString":return function(t,e){for(var r=!1,n=0;n<t.coordinates.length;n++){if(!i.default(t.coordinates[n],e))return!1;r||(r=i.default(t.coordinates[n],e,{ignoreEndVertices:!0}))}return r}(r,n);case"Polygon":case"MultiPolygon":return function(t,e){for(var r=!0,n=!1,o=0;o<t.coordinates.length;o++){if(!(n=u.default(t.coordinates[1],e))){r=!1;break}n=u.default(t.coordinates[1],e,{ignoreBoundary:!0})}return r&&n}(r,n);default:throw new Error("feature2 "+c+" geometry not supported")}case"LineString":switch(c){case"LineString":return function(t,e){for(var r=0;r<t.coordinates.length;r++)if(!i.default(t.coordinates[r],e))return!1;return!0}(r,n);case"Polygon":case"MultiPolygon":return function(t,e){var r,n;if(!s(o.default(e),o.default(t)))return!1;for(var i=!1,a=0;a<t.coordinates.length-1;a++){if(!u.default(t.coordinates[a],e))return!1;if(i||(i=u.default(t.coordinates[a],e,{ignoreBoundary:!0})),!i){var l=(r=t.coordinates[a],n=t.coordinates[a+1],[(r[0]+n[0])/2,(r[1]+n[1])/2]);i=u.default(l,e,{ignoreBoundary:!0})}}return i}(r,n);default:throw new Error("feature2 "+c+" geometry not supported")}case"Polygon":switch(c){case"Polygon":case"MultiPolygon":return function(t,e){var r=o.default(t);if(!s(o.default(e),r))return!1;for(var n=0;n<t.coordinates[0].length;n++)if(!u.default(t.coordinates[0][n],e))return!1;return!0}(r,n);default:throw new Error("feature2 "+c+" geometry not supported")}default:throw new Error("feature1 "+f+" geometry not supported")}}},84:(t,e)=>{"use strict";function r(t,e,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function n(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!p(t[0])||!p(t[1]))throw new Error("coordinates must contain numbers");return r({type:"Point",coordinates:t},e,n)}function o(t,e,n){void 0===n&&(n={});for(var o=0,i=t;o<i.length;o++){var u=i[o];if(u.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<u[u.length-1].length;a++)if(u[u.length-1][a]!==u[0][a])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:t},e,n)}function i(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:t},e,n)}function u(t,e){void 0===e&&(e={});var r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function a(t,e,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:t},e,n)}function s(t,e,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:t},e,n)}function l(t,e,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:t},e,n)}function f(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t*n}function c(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t/n}function h(t){return t%(2*Math.PI)*180/Math.PI}function p(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=r,e.geometry=function(t,e,r){switch(void 0===r&&(r={}),t){case"Point":return n(e).geometry;case"LineString":return i(e).geometry;case"Polygon":return o(e).geometry;case"MultiPoint":return s(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return l(e).geometry;default:throw new Error(t+" is invalid")}},e.point=n,e.points=function(t,e,r){return void 0===r&&(r={}),u(t.map((function(t){return n(t,e)})),r)},e.polygon=o,e.polygons=function(t,e,r){return void 0===r&&(r={}),u(t.map((function(t){return o(t,e)})),r)},e.lineString=i,e.lineStrings=function(t,e,r){return void 0===r&&(r={}),u(t.map((function(t){return i(t,e)})),r)},e.featureCollection=u,e.multiLineString=a,e.multiPoint=s,e.multiPolygon=l,e.geometryCollection=function(t,e,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:t},e,n)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,e||0);return Math.round(t*r)/r},e.radiansToLength=f,e.lengthToRadians=c,e.lengthToDegrees=function(t,e){return h(c(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=h,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,r){if(void 0===e&&(e="kilometers"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("length must be a positive number");return f(c(t,e),r)},e.convertArea=function(t,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var o=e.areaFactors[r];if(!o)throw new Error("invalid original units");var i=e.areaFactors[n];if(!i)throw new Error("invalid final units");return t/o*i},e.isNumber=p,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!p(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},441:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(84),i=r(984),u=n(r(888));e.default=function(t,e,r){void 0===r&&(r={});var n=i.getGeom(t),a=i.getGeom(e),s=u.default.intersection(n.coordinates,a.coordinates);return 0===s.length?null:1===s.length?o.polygon(s[0],r.properties):o.multiPolygon(s,r.properties)}},984:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(84);e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(e.length>1&&n.isNumber(e[0])&&n.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,r){if(!e||!r)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,r){if(!t)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0,o=t.features;n<o.length;n++){var i=o[n];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!i.geometry||i.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+i.geometry.type)}},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},377:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(84),i=r(984),u=n(r(224)),a=r(871),s=n(r(100));function l(t,e){var r=i.getCoords(t),n=i.getCoords(e);if(2!==r.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var u=r[0][0],a=r[0][1],s=r[1][0],l=r[1][1],f=n[0][0],c=n[0][1],h=n[1][0],p=n[1][1],y=(p-c)*(s-u)-(h-f)*(l-a);if(0===y)return null;var g=((h-f)*(a-c)-(p-c)*(u-f))/y,v=((s-u)*(a-c)-(l-a)*(u-f))/y;if(g>=0&&g<=1&&v>=0&&v<=1){var d=u+g*(s-u),m=a+g*(l-a);return o.point([d,m])}return null}e.default=function(t,e){var r={},n=[];if("LineString"===t.type&&(t=o.feature(t)),"LineString"===e.type&&(e=o.feature(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var f=l(t,e);return f&&n.push(f),o.featureCollection(n)}var c=s.default();return c.load(u.default(e)),a.featureEach(u.default(t),(function(t){a.featureEach(c.search(t),(function(e){var o=l(t,e);if(o){var u=i.getCoords(o).join(",");r[u]||(r[u]=!0,n.push(o))}}))})),o.featureCollection(n)}},224:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(84),o=r(984),i=r(871);e.default=function(t){if(!t)throw new Error("geojson is required");var e=[];return i.flattenEach(t,(function(t){!function(t,e){var r=[],i=t.geometry;if(null!==i){switch(i.type){case"Polygon":r=o.getCoords(i);break;case"LineString":r=[o.getCoords(i)]}r.forEach((function(r){var o=function(t,e){var r=[];return t.reduce((function(t,o){var i,u,a,s,l,f,c=n.lineString([t,o],e);return c.bbox=(u=o,a=(i=t)[0],s=i[1],[a<(l=u[0])?a:l,s<(f=u[1])?s:f,a>l?a:l,s>f?s:f]),r.push(c),o})),r}(r,t.properties);o.forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),n.featureCollection(e)}},871:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(84);function o(t,e,r){if(null!==t)for(var n,i,u,a,s,l,f,c,h=0,p=0,y=t.type,g="FeatureCollection"===y,v="Feature"===y,d=g?t.features.length:1,m=0;m<d;m++){s=(c=!!(f=g?t.features[m].geometry:v?t.geometry:t)&&"GeometryCollection"===f.type)?f.geometries.length:1;for(var b=0;b<s;b++){var E=0,x=0;if(null!==(a=c?f.geometries[b]:f)){l=a.coordinates;var w=a.type;switch(h=!r||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(l,p,m,E,x))return!1;p++,E++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===e(l[n],p,m,E,x))return!1;p++,"MultiPoint"===w&&E++}"LineString"===w&&E++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(i=0;i<l[n].length-h;i++){if(!1===e(l[n][i],p,m,E,x))return!1;p++}"MultiLineString"===w&&E++,"Polygon"===w&&x++}"Polygon"===w&&E++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(x=0,i=0;i<l[n].length;i++){for(u=0;u<l[n][i].length-h;u++){if(!1===e(l[n][i][u],p,m,E,x))return!1;p++}x++}E++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===o(a.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function i(t,e){var r;switch(t.type){case"FeatureCollection":for(r=0;r<t.features.length&&!1!==e(t.features[r].properties,r);r++);break;case"Feature":e(t.properties,0)}}function u(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function a(t,e){var r,n,o,i,u,a,s,l,f,c,h=0,p="FeatureCollection"===t.type,y="Feature"===t.type,g=p?t.features.length:1;for(r=0;r<g;r++){for(a=p?t.features[r].geometry:y?t.geometry:t,l=p?t.features[r].properties:y?t.properties:{},f=p?t.features[r].bbox:y?t.bbox:void 0,c=p?t.features[r].id:y?t.id:void 0,u=(s=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,o=0;o<u;o++)if(null!==(i=s?a.geometries[o]:a))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,h,l,f,c))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===e(i.geometries[n],h,l,f,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,h,l,f,c))return!1;h++}}function s(t,e){a(t,(function(t,r,o,i,u){var a,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(n.feature(t,o,{bbox:i,id:u}),r,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var l=0;l<t.coordinates.length;l++){var f={type:a,coordinates:t.coordinates[l]};if(!1===e(n.feature(f,o),r,l))return!1}}))}function l(t,e){s(t,(function(t,r,i){var u=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var s,l=0,f=0,c=0;return!1!==o(t,(function(o,a,h,p,y){if(void 0===s||r>l||p>f||y>c)return s=o,l=r,f=p,c=y,void(u=0);var g=n.lineString([s,o],t.properties);if(!1===e(g,r,i,y,u))return!1;u++,s=o}))&&void 0}}}))}function f(t,e){if(!t)throw new Error("geojson is required");s(t,(function(t,r,o){if(null!==t.geometry){var i=t.geometry.type,u=t.geometry.coordinates;switch(i){case"LineString":if(!1===e(t,r,o,0,0))return!1;break;case"Polygon":for(var a=0;a<u.length;a++)if(!1===e(n.lineString(u[a],t.properties),r,o,a))return!1}}}))}e.coordAll=function(t){var e=[];return o(t,(function(t){e.push(t)})),e},e.coordEach=o,e.coordReduce=function(t,e,r,n){var i=r;return o(t,(function(t,n,o,u,a){i=0===n&&void 0===r?t:e(i,t,n,o,u,a)}),n),i},e.featureEach=u,e.featureReduce=function(t,e,r){var n=r;return u(t,(function(t,o){n=0===o&&void 0===r?t:e(n,t,o)})),n},e.findPoint=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var r,o=e.featureIndex||0,i=e.multiFeatureIndex||0,u=e.geometryIndex||0,a=e.coordIndex||0,s=e.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),s=s||t.features[o].properties,r=t.features[o].geometry;break;case"Feature":s=s||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var l=r.coordinates;switch(r.type){case"Point":return n.point(l,s,e);case"MultiPoint":return i<0&&(i=l.length+i),n.point(l[i],s,e);case"LineString":return a<0&&(a=l.length+a),n.point(l[a],s,e);case"Polygon":return u<0&&(u=l.length+u),a<0&&(a=l[u].length+a),n.point(l[u][a],s,e);case"MultiLineString":return i<0&&(i=l.length+i),a<0&&(a=l[i].length+a),n.point(l[i][a],s,e);case"MultiPolygon":return i<0&&(i=l.length+i),u<0&&(u=l[i].length+u),a<0&&(a=l[i][u].length-a),n.point(l[i][u][a],s,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var r,o=e.featureIndex||0,i=e.multiFeatureIndex||0,u=e.geometryIndex||0,a=e.segmentIndex||0,s=e.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),s=s||t.features[o].properties,r=t.features[o].geometry;break;case"Feature":s=s||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var l=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=l.length+a-1),n.lineString([l[a],l[a+1]],s,e);case"Polygon":return u<0&&(u=l.length+u),a<0&&(a=l[u].length+a-1),n.lineString([l[u][a],l[u][a+1]],s,e);case"MultiLineString":return i<0&&(i=l.length+i),a<0&&(a=l[i].length+a-1),n.lineString([l[i][a],l[i][a+1]],s,e);case"MultiPolygon":return i<0&&(i=l.length+i),u<0&&(u=l[i].length+u),a<0&&(a=l[i][u].length-a-1),n.lineString([l[i][u][a],l[i][u][a+1]],s,e)}throw new Error("geojson is invalid")},e.flattenEach=s,e.flattenReduce=function(t,e,r){var n=r;return s(t,(function(t,o,i){n=0===o&&0===i&&void 0===r?t:e(n,t,o,i)})),n},e.geomEach=a,e.geomReduce=function(t,e,r){var n=r;return a(t,(function(t,o,i,u,a){n=0===o&&void 0===r?t:e(n,t,o,i,u,a)})),n},e.lineEach=f,e.lineReduce=function(t,e,r){var n=r;return f(t,(function(t,o,i,u){n=0===o&&void 0===r?t:e(n,t,o,i,u)})),n},e.propEach=i,e.propReduce=function(t,e,r){var n=r;return i(t,(function(t,o){n=0===o&&void 0===r?t:e(n,t,o)})),n},e.segmentEach=l,e.segmentReduce=function(t,e,r){var n=r,o=!1;return l(t,(function(t,i,u,a,s){n=!1===o&&void 0===r?t:e(n,t,i,u,a,s),o=!0})),n}},289:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(84),o=r(984);function i(t,e){return void 0===e&&(e={}),a(o.getGeom(t).coordinates,e.properties?e.properties:"Feature"===t.type?t.properties:{})}function u(t,e){void 0===e&&(e={});var r=o.getGeom(t).coordinates,i=e.properties?e.properties:"Feature"===t.type?t.properties:{},u=[];return r.forEach((function(t){u.push(a(t,i))})),n.featureCollection(u)}function a(t,e){return t.length>1?n.multiLineString(t,e):n.lineString(t[0],e)}e.default=function(t,e){void 0===e&&(e={});var r=o.getGeom(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),r.type){case"Polygon":return i(r,e);case"MultiPolygon":return u(r,e);default:throw new Error("invalid poly")}},e.polygonToLine=i,e.multiPolygonToLine=u,e.coordsToLine=a},100:(t,e,r)=>{var n=r(147),o=r(84),i=r(871),u=r(26).default,a=i.featureEach,s=(i.coordEach,o.polygon,o.featureCollection);function l(t){var e=new n(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:u(t),n.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:u(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:u(t),e.push(t)})),n.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:u(t),n.prototype.remove.call(this,t,e)},e.clear=function(){return n.prototype.clear.call(this)},e.search=function(t){var e=n.prototype.search.call(this,this.toBBox(t));return s(e)},e.collides=function(t){return n.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=n.prototype.all.call(this);return s(t)},e.toJSON=function(){return n.prototype.toJSON.call(this)},e.fromJSON=function(t){return n.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=u(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=u(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=l,t.exports.default=l},888:function(t){t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}var n=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function o(t,e){return t>e?1:t<e?-1:0}function i(t,e,r){for(var o=new n(null,null),i=o,u=o;;){var a=r(t,e.key);if(a<0){if(null===e.left)break;if(r(t,e.left.key)<0){var s=e.left;if(e.left=s.right,s.right=e,null===(e=s).left)break}u.left=e,u=e,e=e.left}else{if(!(a>0))break;if(null===e.right)break;if(r(t,e.right.key)>0&&(s=e.right,e.right=s.left,s.left=e,null===(e=s).right))break;i.right=e,i=e,e=e.right}}return i.right=e.left,u.left=e.right,e.left=o.right,e.right=o.left,e}function u(t,e,r,o){var u=new n(t,e);if(null===r)return u.left=u.right=null,u;var a=o(t,(r=i(t,r,o)).key);return a<0?(u.left=r.left,u.right=r,r.left=null):a>=0&&(u.right=r.right,u.left=r,r.right=null),u}function a(t,e,r){var n=null,o=null;if(e){var u=r((e=i(t,e,r)).key,t);0===u?(n=e.left,o=e.right):u<0?(o=e.right,e.right=null,n=e):(n=e.left,e.left=null,o=e)}return{left:n,right:o}}function s(t,e,r,n,o){if(t){n(e+(r?"└── ":"├── ")+o(t)+"\\n");var i=e+(r?"    ":"│   ");t.left&&s(t.left,i,!1,n,o),t.right&&s(t.right,i,!0,n,o)}}var l=function(){function t(t){void 0===t&&(t=o),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=u(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var r=new n(t,e);null===this._root&&(r.left=r.right=null,this._size++,this._root=r);var o=this._comparator,u=i(t,this._root,o),a=o(t,u.key);return 0===a?this._root=u:(a<0?(r.left=u.left,r.right=u,u.left=null):a>0&&(r.right=u.right,r.left=u,u.right=null),this._size++,this._root=r),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,r){var n;return null===e?null:0===r(t,(e=i(t,e,r)).key)?(null===e.left?n=e.right:(n=i(t,e.left,r)).right=e.right,this._size--,n):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=i(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,r=this._comparator;e;){var n=r(t,e.key);if(0===n)return e;e=n<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=i(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,r=this._comparator;e;){var n=r(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var r=this._root,n=[],o=!1;!o;)null!==r?(n.push(r),r=r.left):0!==n.length?(r=n.pop(),t.call(e,r),r=r.right):o=!0;return this},t.prototype.range=function(t,e,r,n){for(var o=[],i=this._comparator,u=this._root;0!==o.length||u;)if(u)o.push(u),u=u.left;else{if(i((u=o.pop()).key,e)>0)break;if(i(u.key,t)>=0&&r.call(n,u))return this;u=u.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var r=e.key;return t.push(r)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var r=e.data;return t.push(r)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,r=!1,n=0,o=[];!r;)if(e)o.push(e),e=e.left;else if(o.length>0){if(e=o.pop(),n===t)return e;n++,e=e.right}else r=!0;return null},t.prototype.next=function(t){var e=this._root,r=null;if(t.right){for(r=t.right;r.left;)r=r.left;return r}for(var n=this._comparator;e;){var o=n(t.key,e.key);if(0===o)break;o<0?(r=e,e=e.left):e=e.right}return r},t.prototype.prev=function(t){var e=this._root,r=null;if(null!==t.left){for(r=t.left;r.right;)r=r.right;return r}for(var n=this._comparator;e;){var o=n(t.key,e.key);if(0===o)break;o<0?e=e.left:(r=e,e=e.right)}return r},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){for(var e=t,r=[],o=!1,i=new n(null,null),u=i;!o;)e?(r.push(e),e=e.left):r.length>0?e=(e=u=u.next=r.pop()).right:o=!0;return u.next=null,i.next}(this._root)},t.prototype.load=function(t,e,r){void 0===e&&(e=[]),void 0===r&&(r=!1);var o=t.length,i=this._comparator;if(r&&h(t,e,0,o-1,i),null===this._root)this._root=f(t,e,0,o),this._size=o;else{var u=function(t,e,r){for(var o=new n(null,null),i=o,u=t,a=e;null!==u&&null!==a;)r(u.key,a.key)<0?(i.next=u,u=u.next):(i.next=a,a=a.next),i=i.next;return null!==u?i.next=u:null!==a&&(i.next=a),o.next}(this.toList(),function(t,e){for(var r=new n(null,null),o=r,i=0;i<t.length;i++)o=o.next=new n(t[i],e[i]);return o.next=null,r.next}(t,e),i);o=this._size+o,this._root=c({head:u},0,o)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return s(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,r){var n=this._comparator,o=a(t,this._root,n),s=o.left,l=o.right;n(t,e)<0?l=u(e,r,l,n):s=u(e,r,s,n),this._root=function(t,e,r){return null===e?t:(null===t||((e=i(t.key,e,r)).left=t),e)}(s,l,n)},t.prototype.split=function(t){return a(t,this._root,this._comparator)},t}();function f(t,e,r,o){var i=o-r;if(i>0){var u=r+Math.floor(i/2),a=t[u],s=e[u],l=new n(a,s);return l.left=f(t,e,r,u),l.right=f(t,e,u+1,o),l}return null}function c(t,e,r){var n=r-e;if(n>0){var o=e+Math.floor(n/2),i=c(t,e,o),u=t.head;return u.left=i,t.head=t.head.next,u.right=c(t,o+1,r),u}return null}function h(t,e,r,n,o){if(!(r>=n)){for(var i=t[r+n>>1],u=r-1,a=n+1;;){do{u++}while(o(t[u],i)<0);do{a--}while(o(t[a],i)>0);if(u>=a)break;var s=t[u];t[u]=t[a],t[a]=s,s=e[u],e[u]=e[a],e[a]=s}h(t,e,r,a,o),h(t,e,a+1,n,o)}}var p=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},y=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var r=t.ll.x<e.ll.x?e.ll.x:t.ll.x,n=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:r,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:n,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},g=Number.EPSILON;void 0===g&&(g=Math.pow(2,-52));var v=g*g,d=function(t,e){if(-g<t&&t<g&&-g<e&&e<g)return 0;var r=t-e;return r*r<v*t*e?0:t<e?-1:1},m=function(){function e(){t(this,e),this.reset()}return r(e,[{key:"reset",value:function(){this.xRounder=new b,this.yRounder=new b}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),b=function(){function e(){t(this,e),this.tree=new l,this.round(0)}return r(e,[{key:"round",value:function(t){var e=this.tree.add(t),r=this.tree.prev(e);if(null!==r&&0===d(e.key,r.key))return this.tree.remove(t),r.key;var n=this.tree.next(e);return null!==n&&0===d(e.key,n.key)?(this.tree.remove(t),n.key):t}}]),e}(),E=new m,x=function(t,e){return t.x*e.y-t.y*e.x},w=function(t,e){return t.x*e.x+t.y*e.y},S=function(t,e,r){var n={x:e.x-t.x,y:e.y-t.y},o={x:r.x-t.x,y:r.y-t.y},i=x(n,o);return d(i,0)},D=function(t){return Math.sqrt(w(t,t))},_=function(t,e,r){var n={x:e.x-t.x,y:e.y-t.y},o={x:r.x-t.x,y:r.y-t.y};return w(o,n)/D(o)/D(n)},A=function(t,e,r){return 0===e.y?null:{x:t.x+e.x/e.y*(r-t.y),y:r}},F=function(t,e,r){return 0===e.x?null:{x:r,y:t.y+e.y/e.x*(r-t.x)}},P=function(){function e(r,n){t(this,e),void 0===r.events?r.events=[this]:r.events.push(this),this.point=r,this.isLeft=n}return r(e,null,[{key:"compare",value:function(t,r){var n=e.comparePoints(t.point,r.point);return 0!==n?n:(t.point!==r.point&&t.link(r),t.isLeft!==r.isLeft?t.isLeft?1:-1:O.compare(t.segment,r.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),r(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,r=0,n=e.length;r<n;r++){var o=e[r];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var r=this.point.events[e];if(void 0===r.segment.consumedBy)for(var n=e+1;n<t;n++){var o=this.point.events[n];void 0===o.consumedBy&&r.otherSE.point.events===o.otherSE.point.events&&r.segment.consume(o.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,r=this.point.events.length;e<r;e++){var n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,r=new Map,n=function(n){var o,i,u,a,s,l=n.otherSE;r.set(n,{sine:(o=e.point,i=t.point,u=l.point,a={x:i.x-o.x,y:i.y-o.y},s={x:u.x-o.x,y:u.y-o.y},x(s,a)/D(s)/D(a)),cosine:_(e.point,t.point,l.point)})};return function(t,e){r.has(t)||n(t),r.has(e)||n(e);var o=r.get(t),i=o.sine,u=o.cosine,a=r.get(e),s=a.sine,l=a.cosine;return i>=0&&s>=0?u<l?1:u>l?-1:0:i<0&&s<0?u<l?-1:u>l?1:0:s<i?-1:s>i?1:0}}}]),e}(),M=0,O=function(){function e(r,n,o,i){t(this,e),this.id=++M,this.leftSE=r,r.segment=this,r.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=r,this.rings=o,this.windings=i}return r(e,null,[{key:"compare",value:function(t,e){var r=t.leftSE.point.x,n=e.leftSE.point.x,o=t.rightSE.point.x,i=e.rightSE.point.x;if(i<r)return 1;if(o<n)return-1;var u=t.leftSE.point.y,a=e.leftSE.point.y,s=t.rightSE.point.y,l=e.rightSE.point.y;if(r<n){if(a<u&&a<s)return 1;if(a>u&&a>s)return-1;var f=t.comparePoint(e.leftSE.point);if(f<0)return 1;if(f>0)return-1;var c=e.comparePoint(t.rightSE.point);return 0!==c?c:-1}if(r>n){if(u<a&&u<l)return-1;if(u>a&&u>l)return 1;var h=e.comparePoint(t.leftSE.point);if(0!==h)return h;var p=t.comparePoint(e.rightSE.point);return p<0?1:p>0?-1:1}if(u<a)return-1;if(u>a)return 1;if(o<i){var y=e.comparePoint(t.rightSE.point);if(0!==y)return y}if(o>i){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(o!==i){var v=s-u,d=o-r,m=l-a,b=i-n;if(v>d&&m<b)return 1;if(v<d&&m>b)return-1}return o>i?1:o<i||s<l?-1:s>l?1:t.id<e.id?-1:t.id>e.id?1:0}}]),r(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,r=this.rightSE.point,n=this.vector();if(e.x===r.x)return t.x===e.x?0:t.x<e.x?1:-1;var o=(t.y-e.y)/n.y,i=e.x+o*n.x;if(t.x===i)return 0;var u=(t.x-e.x)/n.x,a=e.y+u*n.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),r=t.bbox(),n=y(e,r);if(null===n)return null;var o=this.leftSE.point,i=this.rightSE.point,u=t.leftSE.point,a=t.rightSE.point,s=p(e,u)&&0===this.comparePoint(u),l=p(r,o)&&0===t.comparePoint(o),f=p(e,a)&&0===this.comparePoint(a),c=p(r,i)&&0===t.comparePoint(i);if(l&&s)return c&&!f?i:!c&&f?a:null;if(l)return f&&o.x===a.x&&o.y===a.y?null:o;if(s)return c&&i.x===u.x&&i.y===u.y?null:u;if(c&&f)return null;if(c)return i;if(f)return a;var h=function(t,e,r,n){if(0===e.x)return F(r,n,t.x);if(0===n.x)return F(t,e,r.x);if(0===e.y)return A(r,n,t.y);if(0===n.y)return A(t,e,r.y);var o=x(e,n);if(0==o)return null;var i={x:r.x-t.x,y:r.y-t.y},u=x(i,e)/o,a=x(i,n)/o;return{x:(t.x+a*e.x+(r.x+u*n.x))/2,y:(t.y+a*e.y+(r.y+u*n.y))/2}}(o,this.vector(),u,t.vector());return null===h?null:p(n,h)?E.round(h.x,h.y):null}},{key:"split",value:function(t){var r=[],n=void 0!==t.events,o=new P(t,!0),i=new P(t,!1),u=this.rightSE;this.replaceRightSE(i),r.push(i),r.push(o);var a=new e(o,u,this.rings.slice(),this.windings.slice());return P.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),P.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(o.checkForConsuming(),i.checkForConsuming()),r}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,r=this.windings.length;e<r;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var r=this,n=t;r.consumedBy;)r=r.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var o=e.compare(r,n);if(0!==o){if(o>0){var i=r;r=n,n=i}if(r.prev===n){var u=r;r=n,n=u}for(var a=0,s=n.rings.length;a<s;a++){var l=n.rings[a],f=n.windings[a],c=r.rings.indexOf(l);-1===c?(r.rings.push(l),r.windings.push(f)):r.windings[c]+=f}n.rings=null,n.windings=null,n.consumedBy=r,n.leftSE.consumedBy=r.leftSE,n.rightSE.consumedBy=r.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,r=this._afterState.windings,n=this._afterState.multiPolys,o=0,i=this.rings.length;o<i;o++){var u=this.rings[o],a=this.windings[o],s=e.indexOf(u);-1===s?(e.push(u),r.push(a)):r[s]+=a}for(var l=[],f=[],c=0,h=e.length;c<h;c++)if(0!==r[c]){var p=e[c],y=p.poly;if(-1===f.indexOf(y))if(p.isExterior)l.push(y);else{-1===f.indexOf(y)&&f.push(y);var g=l.indexOf(p.poly);-1!==g&&l.splice(g,1)}}for(var v=0,d=l.length;v<d;v++){var m=l[v].multiPoly;-1===n.indexOf(m)&&n.push(m)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(U.type){case"union":var r=0===t.length,n=0===e.length;this._isInResult=r!==n;break;case"intersection":var o,i;t.length<e.length?(o=t.length,i=e.length):(o=e.length,i=t.length),this._isInResult=i===U.numMultiPolys&&o<i;break;case"xor":var u=Math.abs(t.length-e.length);this._isInResult=u%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(U.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,r,n){var o,i,u,a=P.comparePoints(t,r);if(a<0)o=t,i=r,u=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));o=r,i=t,u=-1}return new e(new P(o,!0),new P(i,!1),[n],[u])}}]),e}(),C=function(){function e(r,n,o){if(t(this,e),!Array.isArray(r)||0===r.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=o,this.segments=[],"number"!=typeof r[0][0]||"number"!=typeof r[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var i=E.round(r[0][0],r[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var u=i,a=1,s=r.length;a<s;a++){if("number"!=typeof r[a][0]||"number"!=typeof r[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var l=E.round(r[a][0],r[a][1]);l.x===u.x&&l.y===u.y||(this.segments.push(O.fromRing(u,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),u=l)}i.x===u.x&&i.y===u.y||this.segments.push(O.fromRing(u,i,this))}return r(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,r=this.segments.length;e<r;e++){var n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}}]),e}(),k=function(){function e(r,n){if(t(this,e),!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new C(r[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var o=1,i=r.length;o<i;o++){var u=new C(r[o],this,!1);u.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=u.bbox.ll.x),u.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=u.bbox.ll.y),u.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=u.bbox.ur.x),u.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=u.bbox.ur.y),this.interiorRings.push(u)}this.multiPoly=n}return r(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,r=this.interiorRings.length;e<r;e++)for(var n=this.interiorRings[e].getSweepEvents(),o=0,i=n.length;o<i;o++)t.push(n[o]);return t}}]),e}(),I=function(){function e(r,n){if(t(this,e),!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof r[0][0][0]&&(r=[r])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var o=0,i=r.length;o<i;o++){var u=new k(r[o],this);u.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=u.bbox.ll.x),u.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=u.bbox.ll.y),u.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=u.bbox.ur.x),u.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=u.bbox.ur.y),this.polys.push(u)}this.isSubject=n}return r(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,r=this.polys.length;e<r;e++)for(var n=this.polys[e].getSweepEvents(),o=0,i=n.length;o<i;o++)t.push(n[o]);return t}}]),e}(),B=function(){function e(r){t(this,e),this.events=r;for(var n=0,o=r.length;n<o;n++)r[n].segment.ringOut=this;this.poly=null}return r(e,null,[{key:"factory",value:function(t){for(var r=[],n=0,o=t.length;n<o;n++){var i=t[n];if(i.isInResult()&&!i.ringOut){for(var u=null,a=i.leftSE,s=i.rightSE,l=[a],f=a.point,c=[];u=a,a=s,l.push(a),a.point!==f;)for(;;){var h=a.getAvailableLinkedEvents();if(0===h.length){var p=l[0].point,y=l[l.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(p.x,",")+" ".concat(p.y,"]. Last matching segment found ends at")+" [".concat(y.x,", ").concat(y.y,"]."))}if(1===h.length){s=h[0].otherSE;break}for(var g=null,v=0,d=c.length;v<d;v++)if(c[v].point===a.point){g=v;break}if(null===g){c.push({index:l.length,point:a.point});var m=a.getLeftmostComparator(u);s=h.sort(m)[0].otherSE;break}var b=c.splice(g)[0],E=l.splice(b.index);E.unshift(E[0].otherSE),r.push(new e(E.reverse()))}r.push(new e(l))}}return r}}]),r(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],r=1,n=this.events.length-1;r<n;r++){var o=this.events[r].point,i=this.events[r+1].point;0!==S(o,t,i)&&(e.push(o),t=o)}if(1===e.length)return null;var u=e[0],a=e[1];0===S(u,t,a)&&e.shift(),e.push(e[0]);for(var s=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:e.length-1,f=this.isExteriorRing()?e.length:-1,c=[],h=l;h!=f;h+=s)c.push([e[h].x,e[h].y]);return c}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,r=this.events.length;e<r;e++){var n=this.events[e];P.compare(t,n)>0&&(t=n)}for(var o=t.segment.prevInResult(),i=o?o.prevInResult():null;;){if(!o)return null;if(!i)return o.ringOut;if(i.ringOut!==o.ringOut)return i.ringOut.enclosingRing()!==o.ringOut?o.ringOut:o.ringOut.enclosingRing();o=i.prevInResult(),i=o?o.prevInResult():null}}}]),e}(),R=function(){function e(r){t(this,e),this.exteriorRing=r,r.poly=this,this.interiorRings=[]}return r(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,r=this.interiorRings.length;e<r;e++){var n=this.interiorRings[e].getGeom();null!==n&&t.push(n)}return t}}]),e}(),j=function(){function e(r){t(this,e),this.rings=r,this.polys=this._composePolys(r)}return r(e,[{key:"getGeom",value:function(){for(var t=[],e=0,r=this.polys.length;e<r;e++){var n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}},{key:"_composePolys",value:function(t){for(var e=[],r=0,n=t.length;r<n;r++){var o=t[r];if(!o.poly)if(o.isExteriorRing())e.push(new R(o));else{var i=o.enclosingRing();i.poly||e.push(new R(i)),i.poly.addInterior(o)}}return e}}]),e}(),T=function(){function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.compare;t(this,e),this.queue=r,this.tree=new l(n),this.segments=[]}return r(e,[{key:"process",value:function(t){var e=t.segment,r=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),r;var n=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!n)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var o=n,i=n,u=void 0,a=void 0;void 0===u;)null===(o=this.tree.prev(o))?u=null:void 0===o.key.consumedBy&&(u=o.key);for(;void 0===a;)null===(i=this.tree.next(i))?a=null:void 0===i.key.consumedBy&&(a=i.key);if(t.isLeft){var s=null;if(u){var l=u.getIntersection(e);if(null!==l&&(e.isAnEndpoint(l)||(s=l),!u.isAnEndpoint(l)))for(var f=this._splitSafely(u,l),c=0,h=f.length;c<h;c++)r.push(f[c])}var p=null;if(a){var y=a.getIntersection(e);if(null!==y&&(e.isAnEndpoint(y)||(p=y),!a.isAnEndpoint(y)))for(var g=this._splitSafely(a,y),v=0,d=g.length;v<d;v++)r.push(g[v])}if(null!==s||null!==p){var m;m=null===s?p:null===p||P.comparePoints(s,p)<=0?s:p,this.queue.remove(e.rightSE),r.push(e.rightSE);for(var b=e.split(m),E=0,x=b.length;E<x;E++)r.push(b[E])}r.length>0?(this.tree.remove(e),r.push(t)):(this.segments.push(e),e.prev=u)}else{if(u&&a){var w=u.getIntersection(a);if(null!==w){if(!u.isAnEndpoint(w))for(var S=this._splitSafely(u,w),D=0,_=S.length;D<_;D++)r.push(S[D]);if(!a.isAnEndpoint(w))for(var A=this._splitSafely(a,w),F=0,M=A.length;F<M;F++)r.push(A[F])}}this.tree.remove(e)}return r}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var r=t.rightSE;this.queue.remove(r);var n=t.split(e);return n.push(r),void 0===t.consumedBy&&this.tree.insert(t),n}}]),e}(),L="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,N="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,U=new(function(){function e(){t(this,e)}return r(e,[{key:"run",value:function(t,e,r){U.type=t,E.reset();for(var n=[new I(e,!0)],o=0,i=r.length;o<i;o++)n.push(new I(r[o],!1));if(U.numMultiPolys=n.length,"difference"===U.type)for(var u=n[0],a=1;a<n.length;)null!==y(n[a].bbox,u.bbox)?a++:n.splice(a,1);if("intersection"===U.type)for(var s=0,f=n.length;s<f;s++)for(var c=n[s],h=s+1,p=n.length;h<p;h++)if(null===y(c.bbox,n[h].bbox))return[];for(var g=new l(P.compare),v=0,d=n.length;v<d;v++)for(var m=n[v].getSweepEvents(),b=0,x=m.length;b<x;b++)if(g.insert(m[b]),g.size>L)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var w=new T(g),S=g.size,D=g.pop();D;){var _=D.key;if(g.size===S){var A=_.segment;throw new Error("Unable to pop() ".concat(_.isLeft?"left":"right"," SweepEvent ")+"[".concat(_.point.x,", ").concat(_.point.y,"] from segment #").concat(A.id," ")+"[".concat(A.leftSE.point.x,", ").concat(A.leftSE.point.y,"] -> ")+"[".concat(A.rightSE.point.x,", ").concat(A.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(g.size>L)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(w.segments.length>N)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var F=w.process(_),M=0,O=F.length;M<O;M++){var C=F[M];void 0===C.consumedBy&&g.insert(C)}S=g.size,D=g.pop()}E.reset();var k=B.factory(w.segments);return new j(k).getGeom()}}]),e}());return{union:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return U.run("union",t,r)},intersection:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return U.run("intersection",t,r)},xor:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return U.run("xor",t,r)},difference:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return U.run("difference",t,r)}}}()},147:function(t){t.exports=function(){"use strict";function t(t,n,o,i,u){!function t(r,n,o,i,u){for(;i>o;){if(i-o>600){var a=i-o+1,s=n-o+1,l=Math.log(a),f=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*f*(a-f)/a)*(s-a/2<0?-1:1);t(r,n,Math.max(o,Math.floor(n-s*f/a+c)),Math.min(i,Math.floor(n+(a-s)*f/a+c)),u)}var h=r[n],p=o,y=i;for(e(r,o,n),u(r[i],h)>0&&e(r,o,i);p<y;){for(e(r,p,y),p++,y--;u(r[p],h)<0;)p++;for(;u(r[y],h)>0;)y--}0===u(r[o],h)?e(r,o,y):e(r,++y,i),y<=n&&(o=y+1),n<=y&&(i=y-1)}}(t,n,o||0,i||t.length-1,u||r)}function e(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function r(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function i(t,e){u(t,0,t.children.length,e,t)}function u(t,e,r,n,o){o||(o=y(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var i=e;i<r;i++){var u=t.children[i];a(o,t.leaf?n(u):u)}return o}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function s(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function y(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,r,n,o,i){for(var u=[r,n];u.length;)if(!((n=u.pop())-(r=u.pop())<=o)){var a=r+Math.ceil((n-r)/o/2)*o;t(e,a,r,n,i),u.push(r,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,r=[];if(!p(t,e))return r;for(var n=this.toBBox,o=[];e;){for(var i=0;i<e.children.length;i++){var u=e.children[i],a=e.leaf?n(u):u;p(t,a)&&(e.leaf?r.push(u):h(t,a)?this._all(u,r):o.push(u))}e=o.pop()}return r},n.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var o=e.children[n],i=e.leaf?this.toBBox(o):o;if(p(t,i)){if(e.leaf||h(t,i))return!0;r.push(o)}}e=r.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=y([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var r,n,i,u=this.data,a=this.toBBox(t),s=[],l=[];u||s.length;){if(u||(u=s.pop(),n=s[s.length-1],r=l.pop(),i=!0),u.leaf){var f=o(t,u.children,e);if(-1!==f)return u.children.splice(f,1),s.push(u),this._condense(s),this}i||u.leaf||!h(u,a)?n?(r++,u=n.children[r],i=!1):u=null:(s.push(u),l.push(r),r=0,n=u,u=u.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},n.prototype._build=function(t,e,r,n){var o,u=r-e+1,a=this._maxEntries;if(u<=a)return i(o=y(t.slice(e,r+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(u)/Math.log(a)),a=Math.ceil(u/Math.pow(a,n-1))),(o=y([])).leaf=!1,o.height=n;var s=Math.ceil(u/a),l=s*Math.ceil(Math.sqrt(a));g(t,e,r,l,this.compareMinX);for(var f=e;f<=r;f+=l){var c=Math.min(f+l-1,r);g(t,f,c,s,this.compareMinY);for(var h=f;h<=c;h+=s){var p=Math.min(h+s-1,c);o.children.push(this._build(t,h,p,n-1))}}return i(o,this.toBBox),o},n.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var o=1/0,i=1/0,u=void 0,a=0;a<e.children.length;a++){var s=e.children[a],l=f(s),c=(h=t,p=s,(Math.max(p.maxX,h.maxX)-Math.min(p.minX,h.minX))*(Math.max(p.maxY,h.maxY)-Math.min(p.minY,h.minY))-l);c<i?(i=c,o=l<o?l:o,u=s):c===i&&l<o&&(o=l,u=s)}e=u||e.children[0]}var h,p;return e},n.prototype._insert=function(t,e,r){var n=r?t:this.toBBox(t),o=[],i=this._chooseSubtree(n,this.data,e,o);for(i.children.push(t),a(i,n);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(n,o,e)},n.prototype._split=function(t,e){var r=t[e],n=r.children.length,o=this._minEntries;this._chooseSplitAxis(r,o,n);var u=this._chooseSplitIndex(r,o,n),a=y(r.children.splice(u,r.children.length-u));a.height=r.height,a.leaf=r.leaf,i(r,this.toBBox),i(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(r,a)},n.prototype._splitRoot=function(t,e){this.data=y([t,e]),this.data.height=t.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,r){for(var n,o,i,a,s,l,c,h=1/0,p=1/0,y=e;y<=r-e;y++){var g=u(t,0,y,this.toBBox),v=u(t,y,r,this.toBBox),d=(o=g,i=v,void 0,void 0,void 0,void 0,a=Math.max(o.minX,i.minX),s=Math.max(o.minY,i.minY),l=Math.min(o.maxX,i.maxX),c=Math.min(o.maxY,i.maxY),Math.max(0,l-a)*Math.max(0,c-s)),m=f(g)+f(v);d<h?(h=d,n=y,p=m<p?m:p):d===h&&m<p&&(p=m,n=y)}return n||r-e},n.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:s,o=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,o)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var o=this.toBBox,i=u(t,0,e,o),s=u(t,r-e,r,o),l=c(i)+c(s),f=e;f<r-e;f++){var h=t.children[f];a(i,t.leaf?o(h):h),l+=c(i)}for(var p=r-e-1;p>=e;p--){var y=t.children[p];a(s,t.leaf?o(y):y),l+=c(s)}return l},n.prototype._adjustParentBBoxes=function(t,e,r){for(var n=r;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():i(t[e],this.toBBox)},n}()},823:t=>{t.exports=function(){function t(t){return t}function e(t){return"string"==typeof t?t.toLowerCase():t}function r(n,o){var i="function"==typeof this&&!this.firstBy&&this,u=function(r,n){if(n="object"==typeof n?n:{direction:n},"function"!=typeof r){var o=r;r=function(t){return t[o]?t[o]:""}}if(1===r.length){var i=r,u=n.ignoreCase?e:t,a=n.cmp||function(t,e){return t<e?-1:t>e?1:0};r=function(t,e){return a(u(i(t)),u(i(e)))}}return n.direction in{"-1":"",desc:""}?function(t,e){return-r(t,e)}:r}(n,o),a=i?function(t,e){return i(t,e)||u(t,e)}:u;return a.thenBy=r,a}return r.firstBy=r,r}()},507:(t,e,r)=>{var n,o,i,u;self,t.exports=(n=r(189),o=r(0),i=r(190),u=r(441),(()=>{"use strict";var t={855:t=>{t.exports=n},97:t=>{t.exports=o},55:t=>{t.exports=i},956:t=>{t.exports=u}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};return(()=>{function t(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function n(r){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){t(r,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))}))}return r}r.r(a),r.d(a,{AggregationTypes:()=>g,EDIT_MODES:()=>Mt,FEATURE_SELECTION_MODES:()=>Pt,GroupDateTypes:()=>_t,MASK_ID:()=>Ot,REQUEST_GET_MAX_URL_LENGTH:()=>o,_FilterTypes:()=>A,_applyFilters:()=>L,_buildFeatureFilter:()=>T,_filtersToSQL:()=>j,_getApplicableFilters:()=>R,aggregationFunctions:()=>d,debounce:()=>f,encodeParameter:()=>s,geojsonFeatures:()=>St,getMonday:()=>l,getRequest:()=>i,groupValuesByColumn:()=>x,groupValuesByDateColumn:()=>Ft,histogram:()=>S,makeIntervalComplete:()=>p,postRequest:()=>u,randomString:()=>h,scatterPlot:()=>_,throttle:()=>c,tileFeatures:()=>xt});var o=2048;function i(t,e){return new Request(t,n({method:"GET",headers:{Accept:"application/json"}},e))}function u(t,e,r){return new Request(t,n({method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)},r))}function s(t,e){return"".concat(t,"=").concat(encodeURIComponent(e))}function l(t){var e=new Date(t),r=e.getDay(),n=e.getDate()-r+(r?1:-6);return e.setDate(n),Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())}function f(t,e){var r,n=this;return function(){for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return clearTimeout(r),r=setTimeout((function(){r=null,t.apply(n,i)}),e)}}function c(t,e){var r=0;return function(){var n=new Date;n-r>=e&&(t(),r=n)}}function h(t){for(var e="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<t;n++)e+=r.charAt(Math.floor(Math.random()*r.length));return e}function p(t){return t.map((function(t){return void 0===t[0]?[Number.MIN_SAFE_INTEGER,t[1]]:void 0===t[1]?[t[0],Number.MAX_SAFE_INTEGER]:t}))}var y,g=Object.freeze({COUNT:"count",AVG:"avg",MIN:"min",MAX:"max",SUM:"sum"}),v=function(t,e){var r=e?function(t,r){return t+r[e]}:function(t,e){return t+e};return t.reduce(r,0)},d=(t(y={},g.COUNT,(function(t){return t.length})),t(y,g.MIN,(function(t,e){return function(t,e){var r=e?function(t,r){return Math.min(t,r[e])}:function(t,e){return Math.min(t,e)};return t.reduce(r,1/0)}(t,e)})),t(y,g.MAX,(function(t,e){return function(t,e){var r=e?function(t,r){return Math.max(t,r[e])}:function(t,e){return Math.max(t,e)};return t.reduce(r,-1/0)}(t,e)})),t(y,g.SUM,(function(t,e){return v(t,e)})),t(y,g.AVG,(function(t,e){return v(t,e)/(t.length||1)})),y);function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function b(t,e){if(t){if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}function E(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],u=!0,a=!1;try{for(r=r.call(t);!(u=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);u=!0);}catch(t){a=!0,o=t}finally{try{u||null==r.return||r.return()}finally{if(a)throw o}}return i}}(t,e)||b(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e,r,n){if(Array.isArray(t)&&0===t.length)return null;var o=t.reduce((function(t,o){var i=o[r];return t[i]=t[i]||[],(n===g.COUNT||null!==o[e])&&void 0!==o[e]&&t[i].push(o[e]),t}),{}),i=d[n];return i?Object.entries(o).map((function(t){var e=E(t,2),r=e[0],n=e[1];return{name:r,value:i(n)}})):[]}function w(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||b(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e,r,n){if(Array.isArray(t)&&0===t.length)return[];var o=(r=[Number.MIN_SAFE_INTEGER].concat(w(r))).map((function(t,e,r){return{bin:e,start:t,end:e===r.length-1?Number.MAX_SAFE_INTEGER:r[e+1],values:[]}}));t.forEach((function(t){var r=t[e];if(null!=r){var n=o.find((function(t){return t.start<=r&&t.end>r}));n&&n.values.push(r)}}));var i=d[n];return i?o.map((function(t){return t.values})).map((function(t){return t.length?i(t):0})):[]}var D,_=function(t,e,r){return t.filter((function(t){var n=null!=t[e],o=t[r];return n&&null!=o})).map((function(t){return[t[e],t[r]]}))},A=Object.freeze({IN:"in",BETWEEN:"between",CLOSED_OPEN:"closed_open",TIME:"time",STRING_SEARCH:"stringSearch"}),F=(t(D={},A.IN,(function(t,e){return t.includes(e)})),t(D,A.BETWEEN,P),t(D,A.TIME,(function(t,e){var r=new Date(e).getTime();if(isFinite(r))return P(t,r);throw new Error("Column used to filter by time isn\'t well formatted.")})),t(D,A.CLOSED_OPEN,(function(t,e){return p(t).some((function(t){var r=E(t,2),n=r[0],o=r[1];return e>=n&&e<o}))})),t(D,A.STRING_SEARCH,(function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=k(e,r),o=t.map((function(t){var e=C(k(t,r));return r.mustStart&&(e="^".concat(e)),r.mustEnd&&(e="".concat(e,"$")),e})).join("|"),i=new RegExp(o,"g");return!!n.match(i)})),D);function P(t,e){return p(t).some((function(t){var r=E(t,2),n=r[0],o=r[1];return e>=n&&e<=o}))}var M=/[.*+?^${}()|[\\]\\\\]/g,O=/(?:[\\^`\\xA8\\xAF\\xB4\\xB7\\xB8\\u02B0-\\u034E\\u0350-\\u0357\\u035D-\\u0362\\u0374\\u0375\\u037A\\u0384\\u0385\\u0483-\\u0487\\u0559\\u0591-\\u05A1\\u05A3-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u064B-\\u0652\\u0657\\u0658\\u06DF\\u06E0\\u06E5\\u06E6\\u06EA-\\u06EC\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F5\\u0818\\u0819\\u0898-\\u089F\\u08C9-\\u08D2\\u08E3-\\u08FE\\u093C\\u094D\\u0951-\\u0954\\u0971\\u09BC\\u09CD\\u0A3C\\u0A4D\\u0ABC\\u0ACD\\u0AFD-\\u0AFF\\u0B3C\\u0B4D\\u0B55\\u0BCD\\u0C3C\\u0C4D\\u0CBC\\u0CCD\\u0D3B\\u0D3C\\u0D4D\\u0DCA\\u0E47-\\u0E4C\\u0E4E\\u0EBA\\u0EC8-\\u0ECC\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F82-\\u0F84\\u0F86\\u0F87\\u0FC6\\u1037\\u1039\\u103A\\u1063\\u1064\\u1069-\\u106D\\u1087-\\u108D\\u108F\\u109A\\u109B\\u135D-\\u135F\\u1714\\u1715\\u17C9-\\u17D3\\u17DD\\u1939-\\u193B\\u1A75-\\u1A7C\\u1A7F\\u1AB0-\\u1ABE\\u1AC1-\\u1ACB\\u1B34\\u1B44\\u1B6B-\\u1B73\\u1BAA\\u1BAB\\u1C36\\u1C37\\u1C78-\\u1C7D\\u1CD0-\\u1CE8\\u1CED\\u1CF4\\u1CF7-\\u1CF9\\u1D2C-\\u1D6A\\u1DC4-\\u1DCF\\u1DF5-\\u1DFF\\u1FBD\\u1FBF-\\u1FC1\\u1FCD-\\u1FCF\\u1FDD-\\u1FDF\\u1FED-\\u1FEF\\u1FFD\\u1FFE\\u2CEF-\\u2CF1\\u2E2F\\u302A-\\u302F\\u3099-\\u309C\\u30FC\\uA66F\\uA67C\\uA67D\\uA67F\\uA69C\\uA69D\\uA6F0\\uA6F1\\uA700-\\uA721\\uA788-\\uA78A\\uA7F8\\uA7F9\\uA8C4\\uA8E0-\\uA8F1\\uA92B-\\uA92E\\uA953\\uA9B3\\uA9C0\\uA9E5\\uAA7B-\\uAA7D\\uAABF-\\uAAC2\\uAAF6\\uAB5B-\\uAB5F\\uAB69-\\uAB6B\\uABEC\\uABED\\uFB1E\\uFE20-\\uFE2F\\uFF3E\\uFF40\\uFF70\\uFF9E\\uFF9F\\uFFE3]|\\uD800\\uDEE0|\\uD801[\\uDF80-\\uDF85\\uDF87-\\uDFB0\\uDFB2-\\uDFBA]|\\uD802[\\uDEE5\\uDEE6]|\\uD803[\\uDD22-\\uDD27\\uDF46-\\uDF50\\uDF82-\\uDF85]|\\uD804[\\uDC46\\uDC70\\uDCB9\\uDCBA\\uDD33\\uDD34\\uDD73\\uDDC0\\uDDCA-\\uDDCC\\uDE35\\uDE36\\uDEE9\\uDEEA\\uDF3C\\uDF4D\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC42\\uDC46\\uDCC2\\uDCC3\\uDDBF\\uDDC0\\uDE3F\\uDEB6\\uDEB7\\uDF2B]|\\uD806[\\uDC39\\uDC3A\\uDD3D\\uDD3E\\uDD43\\uDDE0\\uDE34\\uDE47\\uDE99]|\\uD807[\\uDC3F\\uDD42\\uDD44\\uDD45\\uDD97]|\\uD81A[\\uDEF0-\\uDEF4\\uDF30-\\uDF36]|\\uD81B[\\uDF8F-\\uDF9F\\uDFF0\\uDFF1]|\\uD82B[\\uDFF0-\\uDFF3\\uDFF5-\\uDFFB\\uDFFD\\uDFFE]|\\uD833[\\uDF00-\\uDF2D\\uDF30-\\uDF46]|\\uD834[\\uDD67-\\uDD69\\uDD6D-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD]|\\uD838[\\uDD30-\\uDD36\\uDEAE\\uDEEC-\\uDEEF]|\\uD83A[\\uDCD0-\\uDCD6\\uDD44-\\uDD46\\uDD48-\\uDD4A])/g;function C(t){return t.replace(M,"\\\\$&")}function k(t,e){var r=""+t;return e.caseSensitive||(r=r.toLocaleLowerCase()),e.keepSpecialCharacters||(r=r.normalize("NFD").replace(O,"")),r}function I(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?I(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,r={};return Object.entries(t).forEach((function(t){var n=E(t,2),o=n[0],i=n[1],u={};Object.keys(i).filter((function(t){return i[t].owner!==e})).forEach((function(t){return u[t]=B({},i[t])})),Object.keys(u).length&&(r[o]=u)})),r},j=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=[];return Object.entries(t).forEach((function(t){var r=E(t,2),n=r[0],o=r[1];Object.entries(o).forEach((function(t){var r=E(t,2),o=r[0],i=r[1];switch(o){case A.IN:e.push("".concat(n," ").concat(o,"(").concat(i.values.map((function(t){return isFinite(t)?t:"\'".concat(t,"\'")})).join(","),")"));break;case A.BETWEEN:e.push("(".concat(i.values.map((function(t){var e=E(t,2),r=e[0],o=e[1];return"".concat(r?"".concat(n," >= ").concat(r):""," ").concat(r&&o?" and ":""," ").concat(o?"".concat(n," < ").concat(o):"")})).join(") OR ("),")"));break;default:throw new Error("Not valid operator has provided: ".concat(o))}}))})),e.length?"WHERE (".concat(e.join(") AND ("),")"):""};function T(t){var e=t.filters,r=void 0===e?{}:e,n=t.type,o=void 0===n?"boolean":n,i=Object.keys(r);return i.length?function(t){var e=t.properties||t,n=function(t,e,r){return t.every((function(t){var n=e[t],o=Object.keys(n);return!(!r||null===r[t]||void 0===r[t])&&o.every((function(e){var o=F[e];if(!o)throw new Error(\'"\'.concat(e,\'" filter is not implemented.\'));return o(n[e].values,r[t],n[e].params)}))}))}(i,r,e);return"number"===o?Number(n):n}:function(){return"number"!==o||1}}function L(t,e){return Object.keys(e).length?t.filter(T({filters:e})):t}const N="{user}",U=("https://".concat(N,".carto.com/api/v1/map"),"https://maps-api-v2.".concat("{region}",".carto.com/user/").concat(N),"mvt");let G;!function(t){t.Number="number",t.Bigint="bigint",t.String="string",t.Geometry="geometry",t.Timestamp="timestamp",t.Object="object",t.Boolean="boolean",t.Variant="variant",t.Unknown="unknown"}(G||(G={}));var Y=r(855),X=r.n(Y),q=r(97),z=r.n(q),V=r(55),J=r.n(V),H=r(956),W=r.n(H);function $(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}Math.log2;const K=Math.PI,Q=K/4,Z=K/180;function tt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function et(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?tt(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rt(t,e){var r=[st([e.west,e.north]),st([e.east,e.south])],n=nt[t.type];if(!n)throw new Error("Unrecognized geometry type ".concat(t.type));return et(et({},t),{},{coordinates:n(t.coordinates,r)})}Math.PI;var nt={Point:ot,MultiPoint:function(t,e){return it(t,e)},LineString:ut,MultiLineString:function(t,e){return t.map((function(t){return ut(t,e)}))},Polygon:at,MultiPolygon:function(t,e){return t.map((function(t){return at(t,e)}))}};function ot(t,e){var r=E(t,2),n=r[0],o=r[1],i=E(e,2),u=i[0],a=i[1];return[lt(u[0],a[0],n),lt(u[1],a[1],o)]}function it(t,e){return t.map((function(t){return ot(st(t),e)}))}function ut(t,e){return it(t,e)}function at(t,e){return t.map((function(t){return it(t,e)}))}function st(t){return function([t,e]){$(Number.isFinite(t)),$(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude");const r=e*Z;return[512*(t*Z+K)/(2*K),512*(K+Math.log(Math.tan(Q+.5*r)))/(2*K)]}(t)}function lt(t,e,r){return(r-t)/(e-t)}function ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var ct=Object.freeze({Point:0,LineString:1,Polygon:2});function ht(t){return(t.primitivePolygonIndices||t.pathIndices||t.pointIndices).value}function pt(t,e){var r=function(t,e){return t.featureIds.value[e]}(t,e),n=t.properties,o=t.numericProps,i={properties:n[r],numericProps:{}};for(var u in o)i.numericProps[u]=o[u].value[e];return i}function yt(t){var e=t.properties,r=t.numericProps;return Object.assign({},e,r)}function gt(t,e,r){if(e)return vt(t,e);var n=r.size+1;return vt(t,"cartodb_id")||vt(t,"geoid")||n}function vt(t,e){var r=t.properties;return t.numericProps[e]||r[e]}function dt(t,e){switch(e){case ct.Polygon:return{type:"Polygon",coordinates:[t]};case ct.LineString:return{type:"LineString",coordinates:t};case ct.Point:return{type:"Point",coordinates:t[0]};default:throw new Error("Invalid geometry type")}}function mt(t,e,r){for(var n=[],o=t;o<e;o++)n.push(Array.from(r.value.subarray(o*r.size,(o+1)*r.size)));return n}function bt(t){var e=t.map,r=t.tileIsFullyVisible,n=t.geometryIntersection,o=t.data,i=t.type,u=t.uniqueIdProperty;null!=o&&o.properties.length&&(r?function(t){for(var e=t.map,r=t.data,n=t.uniqueIdProperty,o=ht(r),i=0;i<o.length-1;i++){var u=pt(r,o[i]),a=gt(u,n,e);a&&!e.has(a)&&e.set(a,yt(u))}}({map:e,data:o,uniqueIdProperty:u}):function(t){for(var e=t.map,r=t.data,n=t.geometryIntersection,o=t.type,i=t.uniqueIdProperty,u=ht(r),a=r.positions,s=0;s<u.length-1;s++){var l=u[s],f=u[s+1],c=pt(r,l),h=gt(c,i,e);if(h&&!e.has(h)){var p=mt(l,f,a);z()(dt(p,o),n)&&e.set(h,yt(c))}}}({map:e,data:o,geometryIntersection:n,type:i,uniqueIdProperty:u}))}function Et(t,e){return e?W()(X()(t),e):X()(t)}function xt(t){var e=t.tiles,r=t.viewport,n=t.geometry,o=t.uniqueIdProperty,i=t.tileFormat,u=new Map,a=Et(r,n);if(!a)return[];var s,l,f,c,h=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return ft(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ft(t,e):void 0}}(t))){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){a=!0,i=t},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw i}}}}(e);try{for(h.s();!(s=h.n()).done;){var p=s.value;if(!1!==p.isVisible&&p.data){var y=p.bbox,g=X()([y.west,y.south,y.east,y.north]),v=J()(g,a),d=W()(g,a);if(d){var m={type:"Feature",geometry:i===U?rt(d.geometry,y):d.geometry};l=p.data.points,f=void 0,c=(f=l.featureIds.value)[f.length-1],l.pointIndices={value:new f.constructor(f.length+1),size:1},l.pointIndices.value.set(f),l.pointIndices.value.set([c+1],f.length),bt({map:u,tileIsFullyVisible:v,geometryIntersection:m,data:p.data.points,type:ct.Point,uniqueIdProperty:o}),bt({map:u,tileIsFullyVisible:v,geometryIntersection:m,data:p.data.lines,type:ct.LineString,uniqueIdProperty:o}),bt({map:u,tileIsFullyVisible:v,geometryIntersection:m,data:p.data.polygons,type:ct.Polygon,uniqueIdProperty:o})}}}}catch(t){h.e(t)}finally{h.f()}return Array.from(u.values())}function wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function St(t){var e=t.geojson,r=t.viewport,n=t.geometry,o=t.uniqueIdProperty,i=0,u=new Map,a=Et(r,n);if(!a)return[];var s,l=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return wt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wt(t,e):void 0}}(t))){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){a=!0,i=t},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw i}}}}(e.features);try{for(l.s();!(s=l.n()).done;){var f=s.value,c=o?f.properties[o]:++i;!u.has(c)&&z()(a,f)&&u.set(c,f.properties)}}catch(t){l.e(t)}finally{l.f()}return Array.from(u.values())}var Dt,_t=Object.freeze({YEARS:"years",MONTHS:"months",WEEKS:"weeks",DAYS:"days",HOURS:"hours",MINUTES:"minutes"}),At=(t(Dt={},_t.YEARS,(function(t){return Date.UTC(t.getUTCFullYear())})),t(Dt,_t.MONTHS,(function(t){return Date.UTC(t.getUTCFullYear(),t.getUTCMonth())})),t(Dt,_t.WEEKS,(function(t){return l(t)})),t(Dt,_t.DAYS,(function(t){return Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate())})),t(Dt,_t.HOURS,(function(t){return Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours())})),t(Dt,_t.MINUTES,(function(t){return Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes())})),Dt);function Ft(t,e,r,n,o){if(Array.isArray(t)&&0===t.length)return null;var i=At[n];if(!i)return null;var u=t.reduce((function(t,n){var o=n[r],u=new Date(o),a=i(u);if(!isNaN(a)){var s=t.get(a);s||(s=[],t.set(a,s)),null!==n[e]&&void 0!==n[e]&&(s.push(n[e]),t.set(a,s))}return t}),new Map),a=d[o];return a?w(u.entries()).map((function(t){var e=E(t,2),r=e[0],n=e[1];return{name:r,value:a(n)}})).sort((function(t,e){return t.name-e.name})):[]}var Pt=Object.freeze({POLYGON:"DrawPolygonMode",RECTANGLE:"DrawRectangleMode",CIRCLE:"DrawCircleFromCenterMode",LASSO_TOOL:"DrawPolygonByDraggingMode"}),Mt=Object.freeze({EDIT:"edit"}),Ot="feature_selection_mask"})(),a})())}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}(()=>{"use strict";var t=r(507);function e(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function i(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function u(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}function a(t){return function(t){if(Array.isArray(t))return o(t)}(t)||i(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=r(823);function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?l(Object(n),!0).forEach((function(r){e(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function h(t){var e,r,o,l,h,p=(o={sortBy:t.sortBy,sortByDirection:t.sortByDirection},l=o.sortBy,h=o.sortByDirection,Array.isArray(l)||(l=[l]),l.map((function(t){if("string"==typeof t)return[t,h];if(Array.isArray(t)){if(void 0===t[1])return[t,h];if("object"===n(t[1]))return[t[0],f({direction:h},t[1])]}return t}))),y=function(t){if(Array.isArray(t))return t}(r=p)||i(r)||u(r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),g=y[0],v=y.slice(1),d=s.firstBy.apply(void 0,a(g)),m=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){a=!0,i=t},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw i}}}}(v);try{for(m.s();!(e=m.n()).done;){var b,E=e.value;d=(b=d).thenBy.apply(b,a(E))}}catch(t){m.e(t)}finally{m.f()}return d}var p=Object.freeze({TILE_FEATURES:"tileFeatures",FEATURES_FORMULA:"featuresFormula",FEATURES_HISTOGRAM:"featuresHistogram",FEATURES_CATEGORY:"featuresCategory",FEATURES_SCATTERPLOT:"featuresScatterPlot",FEATURES_TIME_SERIES:"featuresTimeSeries",FEATURES_RAW:"featuresRawFeatures",LOAD_GEOJSON_FEATURES:"loadGeoJSONFeatures",GEOJSON_FEATURES:"featuresGeoJSON",LOAD_TILES:"loadTiles"});let y,g,v;function d(e={}){return(0,t._applyFilters)(y,e)}onmessage=({data:{method:e,...r}})=>{switch(e){case p.TILE_FEATURES:!function({viewport:e,geometry:r,uniqueIdProperty:n,tileFormat:o}){y=(0,t.tileFeatures)({tiles:v,viewport:e,geometry:r,uniqueIdProperty:n,tileFormat:o}),postMessage({result:!0})}(r);break;case p.FEATURES_FORMULA:!function({filters:e,operation:r,column:n}){let o=null;y&&(o=[{value:(0,t.aggregationFunctions[r])(d(e),n)}]),postMessage({result:o})}(r);break;case p.FEATURES_HISTOGRAM:!function({filters:e,operation:r,column:n,ticks:o}){let i=null;if(y){const u=d(e);i=(0,t.histogram)(u,n,o,r)}postMessage({result:i})}(r);break;case p.FEATURES_CATEGORY:!function({filters:e,operation:r,column:n,operationColumn:o}){let i=null;if(y){const u=d(e);i=(0,t.groupValuesByColumn)(u,o,n,r)||[]}postMessage({result:i})}(r);break;case p.FEATURES_SCATTERPLOT:!function({filters:e,xAxisColumn:r,yAxisColumn:n}){let o=[];if(y){const i=d(e);o=(0,t.scatterPlot)(i,r,n)}postMessage({result:o})}(r);break;case p.FEATURES_TIME_SERIES:!function({filters:e,column:r,stepSize:n,operation:o,operationColumn:i}){let u=[];if(y){const a=d(e);u=(0,t.groupValuesByDateColumn)(a,i,r,n,o)||[]}postMessage({result:u})}(r);break;case p.FEATURES_RAW:!function({filters:t,limit:e=10,page:r=0,sortBy:n,sortByDirection:o="asc"}){let i=[],u=0,a=0;y&&(i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.sortBy,n=e.sortByDirection,o=void 0===n?"asc":n;if(void 0===r)return t;if(!(Array.isArray(r)&&r.length||"string"==typeof r))throw new Error("Sorting options are bad formatted");var i=h({sortBy:r,sortByDirection:o});return t.sort(i)}(d(t),{sortBy:n,sortByDirection:o}),a=i.length,e&&(u=Math.ceil(i.length/e),i=function(t,{limit:e,page:r}){return t.slice(e*Math.max(0,r),e*Math.max(1,r+1))}(i,{limit:e,page:r}))),postMessage({result:{data:i,currentPage:r,pages:u,totalCount:a}})}(r);break;case p.LOAD_TILES:!function({tiles:t}){v=t,postMessage({result:!0})}(r);break;case p.LOAD_GEOJSON_FEATURES:!function({geojson:t}){g=t,postMessage({result:!0})}(r);break;case p.GEOJSON_FEATURES:!function({viewport:e,geometry:r,uniqueIdProperty:n}){g&&(y=(0,t.geojsonFeatures)({geojson:g,viewport:e,geometry:r,uniqueIdProperty:n})),postMessage({result:!0})}(r);break;default:throw new Error("Invalid worker method")}}})()})();\n//# sourceMappingURL=index.worker.js.map',"Worker",void 0,r.p+"index.worker.js")}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var s={};function l(t,e,r){return new Promise((function(n,o){var i=function(t){var e;return s[t]||(s[t]={worker:new u,tasks:[]},(e=s[t]).worker.onmessage=function(t){var r=t.data.result;e.tasks.shift().resolve(r),c(e)},function(t){t.worker.onerror=function(e){var r=t.tasks.shift();c(t),r.reject(e)}}(s[t])),s[t]}(t);i.tasks.push({method:e,params:r,resolve:n,reject:o}),1===i.tasks.length&&c(i)}))}function f(t){if(s[t]){var e=new Error;e.name="AbortError",s[t].tasks.forEach((function(t){return t.reject(e)})),s[t].worker.terminate(),delete s[t]}}function c(t){if(t.tasks.length>0){var r=t.tasks[0],n=r.method,o=r.params;t.worker.postMessage(function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?a(Object(n),!0).forEach((function(r){e(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({method:n},o))}}})(),n})()}));
//# sourceMappingURL=index.js.map